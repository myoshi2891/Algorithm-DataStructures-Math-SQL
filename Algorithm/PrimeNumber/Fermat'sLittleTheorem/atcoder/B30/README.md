ã“ã®å•é¡Œã¯ **çµ„ã¿åˆã‚ã›è¨ˆç®—ï¼ˆã‚³ãƒ³ãƒ“ãƒãƒ¼ã‚·ãƒ§ãƒ³ï¼‰** ã«å¸°ç€ã•ã‚Œã‚‹ãŸã‚ã€æ•°å¼ã ã‘ã§ãªãå›³è§£ãƒ™ãƒ¼ã‚¹ã§ã€Œä½•ã‚’ã—ã¦ã„ã‚‹ã‹ã€ã‚’ä¸å¯§ã«èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ§­ å•é¡Œã®æ¦‚è¦ï¼šæ ¼å­ä¸Šã®çµŒè·¯æ•°

---

### âœ… å•é¡Œè¨­å®šï¼ˆå›³ï¼‰

```
ã‚¹ã‚¿ãƒ¼ãƒˆ: (1,1)    ã‚´ãƒ¼ãƒ«: (H,W)
  â†“         â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
  â†“         â†“
```

ä¸Šã®å›³ã®ã‚ˆã†ã«ã€ã‚¹ã‚¿ãƒ¼ãƒˆã‹ã‚‰ã‚´ãƒ¼ãƒ«ã¾ã§ã€Œ**å³**ã€ã¾ãŸã¯ã€Œ**ä¸‹**ã€ã®ã¿ã§ç§»å‹•ã™ã‚‹ã€‚

---

## ğŸ§® æ•°å­¦çš„ãªå¤‰æ›ï¼šçµŒè·¯æ•° = çµ„ã¿åˆã‚ã›ã®å•é¡Œ

---

### ğŸ“˜ é‡è¦ãƒã‚¤ãƒ³ãƒˆ

- ç·ç§»å‹•å›æ•°ï¼š
    - å³ã¸ï¼š`W - 1` å›
    - ä¸‹ã¸ï¼š`H - 1` å›
    - åˆè¨ˆï¼š`(H - 1) + (W - 1) = H + W - 2` å›

- ãã®ä¸­ã§ã€ã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã€Œä¸‹ã«è¡Œãã‹ã€ã‚’é¸ã¶ã“ã¨ã§çµŒè·¯ãŒç¢ºå®šã™ã‚‹ã€‚

---

### ğŸ¯ å…·ä½“ä¾‹ï¼šH = 3, W = 3

```
(1,1) â†’ (1,2) â†’ (1,3)
  â†“       â†“       â†“
(2,1) â†’ (2,2) â†’ (2,3)
  â†“       â†“       â†“
(3,1) â†’ (3,2) â†’ (3,3)
```

- ç§»å‹•æ‰‹é † = ã€Œâ†’â†’â†“â†“ã€ã€Œâ†’â†“â†’â†“ã€ã€Œâ†“â†’â†’â†“ã€ã€Œâ†“â†’â†“â†’ã€ã€Œâ†“â†“â†’â†’ã€ã€Œâ†’â†“â†“â†’ã€

- ç§»å‹•åˆè¨ˆ = 4 å›ï¼ˆä¸‹2å›, å³2å›ï¼‰

- çµ„ã¿åˆã‚ã›ã¨ã—ã¦è€ƒãˆã‚‹ã¨ï¼š
    - `4` å›ã®ã†ã¡ã€`2` å›ã€Œä¸‹ã«è¡Œãã€ä½ç½®ã‚’é¸ã¶
    - ã¤ã¾ã‚Š `4C2 = 6` é€šã‚Š

---

## ğŸ”§ å®Ÿè£…ã®å…¨ä½“æ§‹é€ å›³

---

```plaintext
  å…¥åŠ›èª­ã¿å–ã‚Š
       â†“
  éšä¹—ã®å‰è¨ˆç®— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“                â”‚
  é€†å…ƒã®å‰è¨ˆç®—ï¼ˆmodPowï¼‰â”‚
       â†“                â”‚
 çµ„ã¿åˆã‚ã›é–¢æ•° (nCr) â†â”€â”˜
       â†“
   å‡ºåŠ›ï¼ˆmod 1e9+7ï¼‰
```

---

## ğŸ›  å„å‡¦ç†ã®è©³ç´°ã¨å›³è§£

---

### â‘  `modPow(base, exp)`ï¼šç´¯ä¹—ã‚’é«˜é€Ÿã«è¨ˆç®—

#### å‡¦ç†ï¼š

```ts
while (exp > 0) {
    if (exp % 2n === 1n) result = (result * base) % MOD;
    base = (base * base) % MOD;
    exp >>= 1n;
}
```

#### èª¬æ˜å›³ï¼š

æŒ‡æ•°ãŒå¤§ãã„æ™‚ã«æ›ã‘ç®—ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã€Œ**ç¹°ã‚Šè¿”ã—äºŒä¹—æ³•**ã€ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚

```
ä¾‹ï¼šbase^13 â†’ base^1 * base^4 * base^8

       13(1101)
        â†‘   â†‘   â†‘
        â”‚   â”‚   â””â”€ base^1
        â”‚   â””â”€â”€â”€â”€â”€ base^4
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ base^8
```

è¨ˆç®—é‡ï¼š`O(log exp)`

---

### â‘¡ `precomputeFactorials()`ï¼šéšä¹—ã¨ãã®é€†å…ƒã‚’äº‹å‰ã«å…¨ã¦è¨ˆç®—

#### èª¬æ˜å›³ï¼š

```
fact[i] = i! mod MOD
invFact[i] = (i!)^-1 mod MOD

ä¾‹:
i = 0: fact[0] = 1, invFact[0] = 1
i = 1: fact[1] = 1, invFact[1] = 1
i = 2: fact[2] = 2, invFact[2] = 1/2 mod MOD
       ...
i = 5: fact[5] = 120, invFact[5] = 1/120 mod MOD
```

- `fact[]`: é€šå¸¸ã®éšä¹—
- `invFact[]`: éšä¹—ã®é€†å…ƒï¼ˆå‰²ã‚Šç®—ã‚’ mod ä¸Šã§è¡Œã†ãŸã‚ã«å¿…è¦ï¼‰

#### è£œè¶³ï¼š

mod ã®ä¸–ç•Œã§ã¯å‰²ã‚Šç®—ãŒã§ããªã„ã®ã§ã€é€†å…ƒã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ãã‚Œã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã€1 å›ã ã‘å‰è¨ˆç®—ã—ã¾ã™ã€‚

---

### â‘¢ `combination(n, r)`ï¼šnCr ã‚’æ±‚ã‚ã‚‹

#### æ•°å¼ï¼š

```
nCr = fact[n] Ã— invFact[r] Ã— invFact[n - r] mod MOD
```

#### èª¬æ˜å›³ï¼ˆn = 5, r = 2 ã®å ´åˆï¼‰ï¼š

```
     5!          120
----------- = --------- = 10
 2! * 3!     2 * 6 = 12

modã§ã‚„ã‚‹ã«ã¯ï¼š
(120 * é€†å…ƒ(2) * é€†å…ƒ(6)) % MOD
```

#### è¿”å´å€¤ï¼š

`BigInt` å‹ã®ã¾ã¾è¿”ã—ã€å‡ºåŠ›æ™‚ã« `.toString()` ã«ã—ã¦å‡ºåŠ›

---

### â‘£ å…¨ä½“ã®æµã‚Œã¾ã¨ã‚ï¼ˆæ•°å¼ Ã— å›³ï¼‰

#### ã‚¹ã‚¿ãƒ¼ãƒˆ â†’ ã‚´ãƒ¼ãƒ«ã¸è¡Œãé“æ•°ï¼š

```
(å³: W-1 å›, ä¸‹: H-1 å›)
â†’ ç·ã‚¹ãƒ†ãƒƒãƒ— = H + W - 2
â†’ ä¸‹ã‚’é¸ã¶ä½ç½® = H - 1 ç®‡æ‰€

â†’ çµ„ã¿åˆã‚ã› (H + W - 2) C (H - 1)
```

#### å›³ã§å†ç¢ºèªï¼ˆä¾‹ï¼šH=3, W=4ï¼‰

```
â†“ â†’ â†’ â†“ â†’
â†“ â†’ â†“ â†’ â†’
â†’ â†“ â†“ â†’ â†’
â†’ â†“ â†’ â†“ â†’
â†’ â†’ â†“ â†“ â†’
â†’ â†’ â†“ â†’ â†“
(å…¨ 10 é€šã‚Š = 5C2)
```

---

## ğŸ§  æœ€å¾Œã«

ã“ã®è§£æ³•ã¯ã€Œå‹•çš„è¨ˆç”»æ³•ï¼ˆDPï¼‰ã€ã®ã‚ˆã†ãª `O(H Ã— W)` è¨ˆç®—ã¨ã¯é•ã„ã€**æ•°å­¦çš„ã«å¸°ç€ã—ã¦ O(1) ã§è§£ã**æ–¹æ³•ã§ã™ã€‚

âœ… ãƒ¡ãƒªãƒƒãƒˆï¼š

- éå¸¸ã«å¤§ããª `H, W` ã«å¯¾å¿œå¯èƒ½ï¼ˆæœ€å¤§10ä¸‡ï¼‰
- äº‹å‰è¨ˆç®—ã®ã¿ã§é«˜é€Ÿã« `nCr` ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹

---

ã”å¸Œæœ›ã‚ã‚Œã°ã€DP ã«ã‚ˆã‚‹ `O(HÃ—W)` è§£æ³•ã‚„ã€mod ãªã—ã§ç†è«–ç¢ºèªã™ã‚‹ã€ŒPython/Excelã€ã‚¹ã‚¿ã‚¤ãƒ«ã®å¯è¦–åŒ–ã‚‚ãŠè¦‹ã›ã§ãã¾ã™ã€‚

| [æå‡ºæ—¥æ™‚](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=created) | å•é¡Œ                                                                                  | ãƒ¦ãƒ¼ã‚¶                                            | è¨€èª                                                                                                        | [å¾—ç‚¹](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=score) | [ã‚³ãƒ¼ãƒ‰é•·](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=source_length) | çµæœ | [å®Ÿè¡Œæ™‚é–“](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=time_consumption) | [ãƒ¡ãƒ¢ãƒª](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=memory_consumption) |                                                                       |
| --------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------- | ------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | ---- | -------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| 2025-07-22 17:00:19                                                                           | [B30 - Combination 2](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_dc) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Go (go 1.20.6)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5002)                   | 1000                                                                                    | 1814 Byte                                                                                 |      | 4 ms                                                                                         | 4744 KiB                                                                                     | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67828468) |
| 2025-07-22 16:55:59                                                                           | [B30 - Combination 2](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_dc) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [PHP (php 8.2.8)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5016)                  | 1000                                                                                    | 2095 Byte                                                                                 |      | 25 ms                                                                                        | 27708 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67828372) |
| 2025-07-22 16:49:15                                                                           | [B30 - Combination 2](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_dc) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Python (CPython 3.11.4)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5055)          | 1000                                                                                    | 1723 Byte                                                                                 |      | 63 ms                                                                                        | 26292 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67828205) |
| 2025-07-22 16:39:36                                                                           | [B30 - Combination 2](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_dc) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [TypeScript 5.1 (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5058) | 1000                                                                                    | 2121 Byte                                                                                 |      | 121 ms                                                                                       | 74100 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67827976) |
| 2025-07-22 16:33:46                                                                           | [B30 - Combination 2](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_dc) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [JavaScript (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5009)     | 1000                                                                                    | 1703 Byte                                                                                 |      | 158 ms                                                                                       | 73836 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67827821) |
