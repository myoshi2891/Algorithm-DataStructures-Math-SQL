<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Sleep - éåŒæœŸã‚¹ãƒªãƒ¼ãƒ—é–¢æ•°ã®å®Ÿè£…</title>

        <!-- Tailwind CSS -->
        <script src="/vendor/tailwindcss/script.js"></script>

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&family=Source+Code+Pro:wght@400;600;700&display=swap"
            rel="stylesheet"
        />

        <!-- Prism.js CSS -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/line-numbers/prism-line-numbers.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/toolbar/prism-toolbar.css"
        />

        <style>
            html {
                scroll-behavior: smooth;
            }

            body {
                font-family: 'Inter', sans-serif;
                background: linear-gradient(135deg, #f0fdf4 0%, #e0f2fe 100%);
            }

            code,
            pre {
                font-family: 'JetBrains Mono', 'Source Code Pro', monospace;
            }

            /* Prism.js toolbar customization */
            .code-toolbar > .toolbar {
                opacity: 1;
            }

            .code-toolbar > .toolbar button {
                background: #10b981;
                color: white;
                border: none;
                padding: 0.5rem 1rem;
                border-radius: 0.5rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s;
            }

            .code-toolbar > .toolbar button:hover {
                background: #059669;
                transform: translateY(-2px);
            }

            /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
            .custom-scrollbar::-webkit-scrollbar {
                width: 6px;
            }
            .custom-scrollbar::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 3px;
            }
            .custom-scrollbar::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 3px;
            }
            .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
            }

            /* ãƒ†ã‚­ã‚¹ãƒˆåˆ‡ã‚Šè©°ã‚ */
            .line-clamp-2 {
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            /* ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ãƒ›ãƒãƒ¼åŠ¹æœ - ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã®ã¿ï¼ˆscaleã¯å‰Šé™¤ï¼‰ */
            .flowchart-node {
                transition: opacity 0.3s ease;
            }
        </style>
    </head>
    <body class="p-4 md:p-8">
        <div class="max-w-[1400px] mx-auto">
            <!-- Header -->
            <header
                id="header"
                class="mb-8 rounded-2xl p-8 shadow-[0_10px_30px_rgba(16,185,129,0.10)] bg-[linear-gradient(135deg,#d1fae5,#bfdbfe)]"
            >
                <h1 class="text-[2.5rem] font-bold text-teal-800 mb-2">
                    Sleep - éåŒæœŸã‚¹ãƒªãƒ¼ãƒ—é–¢æ•°
                </h1>
                <p class="text-xl text-cyan-700 font-semibold mt-2">
                    Promise + setTimeout ã«ã‚ˆã‚‹ O(1) å®Ÿè£…
                </p>
                <nav class="flex flex-wrap gap-4 mt-6">
                    <a
                        href="#overview"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="æ¦‚è¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ç§»å‹•"
                    >
                        æ¦‚è¦
                    </a>
                    <a
                        href="#steps"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ç§»å‹•"
                    >
                        ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬
                    </a>
                    <a
                        href="#code"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ç§»å‹•"
                    >
                        ã‚³ãƒ¼ãƒ‰å®Ÿè£…
                    </a>
                    <a
                        href="#diagram"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ç§»å‹•"
                    >
                        ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
                    </a>
                    <a
                        href="#complexity"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="è¨ˆç®—é‡åˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¸ç§»å‹•"
                    >
                        è¨ˆç®—é‡
                    </a>
                </nav>
            </header>

            <!-- Overview -->
            <section id="overview" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¦‚è¦
                </h2>

                <h3 class="text-xl font-bold text-teal-800 mt-6 mb-3">å•é¡Œèª¬æ˜</h3>
                <p class="text-slate-700 leading-7 mb-4">
                    æ­£ã®æ•´æ•°
                    <code class="bg-slate-100 px-2 py-1 rounded text-sm">millis</code>
                    ã‚’å—ã‘å–ã‚Šã€ãã®æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰ã ã‘éåŒæœŸã«ã‚¹ãƒªãƒ¼ãƒ—ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã—ã¾ã™ã€‚å®Ÿéš›ã®ã‚¹ãƒªãƒ¼ãƒ—æ™‚é–“ãŒ
                    <code class="bg-slate-100 px-2 py-1 rounded text-sm">millis</code>
                    ã‹ã‚‰è‹¥å¹²ãšã‚Œã¦ã‚‚è¨±å®¹ã•ã‚Œã¾ã™ã€‚
                </p>

                <h3 class="text-xl font-bold text-teal-800 mt-6 mb-3">å…¥å‡ºåŠ›ä¾‹</h3>
                <div class="bg-slate-50 p-4 rounded-lg mb-4">
                    <p class="font-semibold text-slate-800 mb-2">ä¾‹1:</p>
                    <pre
                        class="bg-slate-800 text-slate-100 p-4 rounded overflow-x-auto"
                    ><code>Input: millis = 100
Output: 100
Explanation: 100msã‚¹ãƒªãƒ¼ãƒ—å¾Œã«å®Œäº†ã™ã‚‹</code></pre>
                </div>

                <div class="bg-slate-50 p-4 rounded-lg mb-4">
                    <p class="font-semibold text-slate-800 mb-2">ä¾‹2:</p>
                    <pre
                        class="bg-slate-800 text-slate-100 p-4 rounded overflow-x-auto"
                    ><code>Input: millis = 200
Output: 200
Explanation: 200msã‚¹ãƒªãƒ¼ãƒ—å¾Œã«å®Œäº†ã™ã‚‹</code></pre>
                </div>

                <h3 class="text-xl font-bold text-teal-800 mt-6 mb-3">åˆ¶ç´„æ¡ä»¶</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li>
                        <code class="bg-slate-100 px-2 py-1 rounded text-sm"
                            >1 â‰¤ millis â‰¤ 1000</code
                        >
                    </li>
                    <li>
                        æˆ»ã‚Šå€¤ã¯ä»»æ„ï¼ˆé€šå¸¸ã¯
                        <code class="bg-slate-100 px-2 py-1 rounded text-sm">void</code> ã¾ãŸã¯
                        <code class="bg-slate-100 px-2 py-1 rounded text-sm">undefined</code>ï¼‰
                    </li>
                    <li>å®Ÿéš›ã®ã‚¹ãƒªãƒ¼ãƒ—æ™‚é–“ã®è‹¥å¹²ã®ãšã‚Œã¯è¨±å®¹ã•ã‚Œã‚‹</li>
                </ul>

                <h3 class="text-xl font-bold text-teal-800 mt-6 mb-3">æˆ¦ç•¥</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li><strong>Promise</strong>: éåŒæœŸå‡¦ç†ã®çµæœã‚’è¡¨ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</li>
                    <li><strong>setTimeout</strong>: æŒ‡å®šæ™‚é–“å¾Œã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œ</li>
                    <li><strong>resolve</strong>: Promiseã‚’å®Œäº†çŠ¶æ…‹ã«ã™ã‚‹é–¢æ•°ã‚’setTimeoutã«æ¸¡ã™</li>
                    <li><strong>async/await</strong>: å‘¼ã³å‡ºã—å´ã§ç°¡æ½”ã«å¾…æ©Ÿã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹</li>
                </ul>

                <h3 class="text-xl font-bold text-teal-800 mt-6 mb-3">ä¸»è¦ãƒã‚¤ãƒ³ãƒˆ</h3>
                <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded">
                    <p class="text-slate-700">
                        <strong class="text-emerald-700">æ™‚é–“è¨ˆç®—é‡:</strong> O(1) -
                        å®šæ•°æ™‚é–“ã§ã®å‡¦ç†é–‹å§‹
                    </p>
                    <p class="text-slate-700 mt-2">
                        <strong class="text-emerald-700">ç©ºé–“è¨ˆç®—é‡:</strong> O(1) -
                        Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ1ã¤ã®ã¿
                    </p>
                    <p class="text-slate-700 mt-2">
                        <strong class="text-emerald-700">æœ€é©åŒ–æ‰‹æ³•:</strong>
                        å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸è¦ã€æ¨™æº–API ã®ã¿ä½¿ç”¨
                    </p>
                </div>
            </section>

            <!-- Steps -->
            <section id="steps" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬
                </h2>
                <div id="react-root"></div>
            </section>

            <!-- Code -->
            <section id="code" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    TypeScriptå®Ÿè£…
                </h2>
                <pre class="line-numbers"><code class="language-typescript">/**
 * æŒ‡å®šã•ã‚ŒãŸãƒŸãƒªç§’æ•°ã ã‘éåŒæœŸã«ã‚¹ãƒªãƒ¼ãƒ—ã™ã‚‹é–¢æ•°
 * @param millis - å¾…æ©Ÿã™ã‚‹ãƒŸãƒªç§’æ•°ï¼ˆ1-1000ï¼‰
 * @returns void ã‚’è§£æ±ºã™ã‚‹Promise
 * @complexity Time: O(1), Space: O(1)
 */
async function sleep(millis: number): Promise&lt;void&gt; {
    // Promiseã§ãƒ©ãƒƒãƒ—ã—ãŸ setTimeout ã«ã‚ˆã‚‹éåŒæœŸå¾…æ©Ÿ
    return new Promise&lt;void&gt;((resolve) => {
        setTimeout(resolve, millis);
    });
}

/**
 * ä½¿ç”¨ä¾‹
 */
let t = Date.now();
sleep(100).then(() => {
    console.log(Date.now() - t); // ~100
});</code></pre>

                <h3 class="text-xl font-bold text-teal-800 mt-8 mb-3">
                    ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä»˜ãå®Ÿè£…
                </h3>
                <pre
                    class="line-numbers"
                ><code class="language-typescript">async function sleep(millis: number): Promise&lt;void&gt; {
    // å‹ã‚¬ãƒ¼ãƒ‰: æ•°å€¤ãƒã‚§ãƒƒã‚¯
    if (typeof millis !== 'number' || Number.isNaN(millis)) {
        throw new TypeError('millis must be a valid number');
    }

    // ç¯„å›²ãƒã‚§ãƒƒã‚¯ï¼ˆåˆ¶ç´„æ¡ä»¶: 1 &lt;= millis &lt;= 1000ï¼‰
    if (millis &lt; 1 || millis &gt; 1000) {
        throw new RangeError('millis must be between 1 and 1000');
    }

    // æ•´æ•°ãƒã‚§ãƒƒã‚¯ï¼ˆæ­£ã®æ•´æ•°è¦ä»¶ï¼‰
    if (!Number.isInteger(millis)) {
        throw new RangeError('millis must be an integer');
    }

    // Promise ã§ãƒ©ãƒƒãƒ—ã—ãŸ setTimeout ã«ã‚ˆã‚‹éåŒæœŸå¾…æ©Ÿ
    return new Promise&lt;void&gt;((resolve) => {
        setTimeout(resolve, millis);
    });
}</code></pre>
            </section>

            <!-- Diagram -->
            <section id="diagram" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
                </h2>
                <div id="flowchart-root"></div>
            </section>

            <!-- Complexity -->
            <section id="complexity" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    è¨ˆç®—é‡åˆ†æ
                </h2>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-emerald-50">
                                <th
                                    class="border border-emerald-200 px-4 py-3 text-left font-semibold text-teal-800"
                                >
                                    é …ç›®
                                </th>
                                <th
                                    class="border border-emerald-200 px-4 py-3 text-left font-semibold text-teal-800"
                                >
                                    è¨ˆç®—é‡
                                </th>
                                <th
                                    class="border border-emerald-200 px-4 py-3 text-left font-semibold text-teal-800"
                                >
                                    èª¬æ˜
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    æ™‚é–“è¨ˆç®—é‡
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-slate-600">
                                    Promiseä½œæˆã¨setTimeoutã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã¯å®šæ•°æ™‚é–“
                                </td>
                            </tr>
                            <tr class="bg-slate-50">
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    ç©ºé–“è¨ˆç®—é‡
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-slate-600">
                                    Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã®ã¿
                                </td>
                            </tr>
                            <tr>
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    å®Ÿéš›ã®å¾…æ©Ÿæ™‚é–“
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-sky-50 px-2 py-1 rounded text-sky-700"
                                        >O(millis)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-slate-600">
                                    å®Ÿæ™‚é–“ã ãŒè¨ˆç®—é‡ã§ã¯ãªã„ï¼ˆCPUå‡¦ç†æ™‚é–“ã¯ç„¡ã—ï¼‰
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-bold text-teal-800 mt-8 mb-4">å®Ÿè£…æ‰‹æ³•ã®æ¯”è¼ƒ</h3>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-cyan-50">
                                <th
                                    class="border border-cyan-200 px-4 py-3 text-left font-semibold text-cyan-800"
                                >
                                    æ‰‹æ³•
                                </th>
                                <th
                                    class="border border-cyan-200 px-4 py-3 text-left font-semibold text-cyan-800"
                                >
                                    æ™‚é–“
                                </th>
                                <th
                                    class="border border-cyan-200 px-4 py-3 text-left font-semibold text-cyan-800"
                                >
                                    ç©ºé–“
                                </th>
                                <th
                                    class="border border-cyan-200 px-4 py-3 text-left font-semibold text-cyan-800"
                                >
                                    CPUä½¿ç”¨ç‡
                                </th>
                                <th
                                    class="border border-cyan-200 px-4 py-3 text-left font-semibold text-cyan-800"
                                >
                                    æ¨å¥¨åº¦
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    Promise + setTimeout
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-emerald-600">
                                    0%ï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-emerald-700">
                                    â­â­â­â­â­
                                </td>
                            </tr>
                            <tr class="bg-slate-50">
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    Busy Waitï¼ˆwhile loopï¼‰
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-red-50 px-2 py-1 rounded text-red-700"
                                        >O(millis)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-red-600">
                                    100%ï¼ˆãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-red-700">
                                    âœ— éæ¨å¥¨
                                </td>
                            </tr>
                            <tr>
                                <td
                                    class="border border-slate-200 px-4 py-3 font-semibold text-slate-700"
                                >
                                    setInterval + clearInterval
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3">
                                    <code class="bg-emerald-50 px-2 py-1 rounded text-emerald-700"
                                        >O(1)</code
                                    >
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-emerald-600">
                                    0%ï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰
                                </td>
                                <td class="border border-slate-200 px-4 py-3 text-yellow-600">
                                    â­â­ ä¸è¦ãªè¤‡é›‘æ€§
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded mt-6">
                    <p class="text-slate-700 font-semibold">âœ… æ¨å¥¨: Promise + setTimeout</p>
                    <p class="text-slate-600 mt-2">
                        æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§åŠ¹ç‡çš„ã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã›ãšã€ä»–ã®ã‚¿ã‚¹ã‚¯ãŒä¸¦è¡Œå®Ÿè¡Œå¯èƒ½ã€‚
                    </p>
                </div>
            </section>
        </div>

        <!-- React -->
        <script crossorigin src="/vendor/react/react.development.js"></script>
        <script
            crossorigin
            src="/vendor/react-dom/react-dom.development.js"
        ></script>
        <script src="/vendor/babel/babel.min.js"></script>

        <!-- Prism.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

        <!-- React Component -->
        <script type="text/babel">
            const { useState, useEffect, useRef } = React;

            // ã‚¹ãƒ†ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿
            const stepsData = [
                {
                    step: 1,
                    title: 'é–¢æ•°å‘¼ã³å‡ºã—',
                    desc: 'sleep(100) ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã€‚millis = 100 ã‚’å—ã‘å–ã‚‹ã€‚',
                    visual: {
                        type: 'init',
                        millis: 100,
                        state: 'called',
                    },
                },
                {
                    step: 2,
                    title: 'Promiseä½œæˆ',
                    desc: 'new Promise((resolve) => {...}) ã§Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€‚ã“ã®æ™‚ç‚¹ã§Promiseã¯PendingçŠ¶æ…‹ã€‚',
                    visual: {
                        type: 'promise',
                        millis: 100,
                        state: 'pending',
                        time: 0,
                    },
                },
                {
                    step: 3,
                    title: 'setTimeoutã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«',
                    desc: 'setTimeout(resolve, 100) ã§ã‚¿ã‚¤ãƒãƒ¼ã‚’ç™»éŒ²ã€‚100mså¾Œã«resolveé–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã‚ˆã†ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã€‚',
                    visual: {
                        type: 'schedule',
                        millis: 100,
                        state: 'scheduled',
                        time: 0,
                    },
                },
                {
                    step: 4,
                    title: 'å¾…æ©Ÿä¸­ (25msçµŒé)',
                    desc: 'Promiseã¯ä¾ç„¶ã¨ã—ã¦PendingçŠ¶æ…‹ã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã¯ä»–ã®ã‚¿ã‚¹ã‚¯ã‚’å‡¦ç†å¯èƒ½ï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰ã€‚',
                    visual: {
                        type: 'waiting',
                        millis: 100,
                        state: 'pending',
                        time: 25,
                    },
                },
                {
                    step: 5,
                    title: 'å¾…æ©Ÿä¸­ (50msçµŒé)',
                    desc: 'ã¾ã æ™‚é–“ãŒçµŒéã—ã¦ã„ãªã„ãŸã‚ã€Promiseã¯å¾…æ©Ÿä¸­ã€‚CPUã¯ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã€‚',
                    visual: {
                        type: 'waiting',
                        millis: 100,
                        state: 'pending',
                        time: 50,
                    },
                },
                {
                    step: 6,
                    title: 'å¾…æ©Ÿä¸­ (75msçµŒé)',
                    desc: 'ã‚‚ã†ã™ãã‚¿ã‚¤ãƒãƒ¼ãŒç™ºç«ã€‚å¼•ãç¶šãéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã§å¾…æ©Ÿã€‚',
                    visual: {
                        type: 'waiting',
                        millis: 100,
                        state: 'pending',
                        time: 75,
                    },
                },
                {
                    step: 7,
                    title: 'ã‚¿ã‚¤ãƒãƒ¼ç™ºç« (100ms)',
                    desc: '100msçµŒéã€‚ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ãŒsetTimeoutã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆresolveï¼‰ã‚’å®Ÿè¡Œã€‚',
                    visual: {
                        type: 'callback',
                        millis: 100,
                        state: 'firing',
                        time: 100,
                    },
                },
                {
                    step: 8,
                    title: 'Promiseå®Œäº†',
                    desc: 'resolve()ãŒå®Ÿè¡Œã•ã‚Œã€PromiseãŒPendingã‹ã‚‰ResolvedçŠ¶æ…‹ã«é·ç§»ã€‚await sleep(100)ãŒå†é–‹ã•ã‚Œã‚‹ã€‚',
                    visual: {
                        type: 'resolved',
                        millis: 100,
                        state: 'resolved',
                        time: 100,
                    },
                },
            ];

            // å¯è¦–åŒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæ”¹å–„ç‰ˆï¼‰
            function StepVisualization({ visual, stepNumber, totalSteps }) {
                const { type, millis, state, time } = visual;

                // ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
                const progress = time !== undefined ? time / millis : 0;
                const progressPercent = Math.min(progress * 100, 100);

                // çŠ¶æ…‹ã«å¿œã˜ãŸè‰²ã¨ãƒ©ãƒ™ãƒ«ã®å®šç¾©
                const stateConfig = {
                    called: {
                        bg: '#dbeafe',
                        border: '#3b82f6',
                        text: '#1d4ed8',
                        label: 'Called',
                        icon: 'ğŸš€',
                    },
                    pending: {
                        bg: '#fef3c7',
                        border: '#f59e0b',
                        text: '#92400e',
                        label: 'Pending',
                        icon: 'â³',
                    },
                    scheduled: {
                        bg: '#e0f2fe',
                        border: '#0284c7',
                        text: '#075985',
                        label: 'Scheduled',
                        icon: 'ğŸ“‹',
                    },
                    firing: {
                        bg: '#fce7f3',
                        border: '#ec4899',
                        text: '#9d174d',
                        label: 'Firing',
                        icon: 'ğŸ””',
                    },
                    resolved: {
                        bg: '#d1fae5',
                        border: '#10b981',
                        text: '#065f46',
                        label: 'Resolved',
                        icon: 'âœ…',
                    },
                };
                const currentState = stateConfig[state] || stateConfig.called;

                return (
                    <div className="mt-4">
                        {/* ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}
                        <div className="flex items-center justify-between mb-4 px-2">
                            <div className="flex items-center gap-2">
                                {Array.from({ length: totalSteps }, (_, i) => (
                                    <div
                                        key={i}
                                        className={`w-3 h-3 rounded-full transition-all duration-300 ${
                                            i + 1 === stepNumber
                                                ? 'bg-emerald-500 scale-125 ring-2 ring-emerald-200'
                                                : i + 1 < stepNumber
                                                  ? 'bg-emerald-300'
                                                  : 'bg-slate-200'
                                        }`}
                                    />
                                ))}
                            </div>
                            <span className="text-sm font-semibold text-slate-500">
                                {stepNumber} / {totalSteps}
                            </span>
                        </div>

                        <svg
                            viewBox="0 0 600 320"
                            style={{ maxWidth: '100%', height: 'auto' }}
                            role="img"
                            aria-label="Sleepé–¢æ•°ã®çŠ¶æ…‹"
                        >
                            <defs>
                                {/* ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */}
                                <linearGradient id="timelineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stopColor="#10b981" />
                                    <stop offset="100%" stopColor="#0ea5e9" />
                                </linearGradient>
                                <linearGradient id="progressGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stopColor="#34d399" />
                                    <stop offset="100%" stopColor="#22d3ee" />
                                </linearGradient>
                                {/* ãƒ‘ãƒ«ã‚¹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */}
                                <filter id="glow">
                                    <feGaussianBlur stdDeviation="3" result="coloredBlur" />
                                    <feMerge>
                                        <feMergeNode in="coloredBlur" />
                                        <feMergeNode in="SourceGraphic" />
                                    </feMerge>
                                </filter>
                            </defs>

                            {/* èƒŒæ™¯ */}
                            <rect x="0" y="0" width="600" height="320" rx="16" fill="#f8fafc" />

                            {/* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ©ãƒ™ãƒ« */}
                            <text x="50" y="30" fontSize="14" fontWeight="600" fill="#475569">
                                ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
                            </text>

                            {/* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³èƒŒæ™¯ */}
                            <rect x="50" y="45" width="500" height="50" rx="12" fill="#e2e8f0" />

                            {/* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€²æ— */}
                            <rect
                                x="50"
                                y="45"
                                width={Math.max(500 * progress, progress > 0 ? 24 : 0)}
                                height="50"
                                rx="12"
                                fill="url(#progressGrad)"
                                style={{ transition: 'width 0.5s ease-out' }}
                            />

                            {/* ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ */}
                            <text
                                x="300"
                                y="75"
                                textAnchor="middle"
                                dominantBaseline="middle"
                                fontSize="18"
                                fontWeight="bold"
                                fill="#1e293b"
                            >
                                {time !== undefined ? `${time}ms` : '0ms'} / {millis}ms
                            </text>

                            {/* é€²æ—ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆï¼ˆå³ä¸Šï¼‰ */}
                            <text
                                x="540"
                                y="30"
                                textAnchor="end"
                                fontSize="14"
                                fontWeight="bold"
                                fill={state === 'resolved' ? '#059669' : '#64748b'}
                            >
                                {progressPercent.toFixed(0)}%
                            </text>

                            {/* PromiseçŠ¶æ…‹ã‚«ãƒ¼ãƒ‰ */}
                            <g transform="translate(100, 115)">
                                <rect
                                    x="0"
                                    y="0"
                                    width="400"
                                    height="100"
                                    rx="16"
                                    fill={currentState.bg}
                                    stroke={currentState.border}
                                    strokeWidth="3"
                                    filter={
                                        state === 'firing' || state === 'resolved'
                                            ? 'url(#glow)'
                                            : ''
                                    }
                                    style={{ transition: 'all 0.3s ease' }}
                                />

                                {/* ã‚¢ã‚¤ã‚³ãƒ³ */}
                                <text
                                    x="50"
                                    y="55"
                                    fontSize="36"
                                    textAnchor="middle"
                                    dominantBaseline="middle"
                                >
                                    {currentState.icon}
                                </text>

                                {/* çŠ¶æ…‹ãƒ©ãƒ™ãƒ« */}
                                <text
                                    x="200"
                                    y="40"
                                    textAnchor="middle"
                                    dominantBaseline="middle"
                                    fontSize="14"
                                    fontWeight="600"
                                    fill="#64748b"
                                >
                                    Promise State
                                </text>
                                <text
                                    x="200"
                                    y="70"
                                    textAnchor="middle"
                                    dominantBaseline="middle"
                                    fontSize="28"
                                    fontWeight="bold"
                                    fill={currentState.text}
                                >
                                    {currentState.label}
                                </text>

                                {/* çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}
                                <circle
                                    cx="370"
                                    cy="50"
                                    r="12"
                                    fill={currentState.border}
                                    style={{
                                        animation:
                                            state === 'pending' || state === 'scheduled'
                                                ? 'pulse 2s infinite'
                                                : 'none',
                                    }}
                                />
                            </g>

                            {/* ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ— & CPUçŠ¶æ…‹ */}
                            {state !== 'called' && (
                                <g transform="translate(0, 235)">
                                    {/* ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ— */}
                                    <rect
                                        x="50"
                                        y="0"
                                        width="240"
                                        height="60"
                                        rx="12"
                                        fill={state === 'resolved' ? '#ecfdf5' : '#f0f9ff'}
                                        stroke={state === 'resolved' ? '#10b981' : '#0ea5e9'}
                                        strokeWidth="2"
                                    />
                                    <text
                                        x="70"
                                        y="25"
                                        fontSize="12"
                                        fontWeight="600"
                                        fill="#64748b"
                                    >
                                        Event Loop
                                    </text>
                                    <text
                                        x="70"
                                        y="45"
                                        fontSize="16"
                                        fontWeight="bold"
                                        fill={state === 'resolved' ? '#065f46' : '#0c4a6e'}
                                    >
                                        {state === 'resolved' ? 'âœ“ å®Œäº†' : 'âŸ³ å®Ÿè¡Œä¸­...'}
                                    </text>

                                    {/* CPUçŠ¶æ…‹ */}
                                    <rect
                                        x="310"
                                        y="0"
                                        width="240"
                                        height="60"
                                        rx="12"
                                        fill={state === 'resolved' ? '#fef3c7' : '#ecfdf5'}
                                        stroke={state === 'resolved' ? '#f59e0b' : '#10b981'}
                                        strokeWidth="2"
                                    />
                                    <text
                                        x="330"
                                        y="25"
                                        fontSize="12"
                                        fontWeight="600"
                                        fill="#64748b"
                                    >
                                        CPU Usage
                                    </text>
                                    <text
                                        x="330"
                                        y="45"
                                        fontSize="16"
                                        fontWeight="bold"
                                        fill={state === 'resolved' ? '#92400e' : '#065f46'}
                                    >
                                        {state === 'resolved'
                                            ? 'âš¡ ã‚¢ã‚¯ãƒ†ã‚£ãƒ–'
                                            : 'ğŸ’¤ ã‚¢ã‚¤ãƒ‰ãƒ« (0%)'}
                                    </text>
                                </g>
                            )}
                        </svg>

                        <style>{`
                            @keyframes pulse {
                                0%, 100% { opacity: 1; transform: scale(1); }
                                50% { opacity: 0.5; transform: scale(1.1); }
                            }
                        `}</style>
                    </div>
                );
            }

            // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæ”¹å–„ç‰ˆï¼‰
            function StepsExplanation() {
                const [activeStep, setActiveStep] = useState(1);
                const [isPlaying, setIsPlaying] = useState(false);
                const timerRef = useRef(null);

                // è‡ªå‹•å†ç”Ÿãƒ­ã‚¸ãƒƒã‚¯
                useEffect(() => {
                    if (isPlaying) {
                        if (activeStep > stepsData.length) {
                            setIsPlaying(false);
                            setActiveStep(1);
                            return;
                        }

                        timerRef.current = setTimeout(() => {
                            if (activeStep === stepsData.length) {
                                setActiveStep(1);
                                setIsPlaying(false);
                            } else {
                                setActiveStep((prev) => prev + 1);
                            }
                        }, 2000);
                    }
                    return () => {
                        if (timerRef.current) clearTimeout(timerRef.current);
                    };
                }, [isPlaying, activeStep]);

                const handlePlay = () => {
                    if (isPlaying) {
                        setIsPlaying(false);
                    } else {
                        if (activeStep === stepsData.length) {
                            setActiveStep(1);
                        }
                        setIsPlaying(true);
                    }
                };

                const handlePrev = () => {
                    if (activeStep > 1) {
                        setActiveStep((prev) => prev - 1);
                        setIsPlaying(false);
                    }
                };

                const handleNext = () => {
                    if (activeStep < stepsData.length) {
                        setActiveStep((prev) => prev + 1);
                        setIsPlaying(false);
                    }
                };

                const handleReset = () => {
                    setActiveStep(1);
                    setIsPlaying(false);
                };

                const handleStepClick = (step) => {
                    setActiveStep(step);
                    setIsPlaying(false);
                };

                const currentStepData =
                    stepsData.find((s) => s.step === activeStep) || stepsData[0];

                return (
                    <div className="grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-6">
                        {/* å·¦: ã‚¹ãƒ†ãƒƒãƒ—ãƒªã‚¹ãƒˆ */}
                        <div className="lg:max-h-[600px] lg:overflow-y-auto lg:pr-2 custom-scrollbar">
                            <div className="flex items-center justify-between mb-4">
                                <h3 className="text-teal-800 text-lg font-semibold m-0">
                                    ã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§
                                </h3>
                                <span className="text-xs font-medium text-slate-400 bg-slate-100 px-2 py-1 rounded-full">
                                    {activeStep}/{stepsData.length}
                                </span>
                            </div>

                            {/* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */}
                            <div className="w-full h-1.5 bg-slate-200 rounded-full mb-4 overflow-hidden">
                                <div
                                    className="h-full bg-gradient-to-r from-emerald-400 to-cyan-400 rounded-full transition-all duration-500"
                                    style={{ width: `${(activeStep / stepsData.length) * 100}%` }}
                                />
                            </div>

                            <div className="space-y-2">
                                {stepsData.map((step) => {
                                    const isActive = activeStep === step.step;
                                    const isCompleted = step.step < activeStep;
                                    return (
                                        <button
                                            key={step.step}
                                            type="button"
                                            className={[
                                                'w-full text-left rounded-xl border-2 transition-all duration-200 cursor-pointer p-3',
                                                'hover:border-emerald-400 hover:shadow-md',
                                                isActive
                                                    ? 'bg-gradient-to-r from-emerald-50 to-cyan-50 border-emerald-500 shadow-lg shadow-emerald-100'
                                                    : isCompleted
                                                      ? 'bg-slate-50 border-slate-200'
                                                      : 'bg-white border-slate-200',
                                            ].join(' ')}
                                            onClick={() => handleStepClick(step.step)}
                                            aria-label={`ã‚¹ãƒ†ãƒƒãƒ—${step.step}: ${step.title}`}
                                            aria-current={isActive ? 'step' : undefined}
                                        >
                                            <div className="flex items-start gap-3">
                                                {/* ã‚¹ãƒ†ãƒƒãƒ—ç•ªå·/ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¤ã‚³ãƒ³ */}
                                                <div
                                                    className={[
                                                        'flex-shrink-0 w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold transition-all',
                                                        isActive
                                                            ? 'bg-emerald-500 text-white'
                                                            : isCompleted
                                                              ? 'bg-emerald-100 text-emerald-600'
                                                              : 'bg-slate-100 text-slate-500',
                                                    ].join(' ')}
                                                >
                                                    {isCompleted ? 'âœ“' : step.step}
                                                </div>
                                                <div className="flex-1 min-w-0">
                                                    <div
                                                        className={[
                                                            'font-semibold text-sm leading-tight',
                                                            isActive
                                                                ? 'text-emerald-800'
                                                                : 'text-slate-700',
                                                        ].join(' ')}
                                                    >
                                                        {step.title}
                                                    </div>
                                                    {isActive && (
                                                        <div className="text-slate-500 text-xs mt-1 line-clamp-2">
                                                            {step.desc}
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* å³: å¯è¦–åŒ– + ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */}
                        <div className="flex flex-col">
                            {/* ã‚¹ãƒ†ãƒƒãƒ—è©³ç´°ã‚«ãƒ¼ãƒ‰ */}
                            <div className="rounded-2xl p-6 border-2 border-emerald-100 bg-gradient-to-br from-white to-emerald-50/30 shadow-sm">
                                <div className="flex items-center gap-3 mb-3">
                                    <span className="flex items-center justify-center w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 text-white font-bold text-lg shadow-lg shadow-emerald-200">
                                        {currentStepData.step}
                                    </span>
                                    <h3 className="text-xl font-bold text-slate-800 m-0">
                                        {currentStepData.title}
                                    </h3>
                                    {isPlaying && (
                                        <span className="ml-auto flex items-center gap-1.5 text-emerald-600 text-sm font-medium">
                                            <span className="relative flex h-2 w-2">
                                                <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                                <span className="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                                            </span>
                                            å†ç”Ÿä¸­
                                        </span>
                                    )}
                                </div>
                                <p className="text-slate-600 leading-relaxed m-0 text-sm">
                                    {currentStepData.desc}
                                </p>
                            </div>

                            {/* å¯è¦–åŒ–SVG */}
                            <StepVisualization
                                visual={currentStepData.visual}
                                stepNumber={activeStep}
                                totalSteps={stepsData.length}
                            />

                            {/* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ */}
                            <div className="flex flex-wrap justify-center items-center gap-3 mt-4">
                                <button
                                    type="button"
                                    className={[
                                        'flex items-center gap-2 px-5 py-2.5 rounded-xl font-semibold text-white transition-all duration-200 shadow-lg',
                                        isPlaying
                                            ? 'bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 shadow-amber-200'
                                            : 'bg-gradient-to-r from-emerald-500 to-cyan-500 hover:from-emerald-600 hover:to-cyan-600 shadow-emerald-200',
                                    ].join(' ')}
                                    onClick={handlePlay}
                                    aria-label={isPlaying ? 'ä¸€æ™‚åœæ­¢' : 'è‡ªå‹•å†ç”Ÿ'}
                                >
                                    <svg
                                        className="w-4 h-4"
                                        fill="currentColor"
                                        viewBox="0 0 20 20"
                                    >
                                        {isPlaying ? (
                                            <path
                                                fillRule="evenodd"
                                                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z"
                                                clipRule="evenodd"
                                            />
                                        ) : (
                                            <path
                                                fillRule="evenodd"
                                                d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                                                clipRule="evenodd"
                                            />
                                        )}
                                    </svg>
                                    {isPlaying ? 'Pause' : 'Play'}
                                </button>

                                <div className="flex items-center gap-1 bg-white rounded-xl border-2 border-slate-200 p-1">
                                    <button
                                        type="button"
                                        className="flex items-center justify-center w-10 h-10 rounded-lg font-semibold text-slate-600 transition-all hover:bg-slate-100 disabled:opacity-40 disabled:cursor-not-allowed"
                                        onClick={handlePrev}
                                        disabled={activeStep === 1}
                                        aria-label="å‰ã®ã‚¹ãƒ†ãƒƒãƒ—"
                                    >
                                        <svg
                                            className="w-5 h-5"
                                            fill="none"
                                            stroke="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path
                                                strokeLinecap="round"
                                                strokeLinejoin="round"
                                                strokeWidth={2}
                                                d="M15 19l-7-7 7-7"
                                            />
                                        </svg>
                                    </button>
                                    <span className="px-3 text-sm font-medium text-slate-500 min-w-[60px] text-center">
                                        {activeStep} / {stepsData.length}
                                    </span>
                                    <button
                                        type="button"
                                        className="flex items-center justify-center w-10 h-10 rounded-lg font-semibold text-slate-600 transition-all hover:bg-slate-100 disabled:opacity-40 disabled:cursor-not-allowed"
                                        onClick={handleNext}
                                        disabled={activeStep === stepsData.length}
                                        aria-label="æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—"
                                    >
                                        <svg
                                            className="w-5 h-5"
                                            fill="none"
                                            stroke="currentColor"
                                            viewBox="0 0 24 24"
                                        >
                                            <path
                                                strokeLinecap="round"
                                                strokeLinejoin="round"
                                                strokeWidth={2}
                                                d="M9 5l7 7-7 7"
                                            />
                                        </svg>
                                    </button>
                                </div>

                                <button
                                    type="button"
                                    className="flex items-center gap-2 px-4 py-2.5 rounded-xl font-semibold text-slate-600 transition-all bg-white border-2 border-slate-200 hover:border-slate-300 hover:bg-slate-50"
                                    onClick={handleReset}
                                    aria-label="ãƒªã‚»ãƒƒãƒˆ"
                                >
                                    <svg
                                        className="w-4 h-4"
                                        fill="none"
                                        stroke="currentColor"
                                        viewBox="0 0 24 24"
                                    >
                                        <path
                                            strokeLinecap="round"
                                            strokeLinejoin="round"
                                            strokeWidth={2}
                                            d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                                        />
                                    </svg>
                                    Reset
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç‰ˆï¼‰
            function FlowchartComponent() {
                const [hoveredNode, setHoveredNode] = useState(null);
                const [isAnimating, setIsAnimating] = useState(false);
                const [animationStep, setAnimationStep] = useState(0);

                const nodes = [
                    {
                        id: 'start',
                        label: 'é–‹å§‹',
                        sublabel: 'sleep(millis)',
                        type: 'terminal',
                        x: 300,
                        y: 40,
                    },
                    {
                        id: 'validate',
                        label: 'å…¥åŠ›æ¤œè¨¼',
                        sublabel: 'millis æœ‰åŠ¹?',
                        type: 'decision',
                        x: 300,
                        y: 140,
                    },
                    {
                        id: 'error',
                        label: 'ã‚¨ãƒ©ãƒ¼',
                        sublabel: 'TypeError / RangeError',
                        type: 'error',
                        x: 520,
                        y: 140,
                    },
                    {
                        id: 'promise',
                        label: 'Promiseä½œæˆ',
                        sublabel: 'new Promise(resolve)',
                        type: 'process',
                        x: 300,
                        y: 250,
                    },
                    {
                        id: 'timer',
                        label: 'ã‚¿ã‚¤ãƒãƒ¼ç™»éŒ²',
                        sublabel: 'setTimeout(resolve, millis)',
                        type: 'process',
                        x: 300,
                        y: 350,
                    },
                    {
                        id: 'wait',
                        label: 'å¾…æ©Ÿä¸­',
                        sublabel: 'Pending...',
                        type: 'wait',
                        x: 300,
                        y: 450,
                    },
                    {
                        id: 'callback',
                        label: 'ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯',
                        sublabel: 'resolve() å®Ÿè¡Œ',
                        type: 'process',
                        x: 300,
                        y: 550,
                    },
                    {
                        id: 'end',
                        label: 'å®Œäº†',
                        sublabel: 'Resolved',
                        type: 'terminal',
                        x: 300,
                        y: 650,
                    },
                ];

                const nodeDescriptions = {
                    start: 'sleepé–¢æ•°ãŒå‘¼ã³å‡ºã•ã‚Œã€å¼•æ•° millisï¼ˆå¾…æ©Ÿæ™‚é–“ï¼‰ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚',
                    validate:
                        'å…¥åŠ›å€¤ãŒæœ‰åŠ¹ã‹æ¤œè¨¼ã—ã¾ã™ã€‚æ•°å€¤å‹ã‹ã€1ã€œ1000ã®ç¯„å›²ã‹ã€æ•´æ•°ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã€‚',
                    error: 'æ¤œè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã€TypeError ã¾ãŸã¯ RangeError ã‚’ã‚¹ãƒ­ãƒ¼ã—ã¾ã™ã€‚',
                    promise:
                        'new Promise() ã§Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€‚ã“ã®æ™‚ç‚¹ã§Promiseã¯ Pending çŠ¶æ…‹ã€‚',
                    timer: 'setTimeout(resolve, millis) ã§ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—ã«ç™»éŒ²ã€‚',
                    wait: 'Promiseã¯ Pending çŠ¶æ…‹ã§å¾…æ©Ÿã€‚CPU ã¯ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ï¼ˆéãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ï¼‰ã€‚',
                    callback: 'æŒ‡å®šæ™‚é–“çµŒéå¾Œã€resolve() ãŒå‘¼ã°ã‚Œ Promise ãŒ Resolved çŠ¶æ…‹ã«é·ç§»ã€‚',
                    end: 'await ã—ã¦ã„ãŸç®‡æ‰€ãŒå†é–‹ã•ã‚Œã€sleepé–¢æ•°ãŒå®Œäº†ã—ã¾ã™ã€‚',
                };

                const animationOrder = [
                    'start',
                    'validate',
                    'promise',
                    'timer',
                    'wait',
                    'callback',
                    'end',
                ];

                useEffect(() => {
                    let timer;
                    if (isAnimating && animationStep < animationOrder.length) {
                        timer = setTimeout(() => {
                            setAnimationStep((prev) => prev + 1);
                        }, 800);
                    } else if (animationStep >= animationOrder.length) {
                        setIsAnimating(false);
                    }
                    return () => clearTimeout(timer);
                }, [isAnimating, animationStep]);

                const handleAnimate = () => {
                    setAnimationStep(0);
                    setIsAnimating(true);
                };

                const getNodeStyle = (node) => {
                    const isHovered = hoveredNode === node.id;
                    const isAnimated =
                        isAnimating && animationOrder.indexOf(node.id) < animationStep;
                    const isCurrent = isAnimating && animationOrder[animationStep - 1] === node.id;

                    const styles = {
                        terminal: { bg: '#d1fae5', border: '#10b981', text: '#065f46' },
                        decision: { bg: '#fef3c7', border: '#f59e0b', text: '#92400e' },
                        process: { bg: '#e0f2fe', border: '#0284c7', text: '#075985' },
                        wait: { bg: '#f1f5f9', border: '#64748b', text: '#334155' },
                        error: { bg: '#fee2e2', border: '#dc2626', text: '#991b1b' },
                    };

                    const style = styles[node.type];
                    return {
                        fill: isHovered || isCurrent ? style.border : style.bg,
                        stroke: style.border,
                        strokeWidth: isHovered || isCurrent ? 4 : 2,
                        textFill: isHovered || isCurrent ? '#ffffff' : style.text,
                        opacity: isAnimating && !isAnimated && !isCurrent ? 0.3 : 1,
                    };
                };

                const renderNode = (node) => {
                    const style = getNodeStyle(node);
                    const width = node.type === 'decision' ? 90 : 160;
                    const height = node.type === 'decision' ? 90 : 70;

                    return (
                        <g
                            key={node.id}
                            transform={`translate(${node.x}, ${node.y})`}
                            style={{
                                cursor: 'pointer',
                                opacity: style.opacity,
                            }}
                            onMouseEnter={() => setHoveredNode(node.id)}
                            onMouseLeave={() => setHoveredNode(null)}
                        >
                            {node.type === 'terminal' ? (
                                <ellipse
                                    cx="0"
                                    cy="0"
                                    rx="80"
                                    ry="35"
                                    fill={style.fill}
                                    stroke={style.stroke}
                                    strokeWidth={style.strokeWidth}
                                    style={{ transition: 'all 0.3s ease' }}
                                />
                            ) : node.type === 'decision' ? (
                                <path
                                    d={`M 0 -45 L 50 0 L 0 45 L -50 0 Z`}
                                    fill={style.fill}
                                    stroke={style.stroke}
                                    strokeWidth={style.strokeWidth}
                                    style={{ transition: 'all 0.3s ease' }}
                                />
                            ) : (
                                <rect
                                    x={-width / 2}
                                    y={-height / 2}
                                    width={width}
                                    height={height}
                                    rx="12"
                                    fill={style.fill}
                                    stroke={style.stroke}
                                    strokeWidth={style.strokeWidth}
                                    style={{ transition: 'all 0.3s ease' }}
                                />
                            )}
                            <text
                                x="0"
                                y={node.sublabel ? -8 : 0}
                                textAnchor="middle"
                                dominantBaseline="middle"
                                fontSize="14"
                                fontWeight="bold"
                                fill={style.textFill}
                                style={{ transition: 'all 0.3s ease' }}
                            >
                                {node.label}
                            </text>
                            {node.sublabel && (
                                <text
                                    x="0"
                                    y="12"
                                    textAnchor="middle"
                                    dominantBaseline="middle"
                                    fontSize="11"
                                    fill={style.textFill}
                                    opacity="0.85"
                                    style={{ transition: 'all 0.3s ease' }}
                                >
                                    {node.sublabel}
                                </text>
                            )}
                        </g>
                    );
                };

                return (
                    <div>
                        {/* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */}
                        <div className="flex items-center justify-between mb-4">
                            <p className="text-sm text-slate-500 m-0">ãƒãƒ¼ãƒ‰ã‚’ãƒ›ãƒãƒ¼ã§è©³ç´°ã‚’è¡¨ç¤º</p>
                            <button
                                type="button"
                                className={[
                                    'flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all',
                                    isAnimating
                                        ? 'bg-slate-200 text-slate-500 cursor-not-allowed'
                                        : 'bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:shadow-lg hover:shadow-emerald-200',
                                ].join(' ')}
                                onClick={handleAnimate}
                                disabled={isAnimating}
                            >
                                <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path
                                        fillRule="evenodd"
                                        d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                                        clipRule="evenodd"
                                    />
                                </svg>
                                ãƒ•ãƒ­ãƒ¼ã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                            </button>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-[1fr_280px] gap-6">
                            {/* SVGãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ */}
                            <div className="bg-slate-50 rounded-2xl p-4 border border-slate-200">
                                <svg
                                    viewBox="0 0 600 720"
                                    style={{ maxWidth: '100%', height: 'auto' }}
                                    role="img"
                                    aria-label="Sleepé–¢æ•°ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ"
                                >
                                    <defs>
                                        <marker
                                            id="arrowFlow"
                                            markerWidth="8"
                                            markerHeight="8"
                                            refX="7"
                                            refY="3"
                                            orient="auto"
                                        >
                                            <path d="M0,0 L0,6 L7,3 z" fill="#64748b" />
                                        </marker>
                                        <marker
                                            id="arrowGreenFlow"
                                            markerWidth="8"
                                            markerHeight="8"
                                            refX="7"
                                            refY="3"
                                            orient="auto"
                                        >
                                            <path d="M0,0 L0,6 L7,3 z" fill="#10b981" />
                                        </marker>
                                        <marker
                                            id="arrowRedFlow"
                                            markerWidth="8"
                                            markerHeight="8"
                                            refX="7"
                                            refY="3"
                                            orient="auto"
                                        >
                                            <path d="M0,0 L0,6 L7,3 z" fill="#dc2626" />
                                        </marker>
                                        {/* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */}
                                        <linearGradient
                                            id="flowGrad"
                                            x1="0%"
                                            y1="0%"
                                            x2="0%"
                                            y2="100%"
                                        >
                                            <stop offset="0%" stopColor="#10b981">
                                                <animate
                                                    attributeName="offset"
                                                    values="0;1;0"
                                                    dur="2s"
                                                    repeatCount="indefinite"
                                                />
                                            </stop>
                                            <stop offset="50%" stopColor="#22d3ee">
                                                <animate
                                                    attributeName="offset"
                                                    values="0.5;1.5;0.5"
                                                    dur="2s"
                                                    repeatCount="indefinite"
                                                />
                                            </stop>
                                        </linearGradient>
                                    </defs>

                                    {/* æ¥ç¶šç·š */}
                                    {/* start -> validate */}
                                    <path
                                        d="M 300 75 L 300 95"
                                        stroke="#64748b"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowFlow)"
                                    />

                                    {/* validate -> promise (ã¯ã„) */}
                                    <path
                                        d="M 300 185 L 300 215"
                                        stroke="#10b981"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowGreenFlow)"
                                    />
                                    <text
                                        x="260"
                                        y="200"
                                        fontSize="12"
                                        fill="#10b981"
                                        fontWeight="600"
                                    >
                                        ã¯ã„
                                    </text>

                                    {/* validate -> error (ã„ã„ãˆ) */}
                                    <path
                                        d="M 350 140 L 440 140"
                                        stroke="#dc2626"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowRedFlow)"
                                    />
                                    <text
                                        x="380"
                                        y="132"
                                        fontSize="12"
                                        fill="#dc2626"
                                        fontWeight="600"
                                    >
                                        ã„ã„ãˆ
                                    </text>

                                    {/* promise -> timer */}
                                    <path
                                        d="M 300 285 L 300 315"
                                        stroke="#64748b"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowFlow)"
                                    />

                                    {/* timer -> wait */}
                                    <path
                                        d="M 300 385 L 300 415"
                                        stroke="#64748b"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowFlow)"
                                    />

                                    {/* wait -> callback */}
                                    <path
                                        d="M 300 485 L 300 515"
                                        stroke="#10b981"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowGreenFlow)"
                                    />
                                    <text
                                        x="310"
                                        y="500"
                                        fontSize="11"
                                        fill="#10b981"
                                        fontWeight="500"
                                    >
                                        æ™‚é–“çµŒé
                                    </text>

                                    {/* callback -> end */}
                                    <path
                                        d="M 300 585 L 300 615"
                                        stroke="#10b981"
                                        strokeWidth="2"
                                        fill="none"
                                        markerEnd="url(#arrowGreenFlow)"
                                    />

                                    {/* error -> end (ã‚¨ãƒ©ãƒ¼çµ‚äº†) */}
                                    <path
                                        d="M 520 175 L 520 650 L 380 650"
                                        stroke="#dc2626"
                                        strokeWidth="2"
                                        strokeDasharray="5,5"
                                        fill="none"
                                        markerEnd="url(#arrowRedFlow)"
                                    />
                                    <text
                                        x="530"
                                        y="400"
                                        fontSize="11"
                                        fill="#dc2626"
                                        transform="rotate(90, 530, 400)"
                                    >
                                        ã‚¨ãƒ©ãƒ¼çµ‚äº†
                                    </text>

                                    {/* ãƒãƒ¼ãƒ‰æç”» */}
                                    {nodes.map(renderNode)}
                                </svg>
                            </div>

                            {/* èª¬æ˜ãƒ‘ãƒãƒ« */}
                            <div className="space-y-4">
                                {/* ãƒ›ãƒãƒ¼èª¬æ˜ */}
                                <div
                                    className={[
                                        'rounded-xl p-4 border-2 transition-all duration-300 min-h-[120px]',
                                        hoveredNode
                                            ? 'bg-gradient-to-br from-emerald-50 to-cyan-50 border-emerald-300 shadow-lg'
                                            : 'bg-slate-50 border-slate-200',
                                    ].join(' ')}
                                >
                                    {hoveredNode ? (
                                        <>
                                            <div className="flex items-center gap-2 mb-2">
                                                <div className="w-3 h-3 rounded-full bg-emerald-500"></div>
                                                <h4 className="font-bold text-slate-800 m-0">
                                                    {nodes.find((n) => n.id === hoveredNode)?.label}
                                                </h4>
                                            </div>
                                            <p className="text-sm text-slate-600 m-0 leading-relaxed">
                                                {nodeDescriptions[hoveredNode]}
                                            </p>
                                        </>
                                    ) : (
                                        <div className="flex items-center justify-center h-full text-slate-400 text-sm">
                                            ãƒãƒ¼ãƒ‰ã«ã‚«ãƒ¼ã‚½ãƒ«ã‚’åˆã‚ã›ã‚‹ã¨èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
                                        </div>
                                    )}
                                </div>

                                {/* å‡¡ä¾‹ */}
                                <div className="bg-white rounded-xl p-4 border border-slate-200">
                                    <h4 className="font-semibold text-slate-700 text-sm mb-3 m-0">
                                        å‡¡ä¾‹
                                    </h4>
                                    <div className="space-y-2">
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-5 rounded-full bg-emerald-100 border-2 border-emerald-500"></div>
                                            <span className="text-xs text-slate-600">
                                                é–‹å§‹/çµ‚äº†
                                            </span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div
                                                className="w-5 h-5 bg-amber-100 border-2 border-amber-500"
                                                style={{ transform: 'rotate(45deg)' }}
                                            ></div>
                                            <span className="text-xs text-slate-600 ml-1">
                                                æ¡ä»¶åˆ†å²
                                            </span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-5 rounded bg-sky-100 border-2 border-sky-500"></div>
                                            <span className="text-xs text-slate-600">å‡¦ç†</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-5 rounded bg-slate-100 border-2 border-slate-400"></div>
                                            <span className="text-xs text-slate-600">å¾…æ©ŸçŠ¶æ…‹</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-5 rounded bg-red-100 border-2 border-red-500"></div>
                                            <span className="text-xs text-slate-600">ã‚¨ãƒ©ãƒ¼</span>
                                        </div>
                                    </div>
                                </div>

                                {/* ãƒ•ãƒ­ãƒ¼æ¦‚è¦ */}
                                <div className="bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl p-4 border border-slate-200">
                                    <h4 className="font-semibold text-slate-700 text-sm mb-2 m-0">
                                        å‡¦ç†ãƒ•ãƒ­ãƒ¼æ¦‚è¦
                                    </h4>
                                    <ol className="text-xs text-slate-600 space-y-1 m-0 pl-4">
                                        <li>å…¥åŠ›å€¤ã‚’æ¤œè¨¼</li>
                                        <li>Promiseã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ</li>
                                        <li>setTimeoutã§ã‚¿ã‚¤ãƒãƒ¼ç™»éŒ²</li>
                                        <li>éãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°ã§å¾…æ©Ÿ</li>
                                        <li>æ™‚é–“çµŒéå¾Œã«resolveå®Ÿè¡Œ</li>
                                        <li>Promiseå®Œäº†ã€å‡¦ç†å†é–‹</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            const root = ReactDOM.createRoot(document.getElementById('react-root'));
            root.render(<StepsExplanation />);

            const flowchartRoot = ReactDOM.createRoot(document.getElementById('flowchart-root'));
            flowchartRoot.render(<FlowchartComponent />);
        </script>
    </body>
</html>
