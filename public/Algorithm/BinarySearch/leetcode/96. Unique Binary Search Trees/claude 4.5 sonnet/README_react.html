<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>LeetCode 96: Unique Binary Search Trees - カタラン数解説</title>
        <!-- Tailwind CSS -->
        <script src="/vendor/tailwindcss/script.js"></script>

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&family=Source+Code+Pro:wght@400;600&display=swap"
            rel="stylesheet"
        />

        <!-- Prism.js -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/line-numbers/prism-line-numbers.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/toolbar/prism-toolbar.css"
        />
        <link rel="stylesheet" href="./readme-react.css" />

        <style>
            html {
                scroll-behavior: smooth;
            }

            code[class*='language-'],
            pre[class*='language-'] {
                font-family: 'JetBrains Mono', 'Source Code Pro', monospace;
                font-size: 0.95rem;
            }

            div.code-toolbar > .toolbar {
                opacity: 1;
            }

            div.code-toolbar > .toolbar .toolbar-item > button,
            div.code-toolbar > .toolbar .toolbar-item > a {
                background: #fff;
                border: 1px solid #e6e8ef;
                border-radius: 10px;
                padding: 1rem 1.5rem;
                margin: 1rem 1rem 0 0;
                font:
                    600 13px/1.2 Inter,
                    system-ui,
                    sans-serif;
                color: #334155;
                box-shadow: 0 2px 6px rgba(20, 32, 70, 0.06);
                transition:
                    transform 0.15s,
                    box-shadow 0.15s,
                    background 0.15s;
            }

            div.code-toolbar > .toolbar .toolbar-item > button:hover {
                transform: translateY(-1px);
                box-shadow: 0 10px 28px rgba(20, 32, 70, 0.08);
                background: linear-gradient(180deg, #e8fff6, #c8f1e1);
            }
        </style>
    </head>

    <body
        class="min-h-screen p-8 sm:p-6 font-[Inter] text-slate-800 leading-relaxed bg-[linear-gradient(135deg,#f0fdf4_0%,#dbeafe_100%)]"
    >
        <div class="max-w-7xl mx-auto">
            <!-- ヘッダー -->
            <header
                id="header"
                class="mb-8 rounded-2xl p-8 shadow-[0_10px_30px_rgba(16,185,129,0.10)] bg-[linear-gradient(135deg,#d1fae5,#bfdbfe)]"
            >
                <h1 class="text-[2.5rem] font-bold text-teal-800 mb-2">
                    Unique Binary Search Trees
                </h1>
                <p class="text-xl text-cyan-700 font-semibold mt-2">
                    カタラン数の漸化式による O(n) / O(1) 実装
                </p>
                <nav class="flex flex-wrap gap-4 mt-6" aria-label="ページ内ナビゲーション">
                    <a
                        href="#overview"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                    >
                        概要
                    </a>
                    <a
                        href="#steps"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                    >
                        ステップ解説
                    </a>
                    <a
                        href="#code"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                    >
                        コード
                    </a>
                    <a
                        href="#diagram"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                    >
                        フローチャート
                    </a>
                    <a
                        href="#complexity"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                    >
                        計算量
                    </a>
                </nav>
            </header>

            <!-- 概要 -->
            <section id="overview" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    アルゴリズム概要
                </h2>

                <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">問題の説明</h3>
                <p class="mb-4">
                    整数 <code class="px-2 py-1 bg-slate-100 rounded">n</code> が与えられたとき、
                    <strong
                        >1 から n
                        までの連続整数をすべて使って構成できる「構造的に異なる二分探索木（BST）」の個数</strong
                    >を返す問題です。
                </p>

                <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">入出力例</h3>
                <div class="bg-slate-50 p-4 rounded-lg mb-4">
                    <p class="font-semibold mb-2">Example 1:</p>
                    <pre class="text-sm"><code>Input: n = 3
Output: 5</code></pre>
                    <p class="text-sm text-slate-600 mt-2">
                        解説: n=3 のとき、構造的に異なるBSTは5通り存在します。
                    </p>
                </div>

                <div class="bg-slate-50 p-4 rounded-lg mb-4">
                    <p class="font-semibold mb-2">Example 2:</p>
                    <pre class="text-sm"><code>Input: n = 1
Output: 1</code></pre>
                </div>

                <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">制約条件</h3>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li><code class="px-2 py-1 bg-slate-100 rounded">1 &lt;= n &lt;= 19</code></li>
                </ul>

                <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">戦略</h3>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li>
                        <strong>数学的背景</strong>: この問題は「n 番目のカタラン数
                        Cₙ」を求める問題に帰着される
                    </li>
                    <li>
                        <strong>漸化式の利用</strong>: C₀ = 1、Cₙ = Cₙ₋₁ × 2(2n - 1) / (n + 1)
                        を利用
                    </li>
                    <li><strong>ループ実装</strong>: 再帰やDP配列を使わず、O(1) 空間で計算</li>
                    <li>
                        <strong>整数演算</strong>: Python の整数除算 <code>//</code> で誤差なく計算
                    </li>
                </ul>

                <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">主要ポイント</h3>
                <ul class="list-disc list-inside space-y-2 ml-4">
                    <li><strong>時間計算量</strong>: O(n) - ループが n 回実行</li>
                    <li><strong>空間計算量</strong>: O(1) - 変数 c, i のみ使用</li>
                    <li><strong>最適化手法</strong>: DP配列不要、再帰不要、定数空間で計算</li>
                </ul>
            </section>

            <!-- ステップバイステップ解説 -->
            <section id="steps" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    ステップバイステップ解説
                </h2>

                <div id="step-container"></div>
            </section>

            <!-- コード例 -->
            <section id="code" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    Python実装
                </h2>
                <pre class="line-numbers"><code class="language-python">class Solution:
    """
    Unique Binary Search Trees 問題を解くクラス。

    カタラン数の漸化式を用いてO(n)/O(1)で計算。
    """

    def numTrees(self, n: int) -> int:
        """
        LeetCode用エントリポイント（競技プログラミング向け実装）。

        Args:
            n: ノード数 (1 <= n <= 19)

        Returns:
            構造的に異なるBSTの個数

        Complexity:
            Time: O(n)
            Space: O(1)
        """
        # カタラン数の漸化式: C_0 = 1
        c: int = 1

        # C_n = C_{n-1} * 2(2n - 1) / (n + 1)
        for i in range(1, n + 1):
            # 整数除算で誤差なく計算
            c = c * 2 * (2 * i - 1) // (i + 1)

        return c</code></pre>
            </section>

            <!-- フローチャート -->
            <section id="diagram" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    フローチャート
                </h2>
                <div class="mt-[20px] overflow-x-auto">
                    <svg
                        viewBox="0 0 840 650"
                        class="flowchart-svg"
                        role="img"
                        aria-label="Unique Binary Search Trees flowchart"
                    >
                        <defs>
                            <marker
                                id="arrow"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#64748b" />
                            </marker>
                            <marker
                                id="arrowGreen"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#059669" />
                            </marker>
                            <marker
                                id="arrowRed"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#dc2626" />
                            </marker>
                            <marker
                                id="arrowPurple"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#a855f7" />
                            </marker>
                        </defs>

                        <!-- 開始 -->
                        <ellipse
                            cx="420"
                            cy="50"
                            rx="100"
                            ry="35"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="50"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="18"
                            font-weight="600"
                        >
                            開始 numTrees(n)
                        </text>

                        <!-- 初期化 c = 1 -->
                        <rect
                            x="320"
                            y="110"
                            width="200"
                            height="60"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0284c7"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="132"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="600"
                        >
                            <tspan x="420" dy="-8">初期化</tspan>
                            <tspan x="420" dy="18">c = 1 (C₀の値)</tspan>
                        </text>

                        <!-- 矢印: 開始 → 初期化 -->
                        <path
                            d="M 420 85 L 420 110"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />

                        <!-- ループ開始: i = 1 to n -->
                        <rect
                            x="320"
                            y="200"
                            width="200"
                            height="60"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0284c7"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="222"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="600"
                        >
                            <tspan x="420" dy="-8">ループ開始</tspan>
                            <tspan x="420" dy="18">i = 1 から n まで</tspan>
                        </text>

                        <!-- 矢印: 初期化 → ループ開始 -->
                        <path
                            d="M 420 170 L 420 200"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />

                        <!-- 条件分岐: i <= n? -->
                        <path
                            d="M 420 290 L 520 340 L 420 390 L 320 340 Z"
                            fill="#fef3c7"
                            stroke="#f59e0b"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="340"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="600"
                        >
                            <tspan x="420" dy="-8">i &lt;= n ?</tspan>
                        </text>

                        <!-- 矢印: ループ開始 → 条件分岐 -->
                        <path
                            d="M 420 260 L 420 290"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />

                        <!-- はい → 漸化式適用 -->
                        <rect
                            x="620"
                            y="310"
                            width="180"
                            height="80"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0284c7"
                            stroke-width="2"
                        />
                        <text
                            x="710"
                            y="342"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            font-weight="600"
                        >
                            <tspan x="710" dy="-12">漸化式を適用</tspan>
                            <tspan x="710" dy="16">c = c × 2(2i - 1)</tspan>
                            <tspan x="710" dy="16">÷ (i + 1)</tspan>
                        </text>

                        <!-- 矢印: 条件分岐 → 漸化式（はい） -->
                        <path
                            d="M 520 340 L 620 340"
                            stroke="#059669"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowGreen)"
                        />
                        <text
                            x="570"
                            y="328"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            font-weight="600"
                            fill="#059669"
                        >
                            はい
                        </text>

                        <!-- i をインクリメント -->
                        <rect
                            x="640"
                            y="430"
                            width="140"
                            height="50"
                            rx="8"
                            fill="#f1f5f9"
                            stroke="#64748b"
                            stroke-width="2"
                        />
                        <text
                            x="710"
                            y="455"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            font-weight="600"
                        >
                            i = i + 1
                        </text>

                        <!-- 矢印: 漸化式 → インクリメント -->
                        <path
                            d="M 710 390 L 710 430"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />

                        <!-- ループバック -->
                        <path
                            d="M 710 480 L 710 550 L 180 550 L 180 230 L 320 230"
                            stroke="#a855f7"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowPurple)"
                        />
                        <text
                            x="220"
                            y="375"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            font-weight="600"
                            fill="#a855f7"
                        >
                            次の i へ
                        </text>

                        <!-- いいえ → 終了 -->
                        <ellipse
                            cx="420"
                            cy="500"
                            rx="100"
                            ry="35"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="492"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="600"
                        >
                            <tspan x="420" dy="-8">終了</tspan>
                            <tspan x="420" dy="18">return c</tspan>
                        </text>

                        <!-- 矢印: 条件分岐 → 終了（いいえ） -->
                        <path
                            d="M 420 390 L 420 465"
                            stroke="#dc2626"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowRed)"
                        />
                        <text
                            x="380"
                            y="428"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            font-weight="600"
                            fill="#dc2626"
                        >
                            いいえ
                        </text>
                    </svg>
                </div>

                <p class="mt-8 font-[Source_Code_Pro] text-[20px] font-semibold">
                    <strong class="text-2xl">フローの説明：</strong><br />
                    1. <strong>初期化</strong>: c = 1 で開始（C₀の値）<br />
                    2. <strong>ループ開始</strong>: i = 1 から n まで反復<br />
                    3. <strong>条件分岐</strong>: i &lt;= n
                    であれば処理を続行、そうでなければ終了<br />
                    4. <strong>漸化式適用</strong>: c = c × 2(2i - 1) ÷ (i + 1) を計算<br />
                    5. <strong>インクリメント</strong>: i を1増やす<br />
                    6. <strong>ループバック</strong>: 条件分岐に戻る（紫の矢印）<br />
                    7. <strong>終了</strong>: ループ完了後、c を返す
                </p>
            </section>

            <!-- 計算量 -->
            <section id="complexity" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    計算量分析
                </h2>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-emerald-50">
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    項目
                                </th>
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    計算量
                                </th>
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    備考
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="border border-slate-300 px-4 py-3">時間</td>
                                <td
                                    class="border border-slate-300 px-4 py-3 font-mono font-semibold text-emerald-700"
                                >
                                    O(n)
                                </td>
                                <td class="border border-slate-300 px-4 py-3">
                                    ループが n 回実行され、各ステップは定数時間
                                </td>
                            </tr>
                            <tr class="bg-slate-50">
                                <td class="border border-slate-300 px-4 py-3">空間</td>
                                <td
                                    class="border border-slate-300 px-4 py-3 font-mono font-semibold text-emerald-700"
                                >
                                    O(1)
                                </td>
                                <td class="border border-slate-300 px-4 py-3">
                                    変数 c, i のみ使用（配列不要）
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="text-xl font-semibold text-teal-800 mt-8 mb-4">他手法との比較</h3>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-cyan-50">
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    アプローチ
                                </th>
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    時間
                                </th>
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    空間
                                </th>
                                <th
                                    class="border border-slate-300 px-4 py-3 text-left font-semibold"
                                >
                                    備考
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-emerald-50">
                                <td class="border border-slate-300 px-4 py-3 font-semibold">
                                    漸化式（本実装）
                                </td>
                                <td
                                    class="border border-slate-300 px-4 py-3 font-mono text-emerald-700"
                                >
                                    O(n)
                                </td>
                                <td
                                    class="border border-slate-300 px-4 py-3 font-mono text-emerald-700"
                                >
                                    O(1)
                                </td>
                                <td class="border border-slate-300 px-4 py-3">
                                    最もシンプルで高速
                                </td>
                            </tr>
                            <tr>
                                <td class="border border-slate-300 px-4 py-3">DP配列</td>
                                <td class="border border-slate-300 px-4 py-3 font-mono">O(n²)</td>
                                <td class="border border-slate-300 px-4 py-3 font-mono">O(n)</td>
                                <td class="border border-slate-300 px-4 py-3">
                                    定義に忠実だが遅い
                                </td>
                            </tr>
                            <tr class="bg-slate-50">
                                <td class="border border-slate-300 px-4 py-3">再帰+メモ化</td>
                                <td class="border border-slate-300 px-4 py-3 font-mono">O(n²)</td>
                                <td class="border border-slate-300 px-4 py-3 font-mono">O(n)</td>
                                <td class="border border-slate-300 px-4 py-3">
                                    関数呼び出しオーバーヘッド
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- React & ReactDOM -->
        <script crossorigin src="/vendor/react/react.production.min.js"></script>
        <script
            crossorigin
            src="/vendor/react-dom/react-dom.production.min.js"
        ></script>

        <!-- Prism.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

        <!-- Step-by-step React demo -->
        <script defer src="./StepByStepDemo.js"></script>
    </body>
</html>
