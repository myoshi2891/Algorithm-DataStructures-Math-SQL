<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Unique BSTs II - åˆ†å‰²çµ±æ²»ï¼‹åŒºé–“ãƒ¡ãƒ¢åŒ–</title>

        <!-- React + ReactDOM + Babel -->
        <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script
            crossorigin
            src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
        ></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>

        <!-- Prism.js -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
        />

        <!-- Google Fonts -->
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap"
            rel="stylesheet"
        />

        <style>
            :root {
                --code-lh: 1.6;
                --primary: #10b981;
                --primary-light: #d1fae5;
                --secondary: #0ea5e9;
                --secondary-light: #e0f2fe;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family:
                    'Inter',
                    system-ui,
                    -apple-system,
                    sans-serif;
                line-height: 1.6;
                color: #1e293b;
            }

            /* Code Styles */
            pre[class*='language-'],
            pre[class*='language-'] > code {
                line-height: var(--code-lh) !important;
                white-space: pre !important;
                word-break: normal !important;
                overflow-wrap: normal !important;
                font-family:
                    'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                    monospace;
                font-size: 14px;
            }

            pre.line-numbers {
                padding-left: 3.2em !important;
                border-radius: 12px;
                background: #1e293b !important;
            }

            .line-numbers .line-numbers-rows {
                width: 3.2em;
                border-right: 1px solid #475569;
            }

            .line-numbers .line-numbers-rows > span {
                height: calc(var(--code-lh) * 1em);
            }

            /* Prism Toolbar */
            div.code-toolbar > .toolbar {
                opacity: 1;
            }

            div.code-toolbar > .toolbar .toolbar-item > button,
            div.code-toolbar > .toolbar .toolbar-item > a {
                background: #fff;
                border: 1px solid #e2e8f0;
                border-radius: 8px;
                padding: 6px 12px;
                font:
                    600 13px/1.2 Inter,
                    system-ui,
                    sans-serif;
                color: #334155;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                transition: all 0.2s;
            }

            div.code-toolbar > .toolbar .toolbar-item > button:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
                background: linear-gradient(180deg, #f0fdf4, #dcfce7);
            }

            /* Smooth Scroll */
            html {
                scroll-behavior: smooth;
            }

            /* Navigation Active State */
            .nav-link {
                transition: all 0.2s;
            }

            .nav-link:hover {
                color: var(--primary);
                transform: translateY(-1px);
            }

            /* Card Hover Effects */
            .card-hover {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .card-hover:hover {
                transform: translateY(-4px);
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            }

            /* Step Button Styles */
            .step-btn {
                transition: all 0.2s;
                position: relative;
            }

            .step-btn.active {
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            }

            .step-btn.active::before {
                content: '';
                position: absolute;
                inset: -2px;
                border-radius: inherit;
                background: linear-gradient(135deg, #10b981, #059669);
                z-index: -1;
                opacity: 0.3;
                filter: blur(8px);
            }

            /* Control Button Styles */
            .control-btn {
                transition: all 0.2s;
            }

            .control-btn:not(:disabled):hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 16px rgba(16, 185, 129, 0.2);
            }

            .control-btn:disabled {
                opacity: 0.4;
                cursor: not-allowed;
            }

            /* SVG Animation */
            .svg-fade-in {
                animation: fadeIn 0.4s ease-in-out;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            /* Responsive */
            @media (max-width: 768px) {
                .two-col-layout {
                    grid-template-columns: 1fr;
                }
            }
        </style>
    </head>
    <body class="bg-gradient-to-br from-emerald-50 via-white to-sky-50">
        <!-- Header -->
        <header class="bg-white shadow-sm sticky top-0 z-50 border-b border-gray-100">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <h1
                    class="text-3xl sm:text-4xl font-bold bg-gradient-to-r from-emerald-600 to-sky-600 bg-clip-text text-transparent mb-2"
                >
                    Unique Binary Search Trees II
                </h1>
                <p class="text-gray-600 text-sm sm:text-base">
                    å…¨BSTåˆ—æŒ™ - åˆ†å‰²çµ±æ²»ï¼‹åŒºé–“ãƒ¡ãƒ¢åŒ–ã§ã‚«ã‚¿ãƒ©ãƒ³æ•°ã‚’åŠ¹ç‡çš„ã«ç”Ÿæˆ
                </p>
            </div>

            <!-- Navigation -->
            <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-4">
                <div class="flex flex-wrap gap-3 sm:gap-4 text-sm sm:text-base">
                    <a
                        href="#overview"
                        class="nav-link font-semibold text-gray-700 hover:text-emerald-600"
                        >æ¦‚è¦</a
                    >
                    <span class="text-gray-300">â€¢</span>
                    <a
                        href="#steps"
                        class="nav-link font-semibold text-gray-700 hover:text-emerald-600"
                        >ã‚¹ãƒ†ãƒƒãƒ—</a
                    >
                    <span class="text-gray-300">â€¢</span>
                    <a
                        href="#code"
                        class="nav-link font-semibold text-gray-700 hover:text-emerald-600"
                        >ã‚³ãƒ¼ãƒ‰</a
                    >
                    <span class="text-gray-300">â€¢</span>
                    <a
                        href="#diagram"
                        class="nav-link font-semibold text-gray-700 hover:text-emerald-600"
                        >å›³è§£</a
                    >
                    <span class="text-gray-300">â€¢</span>
                    <a
                        href="#complexity"
                        class="nav-link font-semibold text-gray-700 hover:text-emerald-600"
                        >è¨ˆç®—é‡</a
                    >
                </div>
            </nav>
        </header>

        <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-12">
            <!-- Overview Section -->
            <section id="overview" class="bg-white rounded-xl shadow-md p-6 sm:p-8 card-hover">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span
                        class="w-2 h-8 bg-gradient-to-b from-emerald-500 to-emerald-600 rounded"
                    ></span>
                    æ¦‚è¦
                </h2>
                <div class="prose prose-slate max-w-none">
                    <p class="text-gray-700 leading-relaxed mb-4">
                        æ•´æ•°
                        <code class="px-2 py-1 bg-gray-100 rounded text-sm">n</code>
                        ã«å¯¾ã—ã€å€¤
                        <code class="px-2 py-1 bg-gray-100 rounded text-sm">1..n</code>
                        ã‚’æŒã¤ãƒãƒ¼ãƒ‰ã§æ§‹æˆã•ã‚Œã‚‹<strong>æ§‹é€ çš„ã«ä¸€æ„ãª BSTï¼ˆäºŒåˆ†æ¢ç´¢æœ¨ï¼‰</strong
                        >ã‚’ã™ã¹ã¦ç”Ÿæˆã—ã¾ã™ã€‚
                    </p>
                    <ul class="space-y-2 text-gray-700">
                        <li>å„æœ¨ã¯ BST ã®æ€§è³ªã‚’æº€ãŸã™ï¼ˆå·¦éƒ¨åˆ†æœ¨ &lt; æ ¹ &lt; å³éƒ¨åˆ†æœ¨ï¼‰</li>
                        <li>åŒå‹ã§ãªã„æœ¨ã¯ã™ã¹ã¦åˆ—æŒ™ã™ã‚‹ï¼ˆé †åºã¯ä»»æ„ï¼‰</li>
                        <li>
                            <code class="px-2 py-1 bg-gray-100 rounded text-sm">1 â‰¤ n â‰¤ 8</code>
                            ã®åˆ¶ç´„
                        </li>
                        <li>
                            <code class="px-2 py-1 bg-gray-100 rounded text-sm">n=8</code>
                            ã§ã‚‚ç”Ÿæˆæœ¬æ•°ã¯<strong>ã‚«ã‚¿ãƒ©ãƒ³æ•° Câ‚ˆ = 1430</strong>ã¨å°è¦æ¨¡
                        </li>
                    </ul>

                    <div class="mt-6 p-4 bg-emerald-50 border-l-4 border-emerald-500 rounded">
                        <p class="font-semibold text-emerald-800 mb-2">ğŸ¯ æˆ¦ç•¥</p>
                        <p class="text-gray-700">
                            <strong>åˆ†å‰²çµ±æ²»</strong>ï¼ˆæ ¹ã‚’å…¨åˆ—æŒ™ â†’
                            å·¦å³éƒ¨åˆ†æœ¨ã®ç›´ç©ã§åˆæˆï¼‰ï¼‹<strong>åŒºé–“ãƒ¡ãƒ¢åŒ–</strong>ã«ã‚ˆã‚Šã€é‡è¤‡è¨ˆç®—ã‚’æ’é™¤ã—ã¦å‡ºåŠ›ã‚µã‚¤ã‚ºã«è¿‘ã„è¨ˆç®—é‡ã‚’å®Ÿç¾ã—ã¾ã™ã€‚
                        </p>
                    </div>
                </div>
            </section>

            <!-- Interactive Steps Section -->
            <section id="steps" class="bg-white rounded-xl shadow-md p-6 sm:p-8 card-hover">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="w-2 h-8 bg-gradient-to-b from-sky-500 to-sky-600 rounded"></span>
                    ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬
                </h2>
                <div id="interactive-demo"></div>
            </section>

            <!-- Code Section -->
            <section id="code" class="bg-white rounded-xl shadow-md p-6 sm:p-8 card-hover">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span
                        class="w-2 h-8 bg-gradient-to-b from-emerald-500 to-emerald-600 rounded"
                    ></span>
                    Pythonå®Ÿè£…ï¼ˆLeetCodeå½¢å¼ï¼‰
                </h2>
                <div class="code-toolbar">
                    <pre
                        class="line-numbers"
                    ><code class="language-python">from __future__ import annotations

from typing import Dict, List, Optional, Tuple, TYPE_CHECKING

if TYPE_CHECKING:
    class TreeNode:
        val: int
        left: Optional[TreeNode]
        right: Optional[TreeNode]
        def __init__(self, val: int = 0,
                     left: Optional[TreeNode] = None,
                     right: Optional[TreeNode] = None) -> None: ...
else:
    try:
        TreeNode  # type: ignore
    except NameError:
        class TreeNode:
            """Binary Tree Node with __slots__ for memory efficiency."""
            __slots__ = ("val", "left", "right")

            def __init__(self, val: int = 0,
                         left: Optional[TreeNode] = None,
                         right: Optional[TreeNode] = None) -> None:
                self.val = val
                self.left = left
                self.right = right


class Solution:
    """
    Unique Binary Search Trees II
    1..n ã®å€¤ã§æ§‹é€ çš„ã«ä¸€æ„ãª BST ã‚’ã™ã¹ã¦ç”Ÿæˆã€‚

    Time:  â‰ˆ O(C_n * n)  where C_n is n-th Catalan number
    Space: â‰ˆ O(C_n * n)  (output + interval memoization)
    """

    def generateTrees(self, n: int) -> List[Optional[TreeNode]]:
        """
        Args:
            n: 1 <= n <= 8

        Returns:
            List of root nodes (each representing one unique BST)
        """
        if n == 0:
            return []

        # åŒºé–“ [l, r] -> ç”Ÿæˆå¯èƒ½ãªæ ¹ãƒãƒ¼ãƒ‰é…åˆ—
        memo: Dict[Tuple[int, int], List[Optional[TreeNode]]] = {}

        def build(l: int, r: int) -> List[Optional[TreeNode]]:
            """
            åŒºé–“ [l, r] å†…ã®å€¤ã§æ§‹ç¯‰å¯èƒ½ãª BST ã‚’ã™ã¹ã¦ç”Ÿæˆã€‚
            ç©ºåŒºé–“ã¯ [None]ï¼ˆç©ºæœ¨1é€šã‚Šï¼‰ã§è¡¨ã™ã€‚
            """
            # åŸºåº•: ç©ºåŒºé–“ â†’ ç©ºæœ¨
            if l > r:
                return [None]

            # ãƒ¡ãƒ¢åŒ–ãƒã‚§ãƒƒã‚¯
            key = (l, r)
            if key in memo:
                return memo[key]

            result: List[Optional[TreeNode]] = []

            # å„å€¤ã‚’æ ¹å€™è£œã¨ã—ã¦åˆ—æŒ™
            for root_val in range(l, r + 1):
                # å·¦éƒ¨åˆ†æœ¨: [l, root_val - 1]
                left_trees = build(l, root_val - 1)
                # å³éƒ¨åˆ†æœ¨: [root_val + 1, r]
                right_trees = build(root_val + 1, r)

                # ç›´ç©ã§å…¨çµ„åˆã›ã‚’åˆæˆ
                for lt in left_trees:
                    for rt in right_trees:
                        # æ–°è¦ãƒãƒ¼ãƒ‰ä½œæˆï¼ˆéƒ¨åˆ†æœ¨ã¯å‚ç…§å…±æœ‰ï¼‰
                        node = TreeNode(root_val, lt, rt)
                        result.append(node)

            # ãƒ¡ãƒ¢ã«ä¿å­˜ã—ã¦è¿”å´
            memo[key] = result
            return result

        return build(1, n)</code></pre>
                </div>
            </section>

            <!-- Diagram Section -->
            <section id="diagram" class="bg-white rounded-xl shadow-md p-6 sm:p-8 card-hover">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span class="w-2 h-8 bg-gradient-to-b from-sky-500 to-sky-600 rounded"></span>
                    è¦–è¦šçš„å›³è§£
                </h2>

                <div class="bg-gray-50 rounded-lg p-6 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">åˆ†å‰²çµ±æ²»ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</h3>
                    <svg
                        viewBox="0 0 800 600"
                        class="w-full h-auto"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <!-- Start -->
                        <rect
                            x="310"
                            y="20"
                            width="180"
                            height="50"
                            rx="8"
                            fill="#10b981"
                            stroke="#059669"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="50"
                            text-anchor="middle"
                            fill="white"
                            font-size="15"
                            font-weight="600"
                        >
                            é–‹å§‹ build(l, r)
                        </text>

                        <!-- Arrow -->
                        <path
                            d="M 400 70 L 400 100"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />

                        <!-- Empty Check -->
                        <path
                            d="M 400 100 L 480 140 L 400 180 L 320 140 Z"
                            fill="#e0f2fe"
                            stroke="#0ea5e9"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="145"
                            text-anchor="middle"
                            fill="#0369a1"
                            font-size="14"
                            font-weight="600"
                        >
                            l &gt; r?
                        </text>

                        <!-- Yes Branch -->
                        <path
                            d="M 480 140 L 580 140"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <text x="520" y="130" fill="#059669" font-size="12" font-weight="600">
                            ã¯ã„
                        </text>
                        <rect
                            x="580"
                            y="115"
                            width="140"
                            height="50"
                            rx="8"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="2"
                        />
                        <text
                            x="650"
                            y="145"
                            text-anchor="middle"
                            fill="#059669"
                            font-size="13"
                            font-weight="600"
                        >
                            [None]ã‚’è¿”ã™
                        </text>

                        <!-- No Branch -->
                        <path
                            d="M 400 180 L 400 220"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <text x="420" y="205" fill="#0369a1" font-size="12" font-weight="600">
                            ã„ã„ãˆ
                        </text>

                        <!-- Memo Check -->
                        <path
                            d="M 400 220 L 490 260 L 400 300 L 310 260 Z"
                            fill="#fef3c7"
                            stroke="#f59e0b"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="265"
                            text-anchor="middle"
                            fill="#b45309"
                            font-size="13"
                            font-weight="600"
                        >
                            ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¸ˆ?
                        </text>

                        <!-- Cached Yes -->
                        <path
                            d="M 490 260 L 570 260"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <text x="520" y="250" fill="#059669" font-size="12" font-weight="600">
                            ã¯ã„
                        </text>
                        <rect
                            x="570"
                            y="235"
                            width="150"
                            height="50"
                            rx="8"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="2"
                        />
                        <text
                            x="645"
                            y="265"
                            text-anchor="middle"
                            fill="#059669"
                            font-size="13"
                            font-weight="600"
                        >
                            ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è¿”ã™
                        </text>

                        <!-- Cached No -->
                        <path
                            d="M 400 300 L 400 340"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <text x="420" y="325" fill="#b45309" font-size="12" font-weight="600">
                            ã„ã„ãˆ
                        </text>

                        <!-- Loop -->
                        <rect
                            x="280"
                            y="340"
                            width="240"
                            height="50"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0ea5e9"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="370"
                            text-anchor="middle"
                            fill="#0369a1"
                            font-size="13"
                            font-weight="600"
                        >
                            å„root_val âˆˆ [l, r]
                            <!-- âˆˆ: ã€Œã€œã«å±ã™ã‚‹ã€ã‚’æ„å‘³ã™ã‚‹æ•°å­¦è¨˜å·ã§ã™ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ã‚ˆã£ã¦ã¯ã€inã‚„foreachãªã©ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§è¡¨ç¾ã•ã‚Œã¾ã™ã€‚ -->
                        </text>

                        <!-- Recurse -->
                        <path
                            d="M 400 390 L 400 420"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <rect
                            x="270"
                            y="420"
                            width="260"
                            height="50"
                            rx="8"
                            fill="#fae8ff"
                            stroke="#a855f7"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="450"
                            text-anchor="middle"
                            fill="#7e22ce"
                            font-size="13"
                            font-weight="600"
                        >
                            å·¦å³ã‚’å†å¸°å‡¦ç†
                        </text>

                        <!-- Combine -->
                        <path
                            d="M 400 470 L 400 500"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                        />
                        <rect
                            x="290"
                            y="500"
                            width="220"
                            height="50"
                            rx="8"
                            fill="#ddd6fe"
                            stroke="#8b5cf6"
                            stroke-width="2"
                        />
                        <text
                            x="400"
                            y="530"
                            text-anchor="middle"
                            fill="#6d28d9"
                            font-size="13"
                            font-weight="600"
                        >
                            ç›´ç©ã§åˆæˆ
                        </text>

                        <!-- Store -->
                        <path
                            d="M 290 525 L 180 525 L 180 260 L 310 260"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowhead)"
                            stroke-dasharray="5,5"
                        />
                        <text x="200" y="380" fill="#64748b" font-size="11" font-weight="600">
                            ãƒ¡ãƒ¢ã«ä¿å­˜
                        </text>

                        <!-- Arrow Definition -->
                        <defs>
                            <marker
                                id="arrowhead"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                            >
                                <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </section>

            <!-- Complexity Section -->
            <section id="complexity" class="bg-white rounded-xl shadow-md p-6 sm:p-8 card-hover">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <span
                        class="w-2 h-8 bg-gradient-to-b from-emerald-500 to-emerald-600 rounded"
                    ></span>
                    è¨ˆç®—é‡
                </h2>

                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-emerald-50 rounded-lg p-6 border-l-4 border-emerald-500">
                        <h3 class="text-lg font-semibold text-emerald-800 mb-3">â±ï¸ æ™‚é–“è¨ˆç®—é‡</h3>
                        <p class="text-3xl font-bold text-emerald-600 mb-2">O(Câ‚™ Â· n)</p>
                        <p class="text-sm text-gray-700">
                            Câ‚™ ã¯ã‚«ã‚¿ãƒ©ãƒ³æ•°ï¼ˆç¬¬né …ï¼‰ã€‚å„æœ¨ã®æ§‹ç¯‰ã« O(n)
                            ã®æ“ä½œãŒå¿…è¦ã§ã™ã€‚ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚Šé‡è¤‡è¨ˆç®—ã‚’å®Œå…¨ã«æ’é™¤ã—ã€å‡ºåŠ›ã‚µã‚¤ã‚ºã«è¿‘ã„ä¸‹é™ã«åˆ°é”ã—ã¾ã™ã€‚
                        </p>
                    </div>

                    <div class="bg-sky-50 rounded-lg p-6 border-l-4 border-sky-500">
                        <h3 class="text-lg font-semibold text-sky-800 mb-3">ğŸ’¾ ç©ºé–“è¨ˆç®—é‡</h3>
                        <p class="text-3xl font-bold text-sky-600 mb-2">O(Câ‚™ Â· n)</p>
                        <p class="text-sm text-gray-700">
                            å‡ºåŠ›ï¼ˆå…¨æœ¨ï¼‰ãŒæ”¯é…çš„ã€‚ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å´ã¯åŒºé–“ãƒ¡ãƒ¢ O(nÂ²)
                            å€‹ã®åŒºé–“ã«å¯¾ã—ã€å„åŒºé–“ãŒæœ€å¤§ O(Câ‚™) æœ¬ã®æœ¨ã‚’ä¿æŒã—ã¾ã™ã€‚
                        </p>
                    </div>
                </div>

                <div class="mt-6 overflow-x-auto">
                    <table class="w-full text-sm border-collapse">
                        <thead>
                            <tr class="bg-gray-100 border-b-2 border-gray-300">
                                <th class="px-4 py-3 text-left font-semibold text-gray-700">n</th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700">
                                    ã‚«ã‚¿ãƒ©ãƒ³æ•° Câ‚™
                                </th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700">
                                    ç”Ÿæˆæœ¬æ•°
                                </th>
                                <th class="px-4 py-3 text-left font-semibold text-gray-700">
                                    å®Ÿè¡Œæ™‚é–“
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3">1</td>
                                <td class="px-4 py-3">1</td>
                                <td class="px-4 py-3">1æœ¬</td>
                                <td class="px-4 py-3 text-green-600">å³æ™‚</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3">2</td>
                                <td class="px-4 py-3">2</td>
                                <td class="px-4 py-3">2æœ¬</td>
                                <td class="px-4 py-3 text-green-600">å³æ™‚</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3">3</td>
                                <td class="px-4 py-3">5</td>
                                <td class="px-4 py-3">5æœ¬</td>
                                <td class="px-4 py-3 text-green-600">å³æ™‚</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3">8</td>
                                <td class="px-4 py-3">1430</td>
                                <td class="px-4 py-3">1430æœ¬</td>
                                <td class="px-4 py-3 text-yellow-600">&lt;100ms</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>

        <footer class="bg-gray-50 border-t border-gray-200 mt-16 py-8">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-600 text-sm">
                <p>LeetCode 95 - Unique Binary Search Trees II</p>
                <p class="mt-2">åˆ†å‰²çµ±æ²» + åŒºé–“ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªBSTå…¨åˆ—æŒ™</p>
            </div>
        </footer>

        <!-- Prism.js Scripts -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

        <!-- React Component -->
        <script type="text/babel">
            const { useState, useEffect, useRef } = React;

            const STEP_AUTO_ADVANCE_DELAY = 2000;
            const INITIAL_STEP = 1;

            const stepsData = [
                {
                    step: 1,
                    title: 'åˆæœŸåŒ–',
                    desc: 'n=3 ã§ build(1, 3) ã‚’å‘¼ã³å‡ºã—ã€‚ãƒ¡ãƒ¢è¾æ›¸ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚',
                    visual: {
                        type: 'init',
                        range: '[1, 3]',
                        memo: '{}',
                        state: 'start',
                    },
                },
                {
                    step: 2,
                    title: 'æ ¹å€™è£œ 1 ã‚’é¸æŠ',
                    desc: 'root_val = 1ã€‚å·¦ [1, 0]ï¼ˆç©ºï¼‰ã€å³ [2, 3] ã«åˆ†å‰²ã—ã¾ã™ã€‚',
                    visual: {
                        type: 'root_select',
                        root: 1,
                        left: '[1, 0]',
                        right: '[2, 3]',
                        leftEmpty: true,
                    },
                },
                {
                    step: 3,
                    title: 'å³éƒ¨åˆ†æœ¨ [2, 3] ã‚’å†å¸°',
                    desc: 'build(2, 3) ã‚’å‘¼ã³å‡ºã—ã€‚æ ¹å€™è£œ 2 ã¨ 3 ã‚’åˆ—æŒ™ã—ã¾ã™ã€‚',
                    visual: {
                        type: 'recurse',
                        range: '[2, 3]',
                        roots: [2, 3],
                        trees: 2,
                    },
                },
                {
                    step: 4,
                    title: 'æ ¹å€™è£œ 2 ã‚’é¸æŠ',
                    desc: 'root_val = 2ã€‚å·¦ [1, 1]ã€å³ [3, 3] ã«åˆ†å‰²ï¼ˆä¸­è¦æ¨¡ã®ä¾‹ï¼‰ã€‚',
                    visual: {
                        type: 'root_select',
                        root: 2,
                        left: '[1, 1]',
                        right: '[3, 3]',
                        leftEmpty: false,
                    },
                },
                {
                    step: 5,
                    title: 'ç›´ç©åˆæˆ',
                    desc: 'å·¦å³ã®å…¨çµ„åˆã›ï¼ˆleft_trees Ã— right_treesï¼‰ã§æ–°ã—ã„æœ¨ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚',
                    visual: {
                        type: 'combine',
                        leftCount: 2,
                        rightCount: 2,
                        resultCount: 4,
                    },
                },
                {
                    step: 6,
                    title: 'ãƒ¡ãƒ¢åŒ–ä¿å­˜',
                    desc: 'åŒºé–“ [l, r] ã®çµæœã‚’ãƒ¡ãƒ¢ã«ä¿å­˜ã€‚åŒä¸€åŒºé–“ã®å†è¨ˆç®—ã‚’å›é¿ã—ã¾ã™ã€‚',
                    visual: {
                        type: 'memoize',
                        key: '(1, 3)',
                        trees: 5,
                    },
                },
                {
                    step: 7,
                    title: 'å…¨æœ¨ç”Ÿæˆå®Œäº†',
                    desc: 'n=3 ã®å ´åˆã€5æœ¬ã®æ§‹é€ çš„ã«ä¸€æ„ãª BST ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚',
                    visual: {
                        type: 'result',
                        totalTrees: 5,
                        catalanNumber: 'Câ‚ƒ = 5',
                    },
                },
            ];

            function StepVisualization({ stepInfo }) {
                const { visual } = stepInfo;

                if (visual.type === 'init') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            {/* Background */}
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            {/* Title */}
                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                åˆæœŸçŠ¶æ…‹
                            </text>

                            {/* Range Box */}
                            <rect
                                x="100"
                                y="80"
                                width="200"
                                height="60"
                                rx="8"
                                fill="#e0f2fe"
                                stroke="#0ea5e9"
                                strokeWidth="2"
                            />
                            <text
                                x="200"
                                y="110"
                                textAnchor="middle"
                                fill="#0369a1"
                                fontSize="16"
                                fontWeight="600"
                            >
                                ç¯„å›²: {visual.range}
                            </text>
                            <text x="200" y="130" textAnchor="middle" fill="#64748b" fontSize="14">
                                build(1, 3) ã‚’å‘¼ã³å‡ºã—
                            </text>

                            {/* Memo Box */}
                            <rect
                                x="100"
                                y="170"
                                width="200"
                                height="60"
                                rx="8"
                                fill="#fef3c7"
                                stroke="#f59e0b"
                                strokeWidth="2"
                            />
                            <text
                                x="200"
                                y="200"
                                textAnchor="middle"
                                fill="#b45309"
                                fontSize="16"
                                fontWeight="600"
                            >
                                ãƒ¡ãƒ¢: {visual.memo}
                            </text>
                            <text x="200" y="220" textAnchor="middle" fill="#64748b" fontSize="14">
                                ç©ºã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
                            </text>

                            {/* Arrow */}
                            <path
                                d="M 200 140 L 200 170"
                                stroke="#64748b"
                                strokeWidth="2"
                                fill="none"
                                markerEnd="url(#arrow)"
                            />

                            <defs>
                                <marker
                                    id="arrow"
                                    markerWidth="10"
                                    markerHeight="10"
                                    refX="9"
                                    refY="3"
                                    orient="auto"
                                >
                                    <polygon points="0 0, 10 3, 0 6" fill="#64748b" />
                                </marker>
                            </defs>
                        </svg>
                    );
                }

                if (visual.type === 'root_select') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                æ ¹ã‚’é¸æŠ
                            </text>

                            {/* Root Node */}
                            <circle
                                cx="200"
                                cy="100"
                                r="25"
                                fill="#10b981"
                                stroke="#059669"
                                strokeWidth="2"
                            />
                            <text
                                x="200"
                                y="108"
                                textAnchor="middle"
                                fill="white"
                                fontSize="18"
                                fontWeight="700"
                            >
                                {visual.root}
                            </text>

                            {/* Left Branch */}
                            <line
                                x1="200"
                                y1="125"
                                x2="120"
                                y2="180"
                                stroke="#64748b"
                                strokeWidth="2"
                            />
                            <rect
                                x="80"
                                y="180"
                                width="80"
                                height="60"
                                rx="6"
                                fill={visual.leftEmpty ? '#fee2e2' : '#ddd6fe'}
                                stroke={visual.leftEmpty ? '#ef4444' : '#8b5cf6'}
                                strokeWidth="2"
                            />
                            <text
                                x="120"
                                y="200"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="12"
                                fontWeight="600"
                            >
                                å·¦éƒ¨åˆ†æœ¨
                            </text>
                            <text x="120" y="218" textAnchor="middle" fill="#64748b" fontSize="11">
                                {visual.left}
                            </text>
                            {visual.leftEmpty && (
                                <text
                                    x="120"
                                    y="232"
                                    textAnchor="middle"
                                    fill="#dc2626"
                                    fontSize="10"
                                    fontWeight="600"
                                >
                                    ç©º
                                </text>
                            )}

                            {/* Right Branch */}
                            <line
                                x1="200"
                                y1="125"
                                x2="280"
                                y2="180"
                                stroke="#64748b"
                                strokeWidth="2"
                            />
                            <rect
                                x="240"
                                y="180"
                                width="80"
                                height="60"
                                rx="6"
                                fill="#ddd6fe"
                                stroke="#8b5cf6"
                                strokeWidth="2"
                            />
                            <text
                                x="280"
                                y="200"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="12"
                                fontWeight="600"
                            >
                                å³éƒ¨åˆ†æœ¨
                            </text>
                            <text x="280" y="218" textAnchor="middle" fill="#64748b" fontSize="11">
                                {visual.right}
                            </text>
                        </svg>
                    );
                }

                if (visual.type === 'recurse') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                éƒ¨åˆ†æœ¨ã‚’å†å¸°
                            </text>

                            <rect
                                x="100"
                                y="70"
                                width="200"
                                height="50"
                                rx="8"
                                fill="#e0f2fe"
                                stroke="#0ea5e9"
                                strokeWidth="2"
                            />
                            <text
                                x="200"
                                y="95"
                                textAnchor="middle"
                                fill="#0369a1"
                                fontSize="16"
                                fontWeight="600"
                            >
                                ç¯„å›²: {visual.range}
                            </text>
                            <text x="200" y="112" textAnchor="middle" fill="#64748b" fontSize="13">
                                æ ¹ã‚’åˆ—æŒ™
                            </text>

                            {/* Root candidates */}
                            {visual.roots.map((root, idx) => (
                                <g key={idx}>
                                    <circle
                                        cx={150 + idx * 100}
                                        cy={180}
                                        r="22"
                                        fill="#a855f7"
                                        stroke="#7e22ce"
                                        strokeWidth="2"
                                    />
                                    <text
                                        x={150 + idx * 100}
                                        y={188}
                                        textAnchor="middle"
                                        fill="white"
                                        fontSize="16"
                                        fontWeight="700"
                                    >
                                        {root}
                                    </text>
                                </g>
                            ))}

                            <text
                                x="200"
                                y="240"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="14"
                                fontWeight="600"
                            >
                                {visual.trees}æœ¬ã®æœ¨ã‚’ç”Ÿæˆ
                            </text>
                        </svg>
                    );
                }

                if (visual.type === 'combine') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                ç›´ç©åˆæˆ
                                {/* ã€Œç›´ç©åˆæˆã€ã¯ã€ä¸€èˆ¬ã«ã€Œç›´ç©é›†åˆï¼ˆãƒ‡ã‚«ãƒ«ãƒˆç©ï¼‰ã€ã‚„ã€Œç›´ç©çµåˆï¼ˆã‚¯ãƒ­ã‚¹ã‚¸ãƒ§ã‚¤ãƒ³ï¼‰ã€ã‚’æŒ‡ã—ã€è¤‡æ•°ã®é›†åˆã‚„ãƒ†ãƒ¼ãƒ–ãƒ«ã€ã¾ãŸã¯è¦ç´ ã®ã‚ã‚‰ã‚†ã‚‹çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆã™ã‚‹æ¦‚å¿µ */}
                            </text>

                            {/* Left Trees */}
                            <rect
                                x="50"
                                y="80"
                                width="100"
                                height="70"
                                rx="8"
                                fill="#ddd6fe"
                                stroke="#8b5cf6"
                                strokeWidth="2"
                            />
                            <text
                                x="100"
                                y="105"
                                textAnchor="middle"
                                fill="#6d28d9"
                                fontSize="14"
                                fontWeight="600"
                            >
                                å·¦éƒ¨åˆ†æœ¨
                            </text>
                            <text
                                x="100"
                                y="125"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="18"
                                fontWeight="700"
                            >
                                {visual.leftCount}
                            </text>
                            <text x="100" y="142" textAnchor="middle" fill="#64748b" fontSize="11">
                                ãƒ‘ã‚¿ãƒ¼ãƒ³
                            </text>

                            {/* Multiply Symbol */}
                            <text
                                x="200"
                                y="120"
                                textAnchor="middle"
                                fill="#64748b"
                                fontSize="24"
                                fontWeight="700"
                            >
                                Ã—
                            </text>

                            {/* Right Trees */}
                            <rect
                                x="250"
                                y="80"
                                width="100"
                                height="70"
                                rx="8"
                                fill="#ddd6fe"
                                stroke="#8b5cf6"
                                strokeWidth="2"
                            />
                            <text
                                x="300"
                                y="105"
                                textAnchor="middle"
                                fill="#6d28d9"
                                fontSize="14"
                                fontWeight="600"
                            >
                                å³éƒ¨åˆ†æœ¨
                            </text>
                            <text
                                x="300"
                                y="125"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="18"
                                fontWeight="700"
                            >
                                {visual.rightCount}
                            </text>
                            <text x="300" y="142" textAnchor="middle" fill="#64748b" fontSize="11">
                                ãƒ‘ã‚¿ãƒ¼ãƒ³
                            </text>

                            {/* Arrow Down */}
                            <path
                                d="M 200 140 L 200 190"
                                stroke="#64748b"
                                strokeWidth="3"
                                fill="none"
                                markerEnd="url(#arrowCombine)"
                            />

                            {/* Result */}
                            <rect
                                x="100"
                                y="190"
                                width="200"
                                height="80"
                                rx="8"
                                fill="#d1fae5"
                                stroke="#10b981"
                                strokeWidth="3"
                            />
                            <text
                                x="200"
                                y="215"
                                textAnchor="middle"
                                fill="#059669"
                                fontSize="14"
                                fontWeight="600"
                            >
                                çµ„ã¿åˆã‚ã›ãŸæœ¨
                            </text>
                            <text
                                x="200"
                                y="240"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="24"
                                fontWeight="700"
                            >
                                {visual.resultCount}
                            </text>
                            <text x="200" y="260" textAnchor="middle" fill="#64748b" fontSize="11">
                                ä¸€æ„ãªæ§‹é€ 
                            </text>

                            <defs>
                                <marker
                                    id="arrowCombine"
                                    markerWidth="12"
                                    markerHeight="12"
                                    refX="9"
                                    refY="3"
                                    orient="auto"
                                >
                                    <polygon points="0 0, 12 3, 0 6" fill="#64748b" />
                                </marker>
                            </defs>
                        </svg>
                    );
                }

                if (visual.type === 'memoize') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                ãƒ¡ãƒ¢åŒ–
                            </text>

                            {/* Cache Icon */}
                            <rect
                                x="130"
                                y="80"
                                width="140"
                                height="100"
                                rx="8"
                                fill="#fef3c7"
                                stroke="#f59e0b"
                                strokeWidth="3"
                            />
                            <text
                                x="200"
                                y="105"
                                textAnchor="middle"
                                fill="#b45309"
                                fontSize="16"
                                fontWeight="600"
                            >
                                ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜
                            </text>

                            <text x="200" y="130" textAnchor="middle" fill="#334155" fontSize="14">
                                Key: {visual.key}
                            </text>
                            <text x="200" y="150" textAnchor="middle" fill="#334155" fontSize="14">
                                Trees: {visual.trees}
                            </text>
                            <text x="200" y="170" textAnchor="middle" fill="#64748b" fontSize="12">
                                ãƒ¡ãƒ¢ã«ä¿å­˜æ¸ˆã¿
                            </text>

                            {/* Check Mark */}
                            <circle
                                cx="200"
                                cy="230"
                                r="25"
                                fill="#10b981"
                                stroke="#059669"
                                strokeWidth="2"
                            />
                            <path
                                d="M 190 230 L 197 237 L 210 222"
                                stroke="white"
                                strokeWidth="3"
                                fill="none"
                                strokeLinecap="round"
                                strokeLinejoin="round"
                            />
                        </svg>
                    );
                }

                if (visual.type === 'result') {
                    return (
                        <svg
                            viewBox="0 0 400 300"
                            className="w-full h-auto svg-fade-in"
                            xmlns="http://www.w3.org/2000/svg"
                        >
                            <rect x="0" y="0" width="400" height="300" fill="#f8fafc" />

                            <text
                                x="200"
                                y="40"
                                textAnchor="middle"
                                fill="#1e293b"
                                fontSize="20"
                                fontWeight="700"
                            >
                                æœ€çµ‚çµæœ
                            </text>

                            {/* Result Box */}
                            <rect
                                x="80"
                                y="80"
                                width="240"
                                height="120"
                                rx="12"
                                fill="#d1fae5"
                                stroke="#10b981"
                                strokeWidth="3"
                            />
                            <text
                                x="200"
                                y="115"
                                textAnchor="middle"
                                fill="#059669"
                                fontSize="18"
                                fontWeight="700"
                            >
                                å…¨ã¦ã®ä¸€æ„ãªBSTã‚’ç”Ÿæˆ
                            </text>

                            <text
                                x="200"
                                y="150"
                                textAnchor="middle"
                                fill="#334155"
                                fontSize="32"
                                fontWeight="800"
                            >
                                {visual.totalTrees}
                            </text>
                            <text x="200" y="175" textAnchor="middle" fill="#64748b" fontSize="14">
                                ä¸€æ„ãªæœ¨
                            </text>

                            {/* Catalan Badge */}
                            <rect
                                x="120"
                                y="220"
                                width="160"
                                height="40"
                                rx="20"
                                fill="#e0f2fe"
                                stroke="#0ea5e9"
                                strokeWidth="2"
                            />
                            <text
                                x="200"
                                y="245"
                                textAnchor="middle"
                                fill="#0369a1"
                                fontSize="14"
                                fontWeight="600"
                            >
                                {visual.catalanNumber}
                            </text>
                        </svg>
                    );
                }

                return null;
            }

            function VisualizerComponent() {
                const [activeStep, setActiveStep] = useState(INITIAL_STEP);
                const [isPlaying, setIsPlaying] = useState(false);
                const timerRef = useRef(null);
                const totalSteps = stepsData.length;

                // Auto-play logic
                useEffect(() => {
                    if (!isPlaying) return;

                    timerRef.current = setTimeout(() => {
                        setActiveStep((prev) => {
                            const nextStep = prev + 1;
                            if (nextStep > totalSteps) {
                                setIsPlaying(false);
                                return INITIAL_STEP;
                            }
                            return nextStep;
                        });
                    }, STEP_AUTO_ADVANCE_DELAY);

                    return () => {
                        if (timerRef.current) {
                            clearTimeout(timerRef.current);
                        }
                    };
                }, [isPlaying, activeStep, totalSteps]);

                const handlePlay = () => {
                    if (isPlaying) return;
                    setActiveStep(INITIAL_STEP);
                    setIsPlaying(true);
                };

                const handleReset = () => {
                    setIsPlaying(false);
                    setActiveStep(INITIAL_STEP);
                    if (timerRef.current) {
                        clearTimeout(timerRef.current);
                    }
                };

                const handlePrev = () => {
                    setIsPlaying(false);
                    setActiveStep((prev) => Math.max(1, prev - 1));
                };

                const handleNext = () => {
                    setIsPlaying(false);
                    setActiveStep((prev) => Math.min(totalSteps, prev + 1));
                };

                const handleStepClick = (step) => {
                    setIsPlaying(false);
                    setActiveStep(step);
                };

                const currentStepInfo = stepsData[activeStep - 1];

                return (
                    <div className="space-y-6">
                        {/* Two Column Layout */}
                        <div className="grid md:grid-cols-2 gap-6 two-col-layout">
                            {/* Left: Step List */}
                            <div className="space-y-3">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">
                                    ã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§
                                </h3>
                                {stepsData.map((stepData) => (
                                    <button
                                        key={stepData.step}
                                        type="button"
                                        onClick={() => handleStepClick(stepData.step)}
                                        className={`step-btn w-full text-left p-4 rounded-lg border-2 transition-all ${
                                            activeStep === stepData.step
                                                ? 'active border-emerald-500'
                                                : 'bg-white border-gray-200 hover:border-emerald-300 hover:shadow-md'
                                        }`}
                                        aria-label={`ã‚¹ãƒ†ãƒƒãƒ— ${stepData.step}: ${stepData.title}`}
                                        aria-current={
                                            activeStep === stepData.step ? 'step' : undefined
                                        }
                                    >
                                        <div className="flex items-start gap-3">
                                            <span
                                                className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${
                                                    activeStep === stepData.step
                                                        ? 'bg-white text-emerald-600'
                                                        : 'bg-gray-100 text-gray-600'
                                                }`}
                                            >
                                                {stepData.step}
                                            </span>
                                            <div className="flex-1 min-w-0">
                                                <h4
                                                    className={`font-semibold mb-1 ${
                                                        activeStep === stepData.step
                                                            ? 'text-white'
                                                            : 'text-gray-800'
                                                    }`}
                                                >
                                                    {stepData.title}
                                                </h4>
                                                <p
                                                    className={`text-sm ${
                                                        activeStep === stepData.step
                                                            ? 'text-emerald-50'
                                                            : 'text-gray-600'
                                                    }`}
                                                >
                                                    {stepData.desc}
                                                </p>
                                            </div>
                                        </div>
                                    </button>
                                ))}
                            </div>

                            {/* Right: Visualization */}
                            <div className="bg-white rounded-lg border-2 border-gray-200 p-6">
                                <h3 className="text-lg font-semibold text-gray-800 mb-4">è¦–è¦šåŒ–</h3>
                                <div className="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <StepVisualization stepInfo={currentStepInfo} />
                                </div>

                                <div className="mt-4 p-3 bg-sky-50 rounded-lg border border-sky-200">
                                    <p className="text-sm text-gray-700">
                                        <span className="font-semibold text-sky-700">
                                            Step {activeStep}:
                                        </span>{' '}
                                        {currentStepInfo.desc}
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* Controls */}
                        <div className="flex flex-wrap items-center justify-center gap-3">
                            <button
                                type="button"
                                onClick={handlePlay}
                                disabled={isPlaying}
                                className="control-btn px-6 py-3 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white font-semibold rounded-lg shadow-md disabled:opacity-40 disabled:cursor-not-allowed"
                                aria-label="è‡ªå‹•å†ç”Ÿ"
                            >
                                â–¶ Play
                            </button>

                            <button
                                type="button"
                                onClick={handlePrev}
                                disabled={activeStep === 1 || isPlaying}
                                className="control-btn px-6 py-3 bg-white text-gray-700 font-semibold rounded-lg shadow-md border-2 border-gray-300 hover:border-emerald-500"
                                aria-label="å‰ã®ã‚¹ãƒ†ãƒƒãƒ—"
                            >
                                â† Prev
                            </button>

                            <button
                                type="button"
                                onClick={handleNext}
                                disabled={activeStep === totalSteps || isPlaying}
                                className="control-btn px-6 py-3 bg-white text-gray-700 font-semibold rounded-lg shadow-md border-2 border-gray-300 hover:border-emerald-500"
                                aria-label="æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—"
                            >
                                Next â†’
                            </button>

                            <button
                                type="button"
                                onClick={handleReset}
                                className="control-btn px-6 py-3 bg-white text-gray-700 font-semibold rounded-lg shadow-md border-2 border-gray-300 hover:border-sky-500"
                                aria-label="ãƒªã‚»ãƒƒãƒˆ"
                            >
                                â†» Reset
                            </button>
                        </div>

                        {/* Progress Indicator */}
                        <div className="flex items-center justify-center gap-2">
                            <span className="text-sm text-gray-600 font-medium">
                                Step {activeStep} / {totalSteps}
                            </span>
                            <div className="flex-1 max-w-md h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div
                                    className="h-full bg-gradient-to-r from-emerald-500 to-emerald-600 transition-all duration-300"
                                    style={{ width: `${(activeStep / totalSteps) * 100}%` }}
                                />
                            </div>
                        </div>
                    </div>
                );
            }

            // Mount component
            const container = document.getElementById('interactive-demo');
            if (container) {
                const root = ReactDOM.createRoot(container);
                root.render(<VisualizerComponent />);
            }
        </script>
    </body>
</html>
