<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>éšæ®µä¸Šã‚Šå•é¡Œ - DPè§£æ</title>
        <style>
            body {
                font-family: 'Arial', sans-serif;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #333;
                line-height: 1.6;
            }

            .container {
                background: white;
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                margin-bottom: 20px;
            }

            h1 {
                color: #4a5568;
                text-align: center;
                font-size: 2.5em;
                margin-bottom: 30px;
                background: linear-gradient(45deg, #667eea, #764ba2);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            h2 {
                color: #2d3748;
                border-bottom: 3px solid #667eea;
                padding-bottom: 10px;
                margin-top: 40px;
            }

            h3 {
                color: #4a5568;
                margin-top: 30px;
            }

            .dp-table {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
                gap: 5px;
                margin: 20px 0;
                max-width: 800px;
            }

            .dp-cell {
                background: #f7fafc;
                border: 2px solid #e2e8f0;
                padding: 15px 8px;
                text-align: center;
                border-radius: 8px;
                position: relative;
                transition: all 0.3s ease;
            }

            .dp-cell.active {
                background: #fed7d7;
                border-color: #f56565;
                transform: scale(1.05);
            }

            .dp-cell.contributing {
                background: #c6f6d5;
                border-color: #48bb78;
            }

            .dp-cell .index {
                font-size: 12px;
                color: #718096;
                display: block;
                margin-bottom: 5px;
            }

            .dp-cell .value {
                font-size: 18px;
                font-weight: bold;
                color: #2d3748;
            }

            .calculation-step {
                background: #f0f4f8;
                border-left: 4px solid #667eea;
                padding: 20px;
                margin: 20px 0;
                border-radius: 0 10px 10px 0;
            }

            .formula {
                background: #2d3748;
                color: white;
                padding: 15px;
                border-radius: 8px;
                font-family: 'Courier New', monospace;
                margin: 15px 0;
                text-align: center;
            }

            .step-controls {
                text-align: center;
                margin: 30px 0;
            }

            button {
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 25px;
                cursor: pointer;
                margin: 5px;
                font-size: 16px;
                transition: transform 0.2s ease;
            }

            button:hover {
                transform: translateY(-2px);
            }

            button:disabled {
                background: #cbd5e0;
                cursor: not-allowed;
                transform: none;
            }

            .visualization-container {
                background: #f8f9fa;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
            }

            .stairs-visual {
                display: flex;
                align-items: flex-end;
                justify-content: center;
                height: 300px;
                margin: 30px 0;
                background: linear-gradient(to bottom, #e6fffa 0%, #b2f5ea 100%);
                border-radius: 10px;
                padding: 20px;
                position: relative;
                overflow: hidden;
            }

            .stair {
                background: linear-gradient(145deg, #4a5568, #2d3748);
                margin: 2px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                border-radius: 5px;
                position: relative;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
                border: 2px solid #718096;
                min-width: 40px;
                transition: all 0.3s ease;
            }

            .stair:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            }

            .stair.current-step {
                background: linear-gradient(145deg, #e53e3e, #c53030);
                border-color: #feb2b2;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.1);
                }

                100% {
                    transform: scale(1);
                }
            }

            .jump-arrow {
                position: absolute;
                padding: 4px 8px;
                border-radius: 15px;
                font-size: 11px;
                font-weight: bold;
                top: -25px;
                white-space: nowrap;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                z-index: 10;
            }

            .jump-arrow.jump-2 {
                background: linear-gradient(45deg, #e53e3e, #c53030);
                color: white;
            }

            .jump-arrow.jump-3 {
                background: linear-gradient(45deg, #38a169, #2f855a);
                color: white;
            }

            .jump-arrow.jump-4 {
                background: linear-gradient(45deg, #3182ce, #2c5aa0);
                color: white;
            }

            .path-visualization {
                margin: 30px 0;
                padding: 20px;
                background: #f7fafc;
                border-radius: 10px;
                border: 2px solid #e2e8f0;
            }

            .path-example {
                display: flex;
                align-items: center;
                margin: 15px 0;
                padding: 10px;
                background: white;
                border-radius: 8px;
                border-left: 4px solid;
            }

            .path-example.path-2 {
                border-left-color: #e53e3e;
            }

            .path-example.path-3 {
                border-left-color: #38a169;
            }

            .path-example.path-4 {
                border-left-color: #3182ce;
            }

            .path-step {
                display: inline-block;
                background: #edf2f7;
                padding: 5px 10px;
                margin: 0 5px;
                border-radius: 5px;
                font-weight: bold;
            }

            .arrow-connector {
                color: #666;
                font-size: 18px;
                margin: 0 10px;
            }

            .complexity-analysis {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 20px 0;
            }

            .complexity-box {
                background: #edf2f7;
                padding: 20px;
                border-radius: 10px;
                border: 2px solid #e2e8f0;
            }

            .code-block {
                background: #2d3748;
                color: #e2e8f0;
                padding: 20px;
                border-radius: 10px;
                font-family: 'Courier New', monospace;
                overflow-x: auto;
                margin: 15px 0;
            }

            .highlight {
                background: #fed7d7;
                padding: 2px 4px;
                border-radius: 3px;
            }

            .tree-diagram {
                text-align: center;
                margin: 20px 0;
            }

            .tree-node {
                display: inline-block;
                background: #e6fffa;
                border: 2px solid #38b2ac;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                line-height: 36px;
                margin: 5px;
                font-weight: bold;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>ğŸªœ éšæ®µä¸Šã‚Šå•é¡Œã®å‹•çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è§£æ</h1>

            <h2>ğŸ“Š å•é¡Œè¨­å®š</h2>
            <div class="calculation-step">
                <p><strong>å…¥åŠ›ä¾‹:</strong> n=10, a=2, b=3, c=4</p>
                <p><strong>ç›®æ¨™:</strong> 10æ®µã®éšæ®µã‚’1æ­©ã§2æ®µã€3æ®µã€ã¾ãŸã¯4æ®µãšã¤ä¸Šã£ã¦åˆ°é”ã™ã‚‹æ–¹æ³•ã®æ•°ã‚’æ±‚ã‚ã‚‹</p>
            </div>

            <h2>ğŸ§® DPãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆæœŸåŒ–ã¨è¨ˆç®—éç¨‹</h2>
            <div class="step-controls">
                <button onclick="resetVisualization()">ãƒªã‚»ãƒƒãƒˆ</button>
                <button id="prevBtn" onclick="prevStep()" disabled>å‰ã®ã‚¹ãƒ†ãƒƒãƒ—</button>
                <button id="nextBtn" onclick="nextStep()">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</button>
                <button onclick="autoPlay()">è‡ªå‹•å†ç”Ÿ</button>
            </div>

            <div class="visualization-container">
                <div id="currentStep" style="text-align: center; font-size: 18px; font-weight: bold; margin-bottom: 15px;">
                    ã‚¹ãƒ†ãƒƒãƒ— 0: åˆæœŸåŒ–
                </div>
                <div class="dp-table" id="dpTable"></div>
                <div id="calculationDetails" class="calculation-step" style="display: none;"></div>
            </div>

            <h2>ğŸ—ï¸ éšæ®µã®å¯è¦–åŒ–</h2>
            <div class="visualization-container">
                <div class="stairs-visual" id="stairsVisual"></div>
                <p style="text-align: center; color: #666; margin-bottom: 20px;">
                    å„æ®µã‹ã‚‰å¯èƒ½ãªã‚¸ãƒ£ãƒ³ãƒ—:
                    <span style="background: linear-gradient(45deg, #e53e3e, #c53030); color: white; padding: 3px 8px; border-radius: 12px;">+2æ®µ</span>,
                    <span style="background: linear-gradient(45deg, #38a169, #2f855a); color: white; padding: 3px 8px; border-radius: 12px;">+3æ®µ</span>,
                    <span style="background: linear-gradient(45deg, #3182ce, #2c5aa0); color: white; padding: 3px 8px; border-radius: 12px;">+4æ®µ</span>
                </p>

                <div class="path-visualization">
                    <h3 style="text-align: center; margin-bottom: 20px;">ğŸ“ 10æ®µç›®ã¸ã®åˆ°é”ãƒ‘ã‚¿ãƒ¼ãƒ³ä¾‹</h3>

                    <div class="path-example path-2">
                        <strong>2æ®µã‚¸ãƒ£ãƒ³ãƒ—ã§åˆ°é”:</strong>
                        <span class="path-step">0</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">2</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">4</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">6</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">8</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">10</span>
                    </div>

                    <div class="path-example path-3">
                        <strong>3æ®µã‚¸ãƒ£ãƒ³ãƒ—çµ„ã¿åˆã‚ã›:</strong>
                        <span class="path-step">0</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">3</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">6</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">9</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">10 (+1ã¯ä¸å¯)</span>
                    </div>

                    <div class="path-example path-4">
                        <strong>4æ®µã‚¸ãƒ£ãƒ³ãƒ—çµ„ã¿åˆã‚ã›:</strong>
                        <span class="path-step">0</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">4</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">8</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">10 (+2)</span>
                    </div>

                    <div class="path-example" style="border-left-color: #805ad5;">
                        <strong>æ··åˆãƒ‘ã‚¿ãƒ¼ãƒ³:</strong>
                        <span class="path-step">0</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">2 (+2)</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">5 (+3)</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">9 (+4)</span>
                        <span class="arrow-connector">â†’</span>
                        <span class="path-step">10 (+1ã¯ä¸å¯)</span>
                    </div>
                </div>
            </div>

            <h2>ğŸ“ˆ çŠ¶æ…‹é·ç§»ã®æ•°å¼</h2>
            <div class="formula">
                dp[i] = dp[i-a] + dp[i-b] + dp[i-c]<br>
                (ãŸã ã—ã€i â‰¥ a, i â‰¥ b, i â‰¥ c ã®å ´åˆã®ã¿)
            </div>

            <div class="calculation-step">
                <h3>å…·ä½“çš„ãªè¨ˆç®—ä¾‹ (i=10ã®å ´åˆ):</h3>
                <p><strong>dp[10] = dp[8] + dp[7] + dp[6]</strong></p>
                <ul>
                    <li>dp[8] = 5 (8æ®µç›®ã‹ã‚‰2æ®µã‚¸ãƒ£ãƒ³ãƒ—)</li>
                    <li>dp[7] = 4 (7æ®µç›®ã‹ã‚‰3æ®µã‚¸ãƒ£ãƒ³ãƒ—)</li>
                    <li>dp[6] = 8 (6æ®µç›®ã‹ã‚‰4æ®µã‚¸ãƒ£ãƒ³ãƒ—)</li>
                </ul>
                <p><strong>çµæœ: dp[10] = 5 + 4 + 8 = 17</strong></p>
            </div>

            <h2>âš¡ è¨ˆç®—é‡è§£æ</h2>
            <div class="complexity-analysis">
                <div class="complexity-box">
                    <h3>æ™‚é–“è¨ˆç®—é‡</h3>
                    <p><strong>O(n)</strong></p>
                    <ul>
                        <li>1ã‹ã‚‰ n ã¾ã§å„æ®µã‚’1å›ãšã¤è¨ˆç®—</li>
                        <li>å„æ®µã§å®šæ•°æ™‚é–“ã®å‡¦ç†ï¼ˆ3ã¤ã®åŠ ç®—ï¼‰</li>
                        <li>åˆè¨ˆ: n Ã— O(1) = O(n)</li>
                    </ul>
                </div>
                <div class="complexity-box">
                    <h3>ç©ºé–“è¨ˆç®—é‡</h3>
                    <p><strong>O(n)</strong></p>
                    <ul>
                        <li>DPãƒ†ãƒ¼ãƒ–ãƒ«: é…åˆ—ã‚µã‚¤ã‚º n+1</li>
                        <li>ãã®ä»–ã®å¤‰æ•°: å®šæ•°å€‹</li>
                        <li>åˆè¨ˆ: O(n) + O(1) = O(n)</li>
                    </ul>
                </div>
            </div>

            <h2>ğŸ’¡ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è©³ç´°åˆ†æ</h2>

            <h3>1. åˆæœŸåŒ–ãƒ•ã‚§ãƒ¼ã‚º</h3>
            <div class="code-block">
                const dp = new Array(n + 1).fill(0);
                dp[0] = 1; // ãƒ™ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹: ã‚¹ã‚¿ãƒ¼ãƒˆåœ°ç‚¹ã¸ã®åˆ°é”æ–¹æ³•ã¯1é€šã‚Š
            </div>

            <h3>2. çŠ¶æ…‹é·ç§»ãƒ•ã‚§ãƒ¼ã‚º</h3>
            <div class="code-block">
                for (let i = 1; i <= n; i++) { if (i>= a) dp[i] += dp[i - a]; // aæ®µå‰ã‹ã‚‰æ¥ã‚‹
                    if (i >= b) dp[i] += dp[i - b]; // bæ®µå‰ã‹ã‚‰æ¥ã‚‹
                    if (i >= c) dp[i] += dp[i - c]; // cæ®µå‰ã‹ã‚‰æ¥ã‚‹
                    }
            </div>

            <h3>3. ãƒ¡ãƒ¢åŒ–ã®åŠ¹æœ</h3>
            <div class="calculation-step">
                <p><strong>ãªãœDPãŒåŠ¹ç‡çš„ã‹:</strong></p>
                <ul>
                    <li><span class="highlight">é‡è¤‡ã™ã‚‹éƒ¨åˆ†å•é¡Œ</span>: dp[i]ã¯è¤‡æ•°ã®dp[j] (j > i)ã‹ã‚‰å‚ç…§ã•ã‚Œã‚‹</li>
                    <li><span class="highlight">æœ€é©éƒ¨åˆ†æ§‹é€ </span>: dp[i]ã®æœ€é©è§£ã¯ dp[i-a], dp[i-b], dp[i-c] ã®æœ€é©è§£ã‹ã‚‰æ§‹ç¯‰</li>
                    <li><span class="highlight">ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—æ–¹å¼</span>: å°ã•ã„å•é¡Œã‹ã‚‰é †ã«è§£ã„ã¦å¤§ãã„å•é¡Œã‚’è§£æ±º</li>
                </ul>
            </div>

            <h2>ğŸ”„ å†å¸°ã¨ã®æ¯”è¼ƒ</h2>
            <div class="calculation-step">
                <h3>å†å¸°è§£æ³•ã®å•é¡Œç‚¹:</h3>
                <ul>
                    <li><strong>æ™‚é–“è¨ˆç®—é‡:</strong> O(3^n) - æŒ‡æ•°çš„å¢—åŠ </li>
                    <li><strong>åŒã˜è¨ˆç®—ã®ç¹°ã‚Šè¿”ã—:</strong> dp[i]ãŒä½•åº¦ã‚‚è¨ˆç®—ã•ã‚Œã‚‹</li>
                    <li><strong>ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼:</strong> nãŒå¤§ãã„ã¨ãã«ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§</li>
                </ul>

                <h3>DPè§£æ³•ã®åˆ©ç‚¹:</h3>
                <ul>
                    <li><strong>æ™‚é–“è¨ˆç®—é‡:</strong> O(n) - ç·šå½¢æ™‚é–“</li>
                    <li><strong>å„è¨ˆç®—ã‚’1å›ã®ã¿:</strong> ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚ŠåŠ¹ç‡çš„</li>
                    <li><strong>å®‰å®šæ€§:</strong> ãƒ«ãƒ¼ãƒ—å‡¦ç†ã§ã‚¹ã‚¿ãƒƒã‚¯å•é¡Œãªã—</li>
                </ul>
            </div>
        </div>

        <script>
            let currentStep = 0;
            let dpArray = [];
            const n = 10, a = 2, b = 3, c = 4;

            function initializeVisualization() {
                dpArray = new Array(n + 1).fill(0);
                dpArray[0] = 1;

                const table = document.getElementById('dpTable');
                table.innerHTML = '';

                for (let i = 0; i <= n; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'dp-cell';
                    cell.id = `cell-${i}`;
                    cell.innerHTML = `<span class="index">dp[${i}]</span><span class="value">${dpArray[i]}</span>`;
                    table.appendChild(cell);
                }

                createStairsVisualization();
                updateStepDisplay();
            }

            function createStairsVisualization() {
                const container = document.getElementById('stairsVisual');
                container.innerHTML = '';

                // éšæ®µã‚’ä½œæˆ
                for (let i = 0; i <= n; i++) {
                    const stair = document.createElement('div');
                    stair.className = 'stair';
                    stair.id = `stair-${i}`;

                    // éšæ®µã®é«˜ã•ã‚’æ®µæ•°ã«æ¯”ä¾‹ã•ã›ã‚‹
                    const baseHeight = 20;
                    const heightIncrement = 15;
                    stair.style.width = '45px';
                    stair.style.height = `${baseHeight + i * heightIncrement}px`;
                    stair.textContent = i;

                    // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                    if (i === currentStep) {
                        stair.classList.add('current-step');
                    }

                    // ã‚¸ãƒ£ãƒ³ãƒ—å¯èƒ½æ€§ã‚’ç¤ºã™çŸ¢å°ã‚’è¿½åŠ 
                    if (i > 0) {
                        // 2æ®µã‚¸ãƒ£ãƒ³ãƒ—
                        if (i >= a) {
                            const arrow2 = document.createElement('div');
                            arrow2.className = 'jump-arrow jump-2';
                            arrow2.textContent = `+${a}æ®µ`;
                            arrow2.style.left = '-15px';
                            stair.appendChild(arrow2);
                        }
                        // 3æ®µã‚¸ãƒ£ãƒ³ãƒ—
                        if (i >= b) {
                            const arrow3 = document.createElement('div');
                            arrow3.className = 'jump-arrow jump-3';
                            arrow3.textContent = `+${b}æ®µ`;
                            arrow3.style.left = '15px';
                            arrow3.style.top = '-30px';
                            stair.appendChild(arrow3);
                        }
                        // 4æ®µã‚¸ãƒ£ãƒ³ãƒ—
                        if (i >= c) {
                            const arrow4 = document.createElement('div');
                            arrow4.className = 'jump-arrow jump-4';
                            arrow4.textContent = `+${c}æ®µ`;
                            arrow4.style.left = '45px';
                            arrow4.style.top = '-35px';
                            stair.appendChild(arrow4);
                        }
                    }

                    container.appendChild(stair);
                }

                // åœ°é¢ã‚’è¿½åŠ 
                const ground = document.createElement('div');
                ground.style.position = 'absolute';
                ground.style.bottom = '20px';
                ground.style.left = '0';
                ground.style.right = '0';
                ground.style.height = '4px';
                ground.style.background = '#8B4513';
                ground.style.borderRadius = '2px';
                container.appendChild(ground);
            }

            function calculateStep(step) {
                if (step === 0) return;

                const i = step;
                let calculation = `dp[${i}] = `;
                let parts = [];
                let sum = 0;

                if (i >= a && dpArray[i - a] !== undefined) {
                    parts.push(`dp[${i - a}]`);
                    sum += dpArray[i - a];
                }
                if (i >= b && dpArray[i - b] !== undefined) {
                    parts.push(`dp[${i - b}]`);
                    sum += dpArray[i - b];
                }
                if (i >= c && dpArray[i - c] !== undefined) {
                    parts.push(`dp[${i - c}]`);
                    sum += dpArray[i - c];
                }

                if (parts.length === 0) {
                    dpArray[i] = 0;
                    calculation += '0 (åˆ°é”ä¸å¯èƒ½)';
                } else {
                    calculation += parts.join(' + ');
                    let valueStr = '';
                    if (i >= a) valueStr += dpArray[i - a];
                    if (i >= b) valueStr += (valueStr ? ' + ' : '') + dpArray[i - b];
                    if (i >= c) valueStr += (valueStr ? ' + ' : '') + dpArray[i - c];
                    calculation += ` = ${valueStr} = ${sum}`;
                    dpArray[i] = sum;
                }

                return calculation;
            }

            function updateDisplay() {
                // DPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
                for (let i = 0; i <= n; i++) {
                    const cell = document.getElementById(`cell-${i}`);
                    const valueSpan = cell.querySelector('.value');
                    valueSpan.textContent = dpArray[i];

                    cell.classList.remove('active', 'contributing');

                    if (i === currentStep) {
                        cell.classList.add('active');
                    }

                    // å¯„ä¸ã™ã‚‹è¦ç´ ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                    if (currentStep > 0) {
                        if (i === currentStep - a || i === currentStep - b || i === currentStep - c) {
                            if (i >= 0) cell.classList.add('contributing');
                        }
                    }
                }

                // éšæ®µã®è¡¨ç¤ºã‚’æ›´æ–°
                for (let i = 0; i <= n; i++) {
                    const stair = document.getElementById(`stair-${i}`);
                    if (stair) {
                        stair.classList.remove('current-step');
                        if (i === currentStep) {
                            stair.classList.add('current-step');
                        }
                    }
                }

                // è¨ˆç®—è©³ç´°ã‚’è¡¨ç¤º
                const detailsDiv = document.getElementById('calculationDetails');
                if (currentStep > 0 && currentStep <= n) {
                    const calculation = calculateStep(currentStep);
                    detailsDiv.innerHTML = `<strong>ã‚¹ãƒ†ãƒƒãƒ— ${currentStep}ã®è¨ˆç®—:</strong><br>${calculation}`;
                    detailsDiv.style.display = 'block';
                } else if (currentStep === 0) {
                    detailsDiv.innerHTML = '<strong>åˆæœŸåŒ–:</strong><br>dp[0] = 1 (ã‚¹ã‚¿ãƒ¼ãƒˆåœ°ç‚¹ã¸ã®åˆ°é”æ–¹æ³•ã¯1é€šã‚Š)<br>ãã®ä»–ã®dp[i] = 0ã§åˆæœŸåŒ–';
                    detailsDiv.style.display = 'block';
                } else {
                    detailsDiv.style.display = 'none';
                }
            }

            function updateStepDisplay() {
                const stepDiv = document.getElementById('currentStep');
                if (currentStep === 0) {
                    stepDiv.textContent = 'ã‚¹ãƒ†ãƒƒãƒ— 0: åˆæœŸåŒ–';
                } else if (currentStep <= n) {
                    stepDiv.textContent = `ã‚¹ãƒ†ãƒƒãƒ— ${currentStep}: dp[${currentStep}]ã‚’è¨ˆç®—`;
                } else {
                    stepDiv.textContent = `å®Œäº†: dp[${n}] = ${dpArray[n]} (ç­”ãˆ)`;
                }
            }

            function nextStep() {
                if (currentStep < n + 1) {
                    if (currentStep > 0) {
                        calculateStep(currentStep);
                    }
                    currentStep++;
                    updateDisplay();
                    updateStepDisplay();

                    document.getElementById('prevBtn').disabled = false;
                    if (currentStep > n) {
                        document.getElementById('nextBtn').disabled = true;
                    }
                }
            }

            function prevStep() {
                if (currentStep > 0) {
                    currentStep--;
                    if (currentStep > 0) {
                        // å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã®çŠ¶æ…‹ã«æˆ»ã™
                        dpArray = new Array(n + 1).fill(0);
                        dpArray[0] = 1;
                        for (let i = 1; i <= currentStep; i++) {
                            calculateStep(i);
                        }
                    } else {
                        dpArray = new Array(n + 1).fill(0);
                        dpArray[0] = 1;
                    }
                    updateDisplay();
                    updateStepDisplay();

                    document.getElementById('nextBtn').disabled = false;
                    if (currentStep === 0) {
                        document.getElementById('prevBtn').disabled = true;
                    }
                }
            }

            function resetVisualization() {
                currentStep = 0;
                initializeVisualization();
                document.getElementById('prevBtn').disabled = true;
                document.getElementById('nextBtn').disabled = false;
            }

            function autoPlay() {
                const interval = setInterval(() => {
                    if (currentStep <= n) {
                        nextStep();
                    } else {
                        clearInterval(interval);
                    }
                }, 1000);
            }

            // åˆæœŸåŒ–
            initializeVisualization();
        </script>
    </body>

</html>