ãƒ“ãƒƒãƒˆå…¨æ¢ç´¢ï¼ˆbitå…¨æ¢ç´¢ï¼‰ã¯ã€**ãƒ“ãƒƒãƒˆï¼ˆ0/1ï¼‰ã®çµ„ã¿åˆã‚ã›ã‚’ã™ã¹ã¦åˆ—æŒ™ã—ã¦èª¿ã¹ã‚‹æ–¹æ³•**ã§ã™ã€‚ç‰¹ã«çŠ¶æ…‹æ•°ãŒå°‘ãªã„ï¼ˆä¾‹ï¼š10å€‹ç¨‹åº¦ã®ã‚¹ã‚¤ãƒƒãƒã‚„ãƒ©ãƒ³ãƒ—ï¼‰å ´åˆã«æœ‰åŠ¹ã§ã€**å„çŠ¶æ…‹ã‚’æ•´æ•°ã§ç®¡ç†ã—ã€ãƒ“ãƒƒãƒˆæ¼”ç®—ã§é«˜é€Ÿã«æ“ä½œ**ã§ãã¾ã™ã€‚

---

## ğŸ¯ ç›®çš„

ãƒ©ãƒ³ãƒ— N å€‹ã® **ON/OFF çŠ¶æ…‹ã®å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ2â¿é€šã‚Šï¼‰ã‚’è©¦ã™**ã€‚

ä¾‹ãˆã° N = 4 ã®ã¨ãã€çŠ¶æ…‹ã¯æ¬¡ã®ã‚ˆã†ã« **ãƒ“ãƒƒãƒˆåˆ—ï¼ˆ0,1ï¼‰** ã§è¡¨ã›ã¾ã™ï¼š

| çŠ¶æ…‹ç•ªå· | ãƒ©ãƒ³ãƒ—çŠ¶æ…‹ï¼ˆãƒ“ãƒƒãƒˆåˆ—ï¼‰ | æ„å‘³          |
| ---- | ----------- | ----------- |
| 0    | 0000        | å…¨éƒ¨OFF       |
| 1    | 0001        | 1ç•ªã ã‘ON      |
| 2    | 0010        | 2ç•ªã ã‘ON      |
| 3    | 0011        | 1ç•ª2ç•ªON      |
| ...  | ...         | ...         |
| 15   | 1111        | å…¨éƒ¨ON âœ…ã‚´ãƒ¼ãƒ«çŠ¶æ…‹ |

---

## ğŸ§  ãªãœãƒ“ãƒƒãƒˆã‚’ä½¿ã†ã®ï¼Ÿ

* çŠ¶æ…‹ç®¡ç†ãŒ **1ã¤ã®æ•´æ•°ã§å®Œçµ**ã™ã‚‹ã€‚
* åè»¢æ“ä½œã‚‚ `XOR` ã§ã™ãã§ãã‚‹ï¼ˆå¾Œè¿°ï¼‰ã€‚
* çŠ¶æ…‹é·ç§»ã‚‚ `O(1)` ã§ã§ãã‚‹ãŸã‚ã€æ¢ç´¢ãŒé€Ÿã„ã€‚

---

## ğŸ”§ æ“ä½œã®è¡¨ç¾ï¼ˆåè»¢æ“ä½œï¼‰

æ“ä½œã¯ã€Œç‰¹å®šã®3ã¤ã®ãƒ©ãƒ³ãƒ—ã‚’åè»¢ï¼ˆONâ†”OFFï¼‰ã€ã¨ã„ã†ã‚‚ã®ã€‚ã“ã‚Œã‚’ **ãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯**ã¨ã—ã¦è¡¨ç¾ã§ãã¾ã™ã€‚

### ä¾‹ï¼šN = 4ã€æ“ä½œ = ãƒ©ãƒ³ãƒ—1, 2, 3ã‚’åè»¢ï¼ˆ1-indexedï¼‰

| ãƒ©ãƒ³ãƒ— | 4 | 3 | 2 | 1 |
| --- | - | - | - | - |
| æ“ä½œ  | 0 | 1 | 1 | 1 |

â†’ **ãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯ = 0111 (2é€²æ•°) = 7 (10é€²æ•°)**

### çŠ¶æ…‹ã«æ“ä½œã‚’é©ç”¨

```txt
çŠ¶æ…‹ S = 0110 ï¼ˆãƒ©ãƒ³ãƒ—2,3 ONï¼‰
æ“ä½œM = 0111 ï¼ˆãƒ©ãƒ³ãƒ—1,2,3 åè»¢ï¼‰

S âŠ• M = 0001 â†’ ãƒ©ãƒ³ãƒ—1ã ã‘ON
```

âœ… `XORï¼ˆ^ï¼‰` ã¯ **å¯¾å¿œãƒ“ãƒƒãƒˆãŒç•°ãªã‚‹ã¨1ã€åŒã˜ãªã‚‰0**

| ãƒ“ãƒƒãƒˆS | 0 | 1 | 1 | 0 |
| ---- | - | - | - | - |
| ãƒ“ãƒƒãƒˆM | 0 | 1 | 1 | 1 |
| XOR  | 0 | 0 | 0 | 1 |

---

## ğŸ” å…¨çŠ¶æ…‹ã‚’BFSã§æ¢ç´¢

### çŠ¶æ…‹é·ç§»ã‚°ãƒ©ãƒ•ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆN=3, æ“ä½œ1ã¤ï¼‰

```
ãƒãƒ¼ãƒ‰ = çŠ¶æ…‹ï¼ˆ000ã€œ111ï¼‰
ã‚¨ãƒƒã‚¸ = æ“ä½œï¼ˆ3ã¤ã®ãƒ©ãƒ³ãƒ—åè»¢ï¼‰

ä¾‹ï¼‰æ“ä½œ: ãƒ©ãƒ³ãƒ—1,2,3åè»¢ = ãƒã‚¹ã‚¯111ï¼ˆ7ï¼‰

0 (000) --[op]--> 7 (111)
7 (111) --[op]--> 0 (000)  â†åè»¢ã®å†é©ç”¨ã§æˆ»ã‚‹
```

---

## ğŸ§­ å›³ã§å…¨ä½“åƒã¾ã¨ã‚ï¼ˆN=3ã®ä¾‹ï¼‰

```
çŠ¶æ…‹ç•ªå·ï¼ˆ10é€²ï¼‰   ãƒ“ãƒƒãƒˆåˆ—ï¼ˆãƒ©ãƒ³ãƒ—çŠ¶æ…‹ï¼‰
       0                 000
      / \               /   \
  op1/   \op2        op1     op2
    â†“     â†“            â†“       â†“
     7   â†’ ï¼Ÿ        111     ï¼Ÿâ† ä»–ã®æ“ä½œã«ã‚ˆã‚‹é·ç§»

ï¼ˆæ“ä½œã‚’é€šã˜ã¦111ã¸åˆ°é”ã§ãã‚‹ã‹æ¢ç´¢ï¼‰
```

---

## âœ… ã¾ã¨ã‚ï¼šãƒ“ãƒƒãƒˆå…¨æ¢ç´¢ã®å¼·ã¿

| ç‰¹å¾´                  | ãƒ¡ãƒªãƒƒãƒˆ             |            |
| ------------------- | ---------------- | ---------- |
| çŠ¶æ…‹ = æ•´æ•°             | ãƒ¡ãƒ¢ãƒªç¯€ç´„ãƒ»æ¯”è¼ƒãŒé€Ÿã„      |            |
| ãƒ“ãƒƒãƒˆæ¼”ç®— (`^`, `&`, \` | \`)              | çŠ¶æ…‹å¤‰æ›´ãƒ»åè»¢ãŒé«˜é€Ÿ |
| çŠ¶æ…‹æ•°ãŒå°ã•ã„å ´åˆ           | å…¨æ¢ç´¢ã§ã‚‚å®Ÿç”¨çš„ï¼ˆNâ‰¤20ç¨‹åº¦ï¼‰ |            |

---

## ğŸ“Œ å¿œç”¨ãŒåŠ¹ãå…¸å‹å•é¡Œ

* ãƒ©ãƒ³ãƒ—ã€ã‚¹ã‚¤ãƒƒãƒã€ãƒ‰ã‚¢ã®é–‹é–‰
* é›†åˆï¼ˆéƒ¨åˆ†é›†åˆï¼‰ã®åˆ—æŒ™
* åˆ¶ç´„ä»˜ãã®ãƒ“ãƒƒãƒˆæ“ä½œå•é¡Œï¼ˆe.g. DP with bitmaskï¼‰

---

## âœ… å…¥åŠ›ä¾‹ï¼ˆN = 5, M = 3ï¼‰

```
5 3
0 1 0 1 0
1 2 3
2 4 5
1 3 5
```

* ãƒ©ãƒ³ãƒ—åˆæœŸçŠ¶æ…‹: `[0, 1, 0, 1, 0]`
* æ“ä½œ1: ãƒ©ãƒ³ãƒ—1,2,3 ã‚’åŒæ™‚ã«åè»¢
* æ“ä½œ2: ãƒ©ãƒ³ãƒ—2,4,5 ã‚’åŒæ™‚ã«åè»¢
* æ“ä½œ3: ãƒ©ãƒ³ãƒ—1,3,5 ã‚’åŒæ™‚ã«åè»¢

---

## ğŸ“˜ 1. åˆæœŸçŠ¶æ…‹ã‚’ãƒ“ãƒƒãƒˆã§è¡¨ç¾

```ts
let startState = 0;
for (let i = 0; i < N; i++) {
    if (A[i] === 1) startState |= (1 << i);
}
```

### ğŸ¯ å‡¦ç†ã®æ„å‘³ï¼š

* å„ãƒ©ãƒ³ãƒ—ã‚’ **0/1** ã§è¡¨ã—ã€å³ã‹ã‚‰å·¦ï¼ˆæœ€ä¸‹ä½ãƒ“ãƒƒãƒˆã‹ã‚‰ï¼‰ã«é †ã«é…ç½®ã€‚
* `1 << i` ã¯ã€Œiç•ªç›®ã®ãƒ©ãƒ³ãƒ—ã®ãƒ“ãƒƒãƒˆä½ç½®ã« `1` ã‚’ç«‹ã¦ã‚‹ã€ã€‚
* `|=` ã¯ãƒ“ãƒƒãƒˆORã€‚çŠ¶æ…‹ã‚’ç©ã¿é‡ã­ã‚‹ã€‚

### ğŸ§® å›³ï¼šåˆæœŸçŠ¶æ…‹ã®æ§‹ç¯‰

\| ãƒ©ãƒ³ãƒ—ç•ªå·ï¼ˆ1-indexedï¼‰ | ãƒ©ãƒ³ãƒ—çŠ¶æ…‹ A\[i] | ãƒ“ãƒƒãƒˆä½ç½® | `startState |= (1 << i)` | çŠ¶æ…‹ï¼ˆäºŒé€²ï¼‰ |
\|--------------------------|------------------|-------------|--------------------------|----------------|
\| 1                        | 0                | 0           | Ã—                        | 00000          |
\| 2                        | 1                | 1           | `startState |= 0010`     | 00010          |
\| 3                        | 0                | 2           | Ã—                        | 00010          |
\| 4                        | 1                | 3           | `startState |= 1000`     | 10010          |
\| 5                        | 0                | 4           | Ã—                        | 10010          |

ğŸ”š çµæœ â†’ `startState = 0b10010 = 18`

---

## ğŸ“˜ 2. ç›®æ¨™çŠ¶æ…‹ï¼ˆã™ã¹ã¦ONï¼‰

```ts
const goalState = (1 << N) - 1;
```

* `1 << 5 = 0b100000 = 32`
* `32 - 1 = 31 = 0b11111`

ğŸ¯ æ„å‘³ï¼šã™ã¹ã¦ã®ãƒ“ãƒƒãƒˆãŒ1ï¼ˆONï¼‰ã«ãªã£ã¦ã„ã‚‹çŠ¶æ…‹ã‚’æ•´æ•°ã§è¡¨ç¾ã€‚

---

## ğŸ“˜ 3. æ“ä½œã‚’ãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯ã§è¡¨ç¾

```ts
const ops: number[] = [];
for (let i = 0; i < M; i++) {
    const [x, y, z] = lines[2 + i].split(" ").map(n => parseInt(n, 10) - 1); // 0-indexed
    const mask = (1 << x) | (1 << y) | (1 << z);
    ops.push(mask);
}
```

### ğŸ¯ å‡¦ç†ã®æ„å‘³ï¼š

* å„æ“ä½œã¯ã€Œç‰¹å®šã®3ã¤ã®ãƒ©ãƒ³ãƒ—ã‚’åè»¢ã€â†’ ãã‚Œã‚‰ã®ãƒ“ãƒƒãƒˆã‚’ç«‹ã¦ãŸãƒã‚¹ã‚¯ã€‚
* XOR (`^`) ã«ä½¿ã†ã€‚

### ğŸ§® å›³ï¼šæ“ä½œãƒã‚¹ã‚¯ä¸€è¦§ï¼ˆ0-indexedï¼‰

| æ“ä½œç•ªå· | å¯¾è±¡ãƒ©ãƒ³ãƒ— | x, y, z (0-indexed) | ãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯   | 2é€²è¡¨ç¤º |
| ---- | ----- | ------------------- | -------- | ---- |
| 1    | 1,2,3 | 0,1,2               | 0b000111 | 0x07 |
| 2    | 2,4,5 | 1,3,4               | 0b11010  | 0x1A |
| 3    | 1,3,5 | 0,2,4               | 0b10101  | 0x15 |

---

## ğŸ“˜ 4. BFSæ¢ç´¢æº–å‚™

```ts
const visited = new Array(1 << N).fill(false);
const queue: [number, number][] = [[startState, 0]];
visited[startState] = true;
```

* çŠ¶æ…‹æ•°ã¯ `2^N = 32` ãªã®ã§ã€`visited[0..31]` ã®é…åˆ—ã‚’ä½œæˆã€‚
* `queue` ã¯ `[ç¾åœ¨ã®çŠ¶æ…‹, ã‹ã‹ã£ãŸæ“ä½œå›æ•°]`

---

## ğŸ“˜ 5. BFSæœ¬ä½“ï¼šçŠ¶æ…‹é·ç§»

```ts
while (queue.length > 0) {
    const [state, steps] = queue.shift()!;

    if (state === goalState) {
        console.log(steps);
        return;
    }

    for (const op of ops) {
        const nextState = state ^ op;
        if (!visited[nextState]) {
            visited[nextState] = true;
            queue.push([nextState, steps + 1]);
        }
    }
}
```

### ğŸ¯ ãƒã‚¤ãƒ³ãƒˆè§£èª¬ï¼š

* `state ^ op`ï¼š3ã¤ã®ãƒ©ãƒ³ãƒ—ã‚’åŒæ™‚ã«åè»¢ã™ã‚‹æ“ä½œ
* `visited[nextState]`ï¼šåŒã˜çŠ¶æ…‹ã‚’é‡è¤‡ã—ã¦æ¢ç´¢ã—ãªã„ãŸã‚ã®ãƒã‚§ãƒƒã‚¯
* `queue.push([nextState, steps + 1])`ï¼šæ¬¡ã®çŠ¶æ…‹ã¨ã‚¹ãƒ†ãƒƒãƒ—æ•°ã‚’è¨˜éŒ²

---

## ğŸ§­ çŠ¶æ…‹é·ç§»ã®ã‚¤ãƒ¡ãƒ¼ã‚¸å›³ï¼ˆstart = 10010ï¼‰

```
Start: 10010 (18)
  â”œâ”€ [op1: 000111] â†’ 10010 ^ 000111 = 10101 (21)
  â”œâ”€ [op2: 11010] â†’ 10010 ^ 11010 = 01000 (8)
  â”œâ”€ [op3: 10101] â†’ 10010 ^ 10101 = 00111 (7)
           â†“
     ï¼ˆã•ã‚‰ã«å„çŠ¶æ…‹ã‹ã‚‰æ¬¡ã®æ“ä½œã‚’é©ç”¨ï¼‰
```

çŠ¶æ…‹ãŒ `0b11111`ï¼ˆ=31ï¼‰ã«åˆ°é”ã™ã‚Œã°çµ‚äº†ã€‚

---

## âœ… ã¾ã¨ã‚

| ã‚¹ãƒ†ãƒƒãƒ—  | å†…å®¹                   | çµæœï¼ˆçŠ¶æ…‹ï¼‰                |
| ----- | -------------------- | --------------------- |
| åˆæœŸåŒ–   | startState æ§‹ç¯‰        | 10010ï¼ˆ18ï¼‰             |
| ç›®æ¨™    | goalState            | 11111ï¼ˆ31ï¼‰             |
| æ“ä½œå¤‰æ›  | å„opã‚’ãƒ“ãƒƒãƒˆãƒã‚¹ã‚¯åŒ–          | op1=7, op2=26, op3=21 |
| BFSæ¢ç´¢ | çŠ¶æ…‹ã‚’ã‚­ãƒ¥ãƒ¼ã§ç®¡ç†ã—ãªãŒã‚‰åè»¢æ“ä½œã‚’é©ç”¨ | æœ€çŸ­ã‚¹ãƒ†ãƒƒãƒ—ã§ `11111` ã«åˆ°é”   |

---

| [æå‡ºæ—¥æ™‚](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=created) | å•é¡Œ | ãƒ¦ãƒ¼ã‚¶ | è¨€èª | [å¾—ç‚¹](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=score) | [ã‚³ãƒ¼ãƒ‰é•·](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=source_length) | çµæœ | [å®Ÿè¡Œæ™‚é–“](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=time_consumption) | [ãƒ¡ãƒ¢ãƒª](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=memory_consumption) |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 2025-06-24 11:55:00 | [A70 - Lanterns](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_br) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [PHP (php 8.2.8)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5016) | 1000 | 1200 Byte | **AC** | 15 ms | 21740 KiB | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67034069) |
| 2025-06-24 11:52:38 | [A70 - Lanterns](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_br) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Go (go 1.20.6)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5002) | 1000 | 1454 Byte | **AC** | 1 ms | 1652 KiB | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67034038) |
| 2025-06-24 11:48:46 | [A70 - Lanterns](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_br) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Python (CPython 3.11.4)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5055) | 1000 | 1350 Byte | **AC** | 12 ms | 9420 KiB | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67033984) |
| 2025-06-24 11:25:59 | [A70 - Lanterns](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_br) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [TypeScript 5.1 (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5058) | 1000 | 1535 Byte | **AC** | 40 ms | 44496 KiB | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67033636) |
| 2025-06-24 11:16:40 | [A70 - Lanterns](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_br) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [JavaScript (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5009) | 1000 | 1411 Byte | **AC** | 42 ms | 44324 KiB | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67033513) |