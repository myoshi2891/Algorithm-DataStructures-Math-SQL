それでは、先ほど提示した **TypeScript 実装**の各処理を「図」を用いて、できるだけ具体的に解析・説明します。

---

## 問題の流れ

与えられるのは

- **既存の区間リスト（非重複、開始位置でソート済み）**
- **新しい区間 newInterval**

これを挿入し、重なりがあればマージ（統合）します。

---

## 処理ステップの図解

### 例

```
intervals = [[1,3],[6,9]]
newInterval = [2,5]
```

---

### ステップ1: 「前にある区間」を追加

```ts
while (i < n && intervals[i][1] < newInterval[0]) {
    result.push(intervals[i]);
    i++;
}
```

#### 動作イメージ

- `intervals[i][1] < newInterval[0]`
  → 区間の終端が `newInterval` の開始より前にある場合は **重ならないのでそのまま追加**

```
intervals:   [ [1,3], [6,9] ]
newInterval: [2,5]

[1,3] の終端 3 < 2 ? → NO
⇒ まだ result に追加しない
```

👉 この例では追加される区間はありません。

---

### ステップ2: 「重なる区間」をマージ

```ts
while (i < n && intervals[i][0] <= newInterval[1]) {
    newInterval[0] = Math.min(newInterval[0], intervals[i][0]);
    newInterval[1] = Math.max(newInterval[1], intervals[i][1]);
    i++;
}
result.push(newInterval);
```

#### 動作イメージ

- `intervals[i][0] <= newInterval[1]`
  → 区間の開始が `newInterval` の終端以下なら **重なっている**

```
intervals:   [ [1,3], [6,9] ]
newInterval: [2,5]

i=0 → [1,3] の開始 1 <= 5 → YES 重なる
  newInterval = [min(2,1), max(5,3)] = [1,5]

i=1 → [6,9] の開始 6 <= 5 ? → NO 終了
```

👉 マージ後の `newInterval` は `[1,5]` となり、`result` に追加。

---

### ステップ3: 「残りの区間」を追加

```ts
while (i < n) {
    result.push(intervals[i]);
    i++;
}
```

#### 動作イメージ

- もうマージ対象外なので、そのまま追加

```
result = [ [1,5] ] + [ [6,9] ]
```

👉 最終結果:

```
[[1,5], [6,9]]
```

---

## もう1つの例で確認

```
intervals = [[1,2],[3,5],[6,7],[8,10],[12,16]]
newInterval = [4,8]
```

### 処理の流れ

#### Step1: 前にある区間

```
[1,2] の終端 2 < 4 → YES → 追加
result = [[1,2]]
```

#### Step2: マージする区間

- \[3,5] (開始3 <= 8) → マージ → \[min(4,3), max(8,5)] = \[3,8]
- \[6,7] (開始6 <= 8) → マージ → \[min(3,6), max(8,7)] = \[3,8]
- \[8,10] (開始8 <= 8) → マージ → \[min(3,8), max(8,10)] = \[3,10]
  → result に `[3,10]` を追加

```
result = [[1,2],[3,10]]
```

#### Step3: 残りの区間

- \[12,16] を追加

```
最終結果 = [[1,2],[3,10],[12,16]]
```

---

## 全体まとめ図

```
┌───────────────────────────────────┐
│ 1. 前にある区間 → そのまま result │
└───────────────────────────────────┘
                 │
                 ▼
┌───────────────────────────────────┐
│ 2. newInterval と重なる区間を統合 │
│    → 1つの大きな区間にまとめる   │
└───────────────────────────────────┘
                 │
                 ▼
┌───────────────────────────────────┐
│ 3. 残りの区間を result に追加     │
└───────────────────────────────────┘
```

---

## 計算量解析

- **時間計算量:** O(n) （各区間を最大1回だけ処理）
- **空間計算量:** O(n) （結果用の配列に最大 n+1 個格納する可能性）
