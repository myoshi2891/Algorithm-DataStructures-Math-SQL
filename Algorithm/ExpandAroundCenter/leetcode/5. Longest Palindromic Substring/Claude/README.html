<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LeetCode 5: Longest Palindromic Substring - ä¸­å¿ƒå±•é–‹æ³•</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&family=Source+Code+Pro:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Prism.js -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.css"
      rel="stylesheet"
    />

    <style>
      html {
        scroll-behavior: smooth;
      }

      code[class*="language-"],
      pre[class*="language-"] {
        font-family: "JetBrains Mono", "Source Code Pro", monospace;
        font-size: 0.95rem;
      }

      div.code-toolbar > .toolbar {
        opacity: 1;
      }

      div.code-toolbar > .toolbar .toolbar-item > button,
      div.code-toolbar > .toolbar .toolbar-item > a {
        background: #fff;
        border: 1px solid #e6e8ef;
        border-radius: 10px;
        padding: 1rem 1.5rem;
        margin: 1rem 1rem 0 0;
        font: 600 13px/1.2 Inter, system-ui, sans-serif;
        color: #334155;
        box-shadow: 0 2px 6px rgba(20, 32, 70, 0.06);
        transition: transform 0.15s, box-shadow 0.15s, background 0.15s;
      }

      div.code-toolbar > .toolbar .toolbar-item > button:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 28px rgba(20, 32, 70, 0.08);
        background: linear-gradient(180deg, #e8fff6, #c8f1e1);
      }
    </style>
  </head>
  <body
    class="min-h-screen p-8 sm:p-6 font-[Inter] text-slate-800 leading-relaxed bg-[linear-gradient(135deg,#f0fdf4_0%,#dbeafe_100%)]"
  >
    <div class="max-w-[1400px] mx-auto">
      <!-- Header -->
      <header
        id="header"
        class="mb-8 rounded-2xl p-8 shadow-[0_10px_30px_rgba(16,185,129,0.10)] bg-[linear-gradient(135deg,#d1fae5,#bfdbfe)]"
      >
        <h1 class="text-[2.5rem] font-bold text-teal-800 mb-2">
          Longest Palindromic Substring
        </h1>
        <p class="text-xl text-cyan-700 font-semibold mt-2">
          ä¸­å¿ƒå±•é–‹æ³•ã«ã‚ˆã‚‹ O(nÂ²) å®Ÿè£…
        </p>
        <nav class="flex flex-wrap gap-4 mt-6">
          <a
            href="#overview"
            class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
            >æ¦‚è¦</a
          >
          <a
            href="#steps"
            class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
            >ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬</a
          >
          <a
            href="#code"
            class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
            >ã‚³ãƒ¼ãƒ‰</a
          >
          <a
            href="#diagram"
            class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
            >ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</a
          >
          <a
            href="#complexity"
            class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
            >è¨ˆç®—é‡</a
          >
        </nav>
      </header>

      <!-- Overview -->
      <section id="overview" class="bg-white rounded-2xl p-8 mb-8 shadow">
        <h2
          class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
        >
          ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¦‚è¦
        </h2>

        <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">å•é¡Œèª¬æ˜</h3>
        <p class="mb-4">
          æ–‡å­—åˆ—
          <code class="bg-slate-100 px-2 py-1 rounded text-sm">s</code>
          ãŒä¸ãˆã‚‰ã‚ŒãŸã¨ãã€<strong>æœ€é•·ã®å›æ–‡éƒ¨åˆ†æ–‡å­—åˆ—</strong>ã‚’è¿”ã™å•é¡Œã§ã™ã€‚
        </p>

        <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">å…¥å‡ºåŠ›ä¾‹</h3>
        <div class="bg-slate-50 p-4 rounded-lg mb-4">
          <p class="font-semibold mb-2">ä¾‹1:</p>
          <pre
            class="bg-slate-800 text-white p-3 rounded"
          ><code>Input: s = "babad"
Output: "bab" (ã¾ãŸã¯ "aba")</code></pre>
        </div>

        <div class="bg-slate-50 p-4 rounded-lg mb-4">
          <p class="font-semibold mb-2">ä¾‹2:</p>
          <pre
            class="bg-slate-800 text-white p-3 rounded"
          ><code>Input: s = "cbbd"
Output: "bb"</code></pre>
        </div>

        <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">åˆ¶ç´„æ¡ä»¶</h3>
        <ul class="list-disc list-inside space-y-2 ml-4">
          <li>
            <code class="bg-slate-100 px-2 py-1 rounded text-sm"
              >1 &lt;= s.length &lt;= 1000</code
            >
          </li>
          <li>
            <code class="bg-slate-100 px-2 py-1 rounded text-sm">s</code>
            ã¯è‹±å­—ã¨æ•°å­—ã®ã¿ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹
          </li>
        </ul>

        <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">æˆ¦ç•¥</h3>
        <ul class="list-disc list-inside space-y-2 ml-4">
          <li>
            <strong>ä¸­å¿ƒå±•é–‹æ³•</strong>ã‚’ä½¿ç”¨ã—ã€å„ä½ç½®ã‚’ä¸­å¿ƒã¨ã—ã¦å·¦å³ã«å±•é–‹
          </li>
          <li>å¥‡æ•°é•·ï¼ˆä¸­å¿ƒ1æ–‡å­—ï¼‰ã¨å¶æ•°é•·ï¼ˆä¸­å¿ƒ2æ–‡å­—ï¼‰ã®ä¸¡æ–¹ã‚’è©¦è¡Œ</li>
          <li>å›æ–‡ãŒç¶šãé™ã‚Šç¯„å›²ã‚’åºƒã’ã€æœ€é•·ã®ã‚‚ã®ã‚’è¨˜éŒ²</li>
          <li>è¿½åŠ ãƒ¡ãƒ¢ãƒªã‚’ä½¿ã‚ãšã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã¿ã§ç®¡ç†</li>
        </ul>

        <h3 class="text-xl font-semibold text-teal-800 mt-6 mb-3">
          ä¸»è¦ãƒã‚¤ãƒ³ãƒˆ
        </h3>
        <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 rounded">
          <p class="font-semibold text-emerald-900 mb-2">æ™‚é–“è¨ˆç®—é‡: O(nÂ²)</p>
          <p class="text-slate-700 mb-3">å„ä½ç½® O(n) Ã— å±•é–‹ O(n) = O(nÂ²)</p>

          <p class="font-semibold text-emerald-900 mb-2">ç©ºé–“è¨ˆç®—é‡: O(1)</p>
          <p class="text-slate-700">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ã¿ä¿æŒã€è¿½åŠ æ§‹é€ ä¸è¦</p>
        </div>
      </section>

      <!-- Steps -->
      <section id="steps" class="bg-white rounded-2xl p-8 mb-8 shadow">
        <h2
          class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
        >
          ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è§£èª¬
        </h2>
        <p class="text-lg text-slate-700 font-bold mb-4">
          s = "babad" ã‚’ä¾‹ã«ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å‹•ä½œã‚’è¿½ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
        </p>
        <div id="react-root"></div>
      </section>

      <!-- Code -->
      <section id="code" class="bg-white rounded-2xl p-8 mb-8 shadow">
        <h2
          class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
        >
          Pythonå®Ÿè£…
        </h2>
        <pre
          class="line-numbers"
        ><code class="language-python">from __future__ import annotations


class Solution:
    def longestPalindrome(self, s: str) -> str:
        """
        Longest Palindromic Substring - ä¸­å¿ƒå±•é–‹æ³•
        Time: O(n^2), Space: O(1)

        å„ä½ç½®ã‚’ä¸­å¿ƒã«å¥‡æ•°é•·ãƒ»å¶æ•°é•·ã®å›æ–‡ã‚’å±•é–‹ã—ã€æœ€é•·ã®ã‚‚ã®ã‚’è¿”ã™ã€‚
        """
        n: int = len(s)
        if n <= 1:
            return s

        def expand(l: int, r: int) -> tuple[int, int]:
            """
            ä¸­å¿ƒ (l, r) ã‹ã‚‰å¯èƒ½ãªé™ã‚Šå±•é–‹ã—ã€
            inclusive ã® [L, R] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¿”ã™ã€‚
            """
            while l >= 0 and r < n and s[l] == s[r]:
                l -= 1
                r += 1
            # ãƒ«ãƒ¼ãƒ—çµ‚äº†æ™‚ã¯ l, r ãŒæ¡ä»¶ã‚’æº€ãŸã•ãªã„ä½ç½®ãªã®ã§ +1, -1 ã§æˆ»ã™
            return l + 1, r - 1

        best_l: int = 0
        best_r: int = 0

        # å„ä½ç½®ã§å¥‡æ•°é•·ãƒ»å¶æ•°é•·ã®ä¸¡æ–¹ã‚’è©¦è¡Œ
        for i in range(n):
            # å¥‡æ•°é•·ï¼ˆä¸­å¿ƒ1æ–‡å­—ï¼‰
            l1, r1 = expand(i, i)
            if r1 - l1 > best_r - best_l:
                best_l, best_r = l1, r1

            # å¶æ•°é•·ï¼ˆä¸­å¿ƒ2æ–‡å­—ï¼‰
            l2, r2 = expand(i, i + 1)
            if r2 - l2 > best_r - best_l:
                best_l, best_r = l2, r2

        # æœ€å¾Œã«ä¸€åº¦ã ã‘ã‚¹ãƒ©ã‚¤ã‚¹ã‚’ç”Ÿæˆï¼ˆãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–ï¼‰
        return s[best_l : best_r + 1]</code></pre>
      </section>

      <!-- Diagram -->
      <section id="diagram" class="bg-white rounded-2xl p-8 mb-8 shadow">
        <h2
          class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
        >
          ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
        </h2>
        <div class="mt-[20px] overflow-x-auto">
          <svg
            viewBox="0 0 840 900"
            style="max-width: 100%; height: auto; color: #333"
            role="img"
            aria-label="Longest Palindromic Substring flowchart"
          >
            <defs>
              <marker
                id="arrow"
                markerWidth="10"
                markerHeight="10"
                refX="9"
                refY="3"
                orient="auto"
                markerUnits="strokeWidth"
              >
                <path d="M0,0 L0,6 L9,3 z" fill="#64748b"></path>
              </marker>
            </defs>

            <!-- é–‹å§‹ -->
            <ellipse
              cx="400"
              cy="60"
              rx="100"
              ry="35"
              fill="#d1fae5"
              stroke="#10b981"
              stroke-width="2"
            ></ellipse>
            <text
              x="400"
              y="60"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="18"
              font-weight="600"
            >
              é–‹å§‹
            </text>

            <!-- é–‹å§‹ â†’ é•·ã•ãƒã‚§ãƒƒã‚¯ -->
            <path
              d="M 400 95 L 400 150"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>

            <!-- é•·ã•ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ€ã‚¤ãƒ¤ï¼‰ -->
            <path
              d="M 400 150 L 500 200 L 400 250 L 300 200 Z"
              fill="#fef3c7"
              stroke="#f59e0b"
              stroke-width="2"
            ></path>
            <text
              x="400"
              y="200"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="0">n &lt;= 1</tspan>
            </text>

            <!-- ã¯ã„ â†’ å³åº§ã«è¿”ã™ -->
            <path
              d="M 500 200 L 600 200"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="550"
              y="190"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#059669"
            >
              ã¯ã„
            </text>
            <rect
              x="600"
              y="170"
              width="160"
              height="60"
              rx="8"
              fill="#e0f2fe"
              stroke="#0284c7"
              stroke-width="2"
            ></rect>
            <text
              x="680"
              y="200"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="680" dy="-8">s ã‚’è¿”ã™</tspan>
              <tspan x="680" dy="18">(åŸºåº•æ¡ä»¶)</tspan>
            </text>

            <!-- ã„ã„ãˆ â†’ åˆæœŸåŒ– -->
            <path
              d="M 400 250 L 400 290"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="440"
              y="270"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#dc2626"
            >
              ã„ã„ãˆ
            </text>

            <rect
              x="300"
              y="290"
              width="200"
              height="70"
              rx="8"
              fill="#e0f2fe"
              stroke="#0284c7"
              stroke-width="2"
            ></rect>
            <text
              x="400"
              y="325"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="-8">åˆæœŸåŒ–</tspan>
              <tspan x="400" dy="18">best_l = 0, best_r = 0</tspan>
            </text>

            <!-- åˆæœŸåŒ– â†’ ãƒ«ãƒ¼ãƒ—åˆ¤å®š -->
            <path
              d="M 400 360 L 400 415"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>

            <!-- ãƒ«ãƒ¼ãƒ—åˆ¤å®šï¼ˆãƒ€ã‚¤ãƒ¤ï¼‰ -->
            <path
              d="M 400 415 L 500 465 L 400 515 L 300 465 Z"
              fill="#fef3c7"
              stroke="#f59e0b"
              stroke-width="2"
            ></path>
            <text
              x="400"
              y="465"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="-8">i &lt; n</tspan>
              <tspan x="400" dy="18">(å„ä½ç½®ã‚’èµ°æŸ»)</tspan>
            </text>

            <!-- ã¯ã„ â†’ å¥‡æ•°é•·å±•é–‹ -->
            <path
              d="M 400 515 L 400 555"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="440"
              y="535"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#059669"
            >
              ã¯ã„
            </text>

            <rect
              x="300"
              y="555"
              width="200"
              height="60"
              rx="8"
              fill="#e0f2fe"
              stroke="#0284c7"
              stroke-width="2"
            ></rect>
            <text
              x="400"
              y="585"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="-8">expand(i, i)</tspan>
              <tspan x="400" dy="18">(å¥‡æ•°é•·)</tspan>
            </text>

            <!-- å¥‡æ•°é•· â†’ æ›´æ–°ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ€ã‚¤ãƒ¤ï¼‰ -->
            <path
              d="M 400 615 L 400 675"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <path
              d="M 400 675 L 500 725 L 400 775 L 300 725 Z"
              fill="#fef3c7"
              stroke="#f59e0b"
              stroke-width="2"
            ></path>
            <text
              x="400"
              y="725"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="-8">ã‚ˆã‚Šé•·ã„</tspan>
              <tspan x="400" dy="18">å›æ–‡ã‹</tspan>
            </text>

            <!-- ã¯ã„ â†’ best æ›´æ–° -->
            <path
              d="M 300 725 L 160 725"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="255"
              y="710"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#059669"
            >
              ã¯ã„
            </text>

            <rect
              x="60"
              y="695"
              width="100"
              height="60"
              rx="8"
              fill="#d1fae5"
              stroke="#10b981"
              stroke-width="2"
            ></rect>
            <text
              x="110"
              y="725"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="110" dy="-8">best ã‚’</tspan>
              <tspan x="110" dy="18">æ›´æ–°</tspan>
            </text>

            <!-- best æ›´æ–° â†’ å¶æ•°é•·å±•é–‹ ã¸æˆ»ã™ç·š -->
            <path
              d="M 110 755 L 110 845 L 300 845"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>

            <!-- ã„ã„ãˆ â†’ å¶æ•°é•·å±•é–‹ -->
            <path
              d="M 400 775 L 400 815"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="440"
              y="795"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#dc2626"
            >
              ã„ã„ãˆ
            </text>

            <rect
              x="300"
              y="815"
              width="200"
              height="60"
              rx="8"
              fill="#e0f2fe"
              stroke="#0284c7"
              stroke-width="2"
            ></rect>
            <text
              x="400"
              y="845"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="400" dy="-8">expand(i, i+1)</tspan>
              <tspan x="400" dy="18">(å¶æ•°é•·)</tspan>
            </text>

            <!-- å¶æ•°é•· â†’ ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ i++ -->
            <path
              d="M 500 845 L 630 845 L 630 465 L 500 465"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="645"
              y="655"
              text-anchor="start"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#6366f1"
            >
              i++
            </text>

            <!-- ãƒ«ãƒ¼ãƒ—åˆ¤å®š No â†’ çµæœã¸ -->
            <path
              d="M 300 465 L 110 465 L 110 555"
              stroke="#64748b"
              stroke-width="2"
              fill="none"
              marker-end="url(#arrow)"
            ></path>
            <text
              x="255"
              y="445"
              text-anchor="start"
              dominant-baseline="middle"
              font-size="14"
              font-weight="600"
              fill="#dc2626"
            >
              ã„ã„ãˆ
            </text>

            <!-- çµæœ -->
            <ellipse
              cx="110"
              cy="590"
              rx="90"
              ry="35"
              fill="#d1fae5"
              stroke="#10b981"
              stroke-width="2"
            ></ellipse>
            <text
              x="110"
              y="590"
              text-anchor="middle"
              dominant-baseline="middle"
              font-size="16"
              font-weight="600"
            >
              <tspan x="110" dy="-8">çµæœã‚’</tspan>
              <tspan x="110" dy="18">è¿”ã™</tspan>
            </text>
          </svg>
        </div>

        <p class="mt-8 font-[Source_Code_Pro] text-[20px] font-semibold">
          <strong class="text-2xl">ãƒ•ãƒ­ãƒ¼ã®èª¬æ˜ï¼š</strong><br />
          1. <span class="text-teal-700">é–‹å§‹</span> â†’ æ–‡å­—åˆ— s
          ã®é•·ã•ã‚’ãƒã‚§ãƒƒã‚¯<br />
          2. <span class="text-amber-600">n â‰¤ 1</span> ãªã‚‰
          <span class="text-cyan-700">s ã‚’ãã®ã¾ã¾è¿”ã—ã¦çµ‚äº†</span
          >ï¼ˆåŸºåº•æ¡ä»¶ï¼‰<br />
          3. ãã†ã§ãªã‘ã‚Œã°
          <span class="text-cyan-700">best_l = 0, best_r = 0</span>
          ã§åˆæœŸåŒ–<br />
          4. <span class="text-amber-600">å„ä½ç½® i ã‚’èµ°æŸ»</span>ï¼ˆi = 0 ã‹ã‚‰ n-1
          ã¾ã§ï¼‰<br />
          5. å„ä½ç½®ã§
          <span class="text-cyan-700">expand(i, i)</span> ã‚’å®Ÿè¡Œï¼ˆå¥‡æ•°é•·ï¼‰<br />
          6. ã‚ˆã‚Šé•·ã„å›æ–‡ãªã‚‰ <span class="text-emerald-600">best ã‚’æ›´æ–°</span
          ><br />
          7. æ¬¡ã«
          <span class="text-cyan-700">expand(i, i+1)</span>
          ã‚’å®Ÿè¡Œï¼ˆå¶æ•°é•·ï¼‰<br />
          8. ã‚ˆã‚Šé•·ã„å›æ–‡ãªã‚‰ <span class="text-emerald-600">best ã‚’æ›´æ–°</span
          ><br />
          9. i++ ã—ã¦æ¬¡ã®ä½ç½®ã¸ï¼ˆã‚¹ãƒ†ãƒƒãƒ—4ã«æˆ»ã‚‹ï¼‰<br />
          10. å…¨ä½ç½®èµ°æŸ»å®Œäº†å¾Œã€<span class="text-teal-700"
            >s[best_l : best_r+1] ã‚’è¿”ã—ã¦çµ‚äº†</span
          >
        </p>
      </section>

      <!-- Complexity -->
      <section id="complexity" class="bg-white rounded-2xl p-8 mb-8 shadow">
        <h2
          class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
        >
          è¨ˆç®—é‡åˆ†æ
        </h2>

        <div class="overflow-x-auto">
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-emerald-50">
                <th
                  class="border-2 border-emerald-200 px-4 py-3 text-left font-semibold"
                >
                  é …ç›®
                </th>
                <th
                  class="border-2 border-emerald-200 px-4 py-3 text-left font-semibold"
                >
                  æœ¬å®Ÿè£…ï¼ˆä¸­å¿ƒå±•é–‹æ³•ï¼‰
                </th>
                <th
                  class="border-2 border-emerald-200 px-4 py-3 text-left font-semibold"
                >
                  ä»£æ›¿æ‰‹æ³•
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="border-2 border-slate-200 px-4 py-3 font-semibold">
                  æ™‚é–“è¨ˆç®—é‡
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  <code class="bg-emerald-100 px-2 py-1 rounded">O(nÂ²)</code>
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  DP: O(nÂ²)<br />
                  Manacher: O(n)
                </td>
              </tr>
              <tr class="bg-slate-50">
                <td class="border-2 border-slate-200 px-4 py-3 font-semibold">
                  ç©ºé–“è¨ˆç®—é‡
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  <code class="bg-emerald-100 px-2 py-1 rounded">O(1)</code>
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  DP: O(nÂ²)<br />
                  Manacher: O(n)
                </td>
              </tr>
              <tr>
                <td class="border-2 border-slate-200 px-4 py-3 font-semibold">
                  å®Ÿè£…ã‚³ã‚¹ãƒˆ
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  <span class="text-emerald-600 font-semibold">ä½</span>
                  (çŸ­ãç›´æ„Ÿçš„)
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  DP: ä¸­<br />
                  Manacher: é«˜
                </td>
              </tr>
              <tr class="bg-slate-50">
                <td class="border-2 border-slate-200 px-4 py-3 font-semibold">
                  n=1000ã§ã®å®Ÿç”¨æ€§
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  <span class="text-emerald-600 font-semibold">â— ååˆ†é«˜é€Ÿ</span>
                </td>
                <td class="border-2 border-slate-200 px-4 py-3">
                  DP: â–³ (ãƒ¡ãƒ¢ãƒªé‡ã„)<br />
                  Manacher: â— (æœ€é€Ÿ)
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-6 bg-cyan-50 border-l-4 border-cyan-500 p-4 rounded">
          <p class="font-semibold text-cyan-900 mb-2">ğŸ’¡ æ¡ç”¨ç†ç”±</p>
          <ul class="list-disc list-inside space-y-1 text-slate-700 ml-2">
            <li>åˆ¶ç´„ n â‰¤ 1000 ã§ã¯ O(nÂ²) ã§ååˆ†å®Ÿç”¨çš„</li>
            <li>è¿½åŠ ãƒ¡ãƒ¢ãƒª O(1) ã§ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ãŒæœ€é«˜</li>
            <li>å®Ÿè£…ãŒçŸ­ãã€ãƒã‚°æ··å…¥ç‡ãŒä½ã„</li>
            <li>CPython ã®æ–‡å­—æ¯”è¼ƒï¼ˆCå®Ÿè£…ï¼‰ã‚’æ´»ç”¨ã§ãã‚‹</li>
          </ul>
        </div>
      </section>
    </div>

    <!-- React -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Prism.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const stepsData = [
        {
          step: 1,
          title: "åˆæœŸåŒ–",
          desc: 's = "babad" (n=5) ã‚’ä¾‹ã¨ã™ã‚‹ã€‚best_l = 0, best_r = 0 ã§åˆæœŸåŒ–ï¼ˆæœ€å°ã®å›æ–‡ã¯ s[0] ã®1æ–‡å­—ï¼‰',
          visual: {
            type: "init",
            s: "babad",
            best_l: 0,
            best_r: 0,
          },
        },
        {
          step: 2,
          title: "i=0: å¥‡æ•°é•·å±•é–‹",
          desc: 'expand(0, 0) ã§ "b" ã‹ã‚‰å±•é–‹ã€‚å·¦å³ã«æ‹¡å¼µã§ããªã„ãŸã‚ l=0, r=0ã€‚é•·ã•1ï¼ˆç¾åœ¨ã®bestã¨åŒã˜ï¼‰ãªã®ã§æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_odd",
            s: "babad",
            i: 0,
            l: 0,
            r: 0,
            best_l: 0,
            best_r: 0,
            updated: false,
          },
        },
        {
          step: 3,
          title: "i=0: å¶æ•°é•·å±•é–‹",
          desc: 'expand(0, 1) ã§ "b" ã¨ "a" ã‹ã‚‰å±•é–‹ã€‚s[0] â‰  s[1] ãªã®ã§å³åº§ã«çµ‚äº†ã€‚æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_even",
            s: "babad",
            i: 0,
            l: 0,
            r: 1,
            best_l: 0,
            best_r: 0,
            updated: false,
            match: false,
          },
        },
        {
          step: 4,
          title: "i=1: å¥‡æ•°é•·å±•é–‹",
          desc: 'expand(1, 1) ã§ "a" ã‹ã‚‰å±•é–‹ã€‚s[0]="b" ã¨ s[2]="b" ãŒä¸€è‡´ï¼l=0, r=2 ã«æ‹¡å¼µã€‚ã•ã‚‰ã«å·¦å³ã‚’è©¦ã™ãŒç¯„å›²å¤–ã€‚æœ€çµ‚ l=0, r=2 ã§ "bab"ï¼ˆé•·ã•3ï¼‰ã‚’ç™ºè¦‹ã€‚best ã‚’æ›´æ–°ï¼',
          visual: {
            type: "expand_odd",
            s: "babad",
            i: 1,
            l: 0,
            r: 2,
            best_l: 0,
            best_r: 2,
            updated: true,
          },
        },
        {
          step: 5,
          title: "i=1: å¶æ•°é•·å±•é–‹",
          desc: 'expand(1, 2) ã§ "a" ã¨ "b" ã‹ã‚‰å±•é–‹ã€‚s[1] â‰  s[2] ãªã®ã§å³åº§ã«çµ‚äº†ã€‚æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_even",
            s: "babad",
            i: 1,
            l: 1,
            r: 2,
            best_l: 0,
            best_r: 2,
            updated: false,
            match: false,
          },
        },
        {
          step: 6,
          title: "i=2: å¥‡æ•°é•·å±•é–‹",
          desc: 'expand(2, 2) ã§ "b" ã‹ã‚‰å±•é–‹ã€‚s[1]="a" ã¨ s[3]="a" ãŒä¸€è‡´ï¼l=1, r=3 ã«æ‹¡å¼µã€‚ã•ã‚‰ã« s[0]="b" ã¨ s[4]="d" ã‚’æ¯”è¼ƒâ†’ä¸ä¸€è‡´ã€‚æœ€çµ‚ l=1, r=3 ã§ "aba"ï¼ˆé•·ã•3ï¼‰ã€‚bestã¨åŒã˜é•·ã•ãªã®ã§æ›´æ–°ãªã—ï¼ˆå·¦å„ªå…ˆï¼‰ã€‚',
          visual: {
            type: "expand_odd",
            s: "babad",
            i: 2,
            l: 1,
            r: 3,
            best_l: 0,
            best_r: 2,
            updated: false,
          },
        },
        {
          step: 7,
          title: "i=2: å¶æ•°é•·å±•é–‹",
          desc: 'expand(2, 3) ã§ "b" ã¨ "a" ã‹ã‚‰å±•é–‹ã€‚s[2] â‰  s[3] ãªã®ã§å³åº§ã«çµ‚äº†ã€‚æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_even",
            s: "babad",
            i: 2,
            l: 2,
            r: 3,
            best_l: 0,
            best_r: 2,
            updated: false,
            match: false,
          },
        },
        {
          step: 8,
          title: "i=3: å¥‡æ•°é•·å±•é–‹",
          desc: 'expand(3, 3) ã§ "a" ã‹ã‚‰å±•é–‹ã€‚å·¦å³ã«æ‹¡å¼µã§ããªã„ãŸã‚ l=3, r=3ã€‚é•·ã•1ãªã®ã§æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_odd",
            s: "babad",
            i: 3,
            l: 3,
            r: 3,
            best_l: 0,
            best_r: 2,
            updated: false,
          },
        },
        {
          step: 9,
          title: "i=3: å¶æ•°é•·å±•é–‹",
          desc: 'expand(3, 4) ã§ "a" ã¨ "d" ã‹ã‚‰å±•é–‹ã€‚s[3] â‰  s[4] ãªã®ã§å³åº§ã«çµ‚äº†ã€‚æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_even",
            s: "babad",
            i: 3,
            l: 3,
            r: 4,
            best_l: 0,
            best_r: 2,
            updated: false,
            match: false,
          },
        },
        {
          step: 10,
          title: "i=4: å¥‡æ•°é•·å±•é–‹",
          desc: 'expand(4, 4) ã§ "d" ã‹ã‚‰å±•é–‹ã€‚å·¦å³ã«æ‹¡å¼µã§ããªã„ãŸã‚ l=4, r=4ã€‚é•·ã•1ãªã®ã§æ›´æ–°ãªã—ã€‚',
          visual: {
            type: "expand_odd",
            s: "babad",
            i: 4,
            l: 4,
            r: 4,
            best_l: 0,
            best_r: 2,
            updated: false,
          },
        },
        {
          step: 11,
          title: "i=4: å¶æ•°é•·å±•é–‹",
          desc: "expand(4, 5) ã§ç¯„å›²å¤–ãªã®ã§å³åº§ã«çµ‚äº†ã€‚æ›´æ–°ãªã—ã€‚",
          visual: {
            type: "expand_even",
            s: "babad",
            i: 4,
            l: 4,
            r: 5,
            best_l: 0,
            best_r: 2,
            updated: false,
            match: false,
            outOfBounds: true,
          },
        },
        {
          step: 12,
          title: "çµæœ",
          desc: 'å…¨ä½ç½®ã®èµ°æŸ»ãŒå®Œäº†ã€‚best_l=0, best_r=2 ã‚ˆã‚Š s[0:3] = "bab" ã‚’è¿”ã™ã€‚',
          visual: {
            type: "result",
            s: "babad",
            best_l: 0,
            best_r: 2,
            result: "bab",
          },
        },
      ];

      function StepVisualization({ visual }) {
        const {
          type,
          s,
          i,
          l,
          r,
          best_l,
          best_r,
          updated,
          match,
          outOfBounds,
          result,
        } = visual;
        const chars = s.split("");
        const n = chars.length;

        const boxWidth = 75;
        const boxHeight = 75;
        const spacing = 90;
        const totalWidth = n * spacing;
        const startX = (600 - totalWidth) / 2 + spacing / 2;

        return (
          <svg
            viewBox="0 0 600 450"
            style={{ maxWidth: "100%", height: "auto", marginTop: "20px" }}
          >
            <defs>
              <marker
                id="arrowPurple"
                markerWidth="10"
                markerHeight="10"
                refX="9"
                refY="3"
                orient="auto"
                markerUnits="strokeWidth"
              >
                <path d="M0,0 L0,6 L9,3 z" fill="#a855f7" />
              </marker>
              <marker
                id="arrowBlue"
                markerWidth="10"
                markerHeight="10"
                refX="9"
                refY="3"
                orient="auto"
                markerUnits="strokeWidth"
              >
                <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6" />
              </marker>
              <marker
                id="arrowGreen"
                markerWidth="10"
                markerHeight="10"
                refX="9"
                refY="3"
                orient="auto"
                markerUnits="strokeWidth"
              >
                <path d="M0,0 L0,6 L9,3 z" fill="#10b981" />
              </marker>
            </defs>

            {/* ã‚¿ã‚¤ãƒˆãƒ« */}
            <text
              x="300"
              y="30"
              textAnchor="middle"
              fontSize="18"
              fontWeight="600"
            >
              {type === "init" && "åˆæœŸçŠ¶æ…‹"}
              {type === "expand_odd" && `ä½ç½® ${i} ã§å¥‡æ•°é•·å±•é–‹`}
              {type === "expand_even" && `ä½ç½® ${i} ã§å¶æ•°é•·å±•é–‹`}
              {type === "result" && "æœ€çµ‚çµæœ"}
            </text>

            {/* æ–‡å­—åˆ—é…åˆ— */}
            {chars.map((char, idx) => {
              let fillColor = "#ffffff";
              let strokeColor = "#cbd5e1";
              let strokeWidth = 2;

              // ç¾åœ¨ã®å±•é–‹ç¯„å›²
              if (
                type !== "init" &&
                type !== "result" &&
                idx >= l &&
                idx <= r &&
                r < n
              ) {
                if (
                  type === "expand_odd" ||
                  (type === "expand_even" && match !== false)
                ) {
                  fillColor = "#ddd6fe";
                  strokeColor = "#a855f7";
                  strokeWidth = 3;
                }
              }

              // bestã®ç¯„å›²
              if (idx >= best_l && idx <= best_r) {
                fillColor = "#d1fae5";
                strokeColor = "#10b981";
                strokeWidth = 3;
              }

              // æ›´æ–°ãŒã‚ã£ãŸå ´åˆ
              if (updated && idx >= l && idx <= r) {
                fillColor = "#fef3c7";
                strokeColor = "#f59e0b";
                strokeWidth = 4;
              }

              return (
                <g key={idx}>
                  <rect
                    x={startX + idx * spacing - boxWidth / 2}
                    y="100"
                    width={boxWidth}
                    height={boxHeight}
                    fill={fillColor}
                    stroke={strokeColor}
                    strokeWidth={strokeWidth}
                    rx="6"
                  />
                  <text
                    x={startX + idx * spacing}
                    y="145"
                    textAnchor="middle"
                    fontSize="18"
                    fontWeight="600"
                  >
                    {char}
                  </text>
                  <text
                    x={startX + idx * spacing}
                    y="200"
                    textAnchor="middle"
                    fontSize="14"
                    fill="#64748b"
                  >
                    {idx}
                  </text>
                </g>
              );
            })}

            {/* ç¾åœ¨ä½ç½® i ã®çŸ¢å° */}
            {type !== "init" && type !== "result" && i !== undefined && (
              <>
                <path
                  d={`M ${startX + i * spacing} 60 L ${
                    startX + i * spacing
                  } 100`}
                  stroke="#3b82f6"
                  strokeWidth="2"
                  fill="none"
                  markerEnd="url(#arrowBlue)"
                />
                <text
                  x={startX + i * spacing}
                  y="50"
                  textAnchor="middle"
                  fontSize="18"
                  fontWeight="600"
                  fill="#3b82f6"
                >
                  i = {i}
                </text>
              </>
            )}

            {/* å±•é–‹ç¯„å›²ã®çŸ¢å°ï¼ˆl, rï¼‰ */}
            {type !== "init" &&
              type !== "result" &&
              l !== undefined &&
              r !== undefined &&
              r < n &&
              !outOfBounds && (
                <>
                  <path
                    d={`M ${startX + l * spacing - 10} 220 L ${
                      startX + l * spacing - 10
                    } 175`}
                    stroke="#a855f7"
                    strokeWidth="2"
                    fill="none"
                    markerEnd="url(#arrowPurple)"
                  />
                  <text
                    x={startX + l * spacing - 10}
                    y="240"
                    textAnchor="middle"
                    fontSize="18"
                    fontWeight="600"
                    fill="#a855f7"
                  >
                    l = {l}
                  </text>

                  <path
                    d={`M ${startX + r * spacing + 10} 240 L ${
                      startX + r * spacing + 10
                    } 175`}
                    stroke="#a855f7"
                    strokeWidth="2"
                    fill="none"
                    markerEnd="url(#arrowPurple)"
                  />
                  <text
                    x={startX + r * spacing + 10}
                    y="260"
                    textAnchor="middle"
                    fontSize="18"
                    fontWeight="600"
                    fill="#a855f7"
                  >
                    r = {r}
                  </text>
                </>
              )}

            {/* bestç¯„å›²ã®è¡¨ç¤º */}
            {(type === "init" || type === "result" || best_l !== undefined) && (
              <>
                <path
                  d={`M ${startX + best_l * spacing - 30} 260 L ${
                    startX + best_l * spacing - 30
                  } 175`}
                  stroke="#10b981"
                  strokeWidth="2"
                  fill="none"
                  markerEnd="url(#arrowGreen)"
                />
                <text
                  x={startX + best_l * spacing - 30}
                  y="280"
                  textAnchor="middle"
                  fontSize="18"
                  fontWeight="600"
                  fill="#10b981"
                >
                  best_l
                </text>

                <path
                  d={`M ${startX + best_r * spacing + 30} 280 L ${
                    startX + best_r * spacing + 30
                  } 175`}
                  stroke="#10b981"
                  strokeWidth="2"
                  fill="none"
                  markerEnd="url(#arrowGreen)"
                />
                <text
                  x={startX + best_r * spacing + 30}
                  y="300"
                  textAnchor="middle"
                  fontSize="18"
                  fontWeight="600"
                  fill="#10b981"
                >
                  best_r
                </text>
              </>
            )}

            {/* èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ */}
            <text
              x="300"
              y="330"
              textAnchor="middle"
              fontSize="18"
              fill="#64748b"
            >
              {type === "init" &&
                `æœ€å°ã®å›æ–‡: s[${best_l}] = "${chars[best_l]}"`}
              {type === "expand_odd" &&
                !updated &&
                !outOfBounds &&
                "ã“ã®å±•é–‹ã§ã¯æ›´æ–°ãªã—"}
              {type === "expand_odd" &&
                updated &&
                `æ–°ã—ã„æœ€é•·å›æ–‡ã‚’ç™ºè¦‹ï¼é•·ã• ${r - l + 1}`}
              {type === "expand_even" &&
                match === false &&
                "æ–‡å­—ãŒä¸€è‡´ã›ãšã€å±•é–‹ã§ããªã„"}
              {type === "expand_even" && outOfBounds && "ç¯„å›²å¤–ã®ãŸã‚å±•é–‹ãªã—"}
              {type === "expand_even" &&
                match !== false &&
                !updated &&
                "ã“ã®å±•é–‹ã§ã¯æ›´æ–°ãªã—"}
              {type === "result" &&
                `æœ€é•·å›æ–‡: "${result}" (é•·ã• ${best_r - best_l + 1})`}
            </text>

            {/* å‡¡ä¾‹ */}
            <g transform="translate(50, 370)">
              <rect
                x="0"
                y="0"
                width="30"
                height="20"
                fill="#d1fae5"
                stroke="#10b981"
                strokeWidth="2"
                rx="3"
              />
              <text x="40" y="15" fontSize="14" fill="#64748b">
                bestç¯„å›²
              </text>

              <rect
                x="150"
                y="0"
                width="30"
                height="20"
                fill="#ddd6fe"
                stroke="#a855f7"
                strokeWidth="2"
                rx="3"
              />
              <text x="190" y="15" fontSize="14" fill="#64748b">
                å±•é–‹ä¸­
              </text>

              <rect
                x="280"
                y="0"
                width="30"
                height="20"
                fill="#fef3c7"
                stroke="#f59e0b"
                strokeWidth="3"
                rx="3"
              />
              <text x="320" y="15" fontSize="14" fill="#64748b">
                æ›´æ–°
              </text>
            </g>
          </svg>
        );
      }

      function StepByStepDemo() {
        const [activeStep, setActiveStep] = useState(1);
        const [isPlaying, setIsPlaying] = useState(false);
        const timerRef = useRef(null);

        useEffect(() => {
          if (isPlaying) {
            if (activeStep >= stepsData.length) {
              setIsPlaying(false);
              setActiveStep(1);
              return;
            }
            timerRef.current = setTimeout(() => {
              setActiveStep((prev) => prev + 1);
            }, 2000);
          }
          return () => {
            if (timerRef.current) clearTimeout(timerRef.current);
          };
        }, [isPlaying, activeStep]);

        const handlePlay = () => {
          if (isPlaying) return;
          if (activeStep === stepsData.length) {
            setActiveStep(1);
          }
          setIsPlaying(true);
        };

        const handlePrev = () => {
          if (activeStep > 1) {
            setIsPlaying(false);
            setActiveStep(activeStep - 1);
          }
        };

        const handleNext = () => {
          if (activeStep < stepsData.length) {
            setIsPlaying(false);
            setActiveStep(activeStep + 1);
          }
        };

        const handleReset = () => {
          setIsPlaying(false);
          setActiveStep(1);
        };

        const handleStepClick = (step) => {
          setIsPlaying(false);
          setActiveStep(step);
        };

        const currentStepData = stepsData.find((s) => s.step === activeStep);

        return (
          <div className="grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-8 mt-2">
            <div>
              <h3 className="mt-0 mb-4 text-teal-800 text-xl font-semibold">
                ã‚¹ãƒ†ãƒƒãƒ—ä¸€è¦§
              </h3>
              <div className="space-y-2">
                {stepsData.map((step) => {
                  const isActive = activeStep === step.step;
                  return (
                    <button
                      key={step.step}
                      type="button"
                      className={[
                        "w-full text-left text-[0.95rem] rounded-xl border-2 transition cursor-pointer px-4 py-4",
                        "bg-white border-slate-200 hover:border-emerald-500 hover:translate-x-1",
                        isActive
                          ? "bg-[linear-gradient(135deg,#d1fae5,#a7f3d0)] border-emerald-500 shadow-[0_4px_12px_rgba(16,185,129,0.20)]"
                          : "",
                      ].join(" ")}
                      onClick={() => handleStepClick(step.step)}
                      aria-label={`ã‚¹ãƒ†ãƒƒãƒ—${step.step}: ${step.title}`}
                      aria-current={isActive ? "step" : undefined}
                    >
                      <div
                        className={[
                          "font-bold mb-1",
                          isActive ? "text-emerald-900" : "text-teal-800",
                        ].join(" ")}
                      >
                        Step {step.step}: {step.title}
                      </div>
                      <div className="text-slate-500 text-sm mt-1">
                        {step.desc.substring(0, 50)}
                        {step.desc.length > 50 ? "..." : ""}
                      </div>
                    </button>
                  );
                })}
              </div>
            </div>

            <div className="my-auto">
              <div className="rounded-2xl p-8 mt-10 border-2 border-emerald-200 bg-[linear-gradient(135deg,#ecfdf5,#f0f9ff)]">
                <h3 className="mt-0 text-teal-800 text-xl font-semibold">
                  Step {currentStepData.step}: {currentStepData.title}
                </h3>
                <p className="text-slate-600 leading-7">
                  {currentStepData.desc}
                </p>
              </div>

              <StepVisualization visual={currentStepData.visual} />

              <div className="flex flex-wrap justify-center gap-2 mt-1">
                <button
                  type="button"
                  className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(16,185,129,0.30)] bg-[linear-gradient(135deg,#10b981,#059669)]"
                  onClick={handlePlay}
                  disabled={isPlaying}
                  aria-label="è‡ªå‹•å†ç”Ÿ"
                >
                  â–¶ Play
                </button>
                <button
                  type="button"
                  className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(16,185,129,0.30)] bg-[linear-gradient(135deg,#0ea5e9,#0284c7)]"
                  onClick={handlePrev}
                  disabled={activeStep === 1 || isPlaying}
                  aria-label="å‰ã®ã‚¹ãƒ†ãƒƒãƒ—"
                >
                  â—€ Prev
                </button>
                <button
                  type="button"
                  className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(16,185,129,0.30)] bg-[linear-gradient(135deg,#0ea5e9,#0284c7)]"
                  onClick={handleNext}
                  disabled={activeStep === stepsData.length || isPlaying}
                  aria-label="æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—"
                >
                  Next â–¶
                </button>
                <button
                  type="button"
                  className="px-6 py-3 rounded-xl font-semibold text-white transition shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(16,185,129,0.30)] bg-[linear-gradient(135deg,#64748b,#475569)]"
                  onClick={handleReset}
                  aria-label="ãƒªã‚»ãƒƒãƒˆ"
                >
                  â†º Reset
                </button>
              </div>

              <div className="mt-6 p-4 rounded-xl border-2 border-slate-200 bg-slate-50">
                <p className="m-0 text-slate-500 text-sm">
                  <strong>é€²æ—:</strong> Step {activeStep} / {stepsData.length}
                  {isPlaying ? " (è‡ªå‹•å†ç”Ÿä¸­...)" : ""}
                </p>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("react-root"));
      root.render(<StepByStepDemo />);
    </script>
  </body>
</html>
