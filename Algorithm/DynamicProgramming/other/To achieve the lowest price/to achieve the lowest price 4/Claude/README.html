<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>りんご購入最適化問題 - 詳細解析</title>
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
            rel="stylesheet"
        />
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css"
            rel="stylesheet"
        />
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&family=Inter:wght@300;400;500;600;700&display=swap');

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Inter', sans-serif;
                line-height: 1.6;
                color: #e2e8f0;
                background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
                min-height: 100vh;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                padding: 2rem;
            }

            .header {
                text-align: center;
                margin-bottom: 3rem;
                background: linear-gradient(135deg, #3b82f6, #8b5cf6);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            h1 {
                font-size: 2.5rem;
                font-weight: 700;
                margin-bottom: 0.5rem;
            }

            .subtitle {
                font-size: 1.2rem;
                color: #94a3b8;
                font-weight: 400;
            }

            .section {
                background: rgba(30, 41, 59, 0.8);
                border-radius: 16px;
                padding: 2rem;
                margin-bottom: 2rem;
                border: 1px solid rgba(59, 130, 246, 0.1);
                backdrop-filter: blur(10px);
                transition: all 0.3s ease;
            }

            .section:hover {
                border-color: rgba(59, 130, 246, 0.3);
                box-shadow: 0 10px 30px rgba(59, 130, 246, 0.1);
            }

            .section-title {
                font-size: 1.5rem;
                font-weight: 600;
                margin-bottom: 1.5rem;
                color: #3b82f6;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .icon {
                width: 24px;
                height: 24px;
                fill: currentColor;
            }

            .code-container {
                position: relative;
                margin: 1rem 0;
                border-radius: 12px;
                overflow: hidden;
                background: #0f172a;
                border: 1px solid #334155;
                transition: all 0.3s ease;
            }

            .code-container:hover {
                border-color: #3b82f6;
                box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2);
            }

            .code-header {
                background: linear-gradient(90deg, #1e293b, #334155);
                padding: 0.75rem 1rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
                border-bottom: 1px solid #334155;
            }

            .code-title {
                font-size: 0.875rem;
                font-weight: 500;
                color: #94a3b8;
            }

            .copy-button {
                background: rgba(59, 130, 246, 0.1);
                border: 1px solid rgba(59, 130, 246, 0.3);
                color: #3b82f6;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                font-size: 0.75rem;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .copy-button:hover {
                background: rgba(59, 130, 246, 0.2);
                border-color: #3b82f6;
            }

            pre[class*='language-'] {
                font-family: 'Fira Code', monospace !important;
                font-size: 14px;
                line-height: 1.5;
                margin: 0;
                padding: 1.5rem;
                background: #0f172a !important;
                overflow-x: auto;
                position: relative;
            }

            code[class*='language-'] {
                font-family: 'Fira Code', monospace;
                font-feature-settings:
                    'liga' 1,
                    'calt' 1;
            }

            .line-numbers .line-numbers-rows {
                border-right: 2px solid #334155;
                padding-right: 1rem;
                user-select: none;
            }

            .line-numbers-rows > span:before {
                color: #64748b !important;
            }

            /* Prism Tomorrow Night テーマのカスタマイズ */
            .token.comment,
            .token.prolog,
            .token.doctype,
            .token.cdata {
                color: #999988;
                font-style: italic;
            }

            .token.namespace {
                opacity: 0.7;
            }

            .token.string,
            .token.attr-value {
                color: #e6db74;
            }

            .token.punctuation,
            .token.operator {
                color: #f8f8f2;
            }

            .token.entity,
            .token.url,
            .token.symbol,
            .token.number,
            .token.boolean,
            .token.variable,
            .token.constant,
            .token.property,
            .token.regex,
            .token.inserted {
                color: #ae81ff;
            }

            .token.atrule,
            .token.keyword,
            .token.attr-name,
            .language-autohotkey .token.selector {
                color: #f92672;
            }

            .token.function,
            .token.deleted,
            .language-autohotkey .token.tag {
                color: #66d9ef;
            }

            .token.tag,
            .token.selector,
            .language-autohotkey .token.keyword {
                color: #a6e22e;
            }

            .visualization {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 1.5rem;
                margin-top: 2rem;
            }

            .chart-container {
                background: rgba(15, 23, 42, 0.8);
                border-radius: 12px;
                padding: 1.5rem;
                border: 1px solid #334155;
                transition: all 0.3s ease;
            }

            .chart-container:hover {
                border-color: rgba(59, 130, 246, 0.3);
                transform: translateY(-2px);
            }

            .chart-title {
                font-size: 1.1rem;
                font-weight: 600;
                margin-bottom: 1rem;
                color: #f1f5f9;
            }

            .table-container {
                overflow-x: auto;
                border: 1px solid #334155;
                border-radius: 8px;
                margin-top: 1rem;
            }

            .dp-table {
                width: 100%;
                border-collapse: collapse;
                font-family: 'Fira Code', monospace;
                font-size: 0.875rem;
                min-width: 800px;
            }

            .dp-table th,
            .dp-table td {
                padding: 0.75rem 0.5rem;
                text-align: center;
                border: 1px solid #334155;
                transition: background-color 0.2s ease;
            }

            .dp-table th {
                background: #1e293b;
                color: #3b82f6;
                font-weight: 600;
                position: sticky;
                top: 0;
                z-index: 2;
            }

            .dp-table th:first-child {
                position: sticky;
                left: 0;
                z-index: 3;
            }

            .dp-table td {
                background: #0f172a;
                color: #e2e8f0;
            }

            .dp-table td:first-child {
                position: sticky;
                left: 0;
                background: #0f172a;
                z-index: 1;
                border-right: 2px solid #334155;
                font-weight: 600;
            }

            .dp-table .highlight {
                background: #3b82f6 !important;
                color: #ffffff;
                font-weight: 600;
                animation: pulse 2s infinite;
            }

            .dp-table .inf {
                color: #64748b;
                font-style: italic;
            }

            .dp-table tr:hover td {
                background: rgba(59, 130, 246, 0.1);
            }

            @keyframes pulse {
                0%,
                100% {
                    opacity: 1;
                }

                50% {
                    opacity: 0.8;
                }
            }

            .algorithm-step {
                background: rgba(15, 23, 42, 0.6);
                border-radius: 8px;
                padding: 1rem;
                margin: 1rem 0;
                border-left: 4px solid #3b82f6;
                transition: all 0.3s ease;
            }

            .algorithm-step:hover {
                background: rgba(15, 23, 42, 0.8);
                transform: translateX(5px);
            }

            .step-title {
                font-weight: 600;
                color: #3b82f6;
                margin-bottom: 0.5rem;
            }

            .complexity-badge {
                display: inline-block;
                background: linear-gradient(135deg, #059669, #0d9488);
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.875rem;
                font-weight: 500;
                margin: 0.25rem;
                transition: all 0.3s ease;
            }

            .complexity-badge:hover {
                transform: scale(1.05);
                box-shadow: 0 5px 15px rgba(5, 150, 105, 0.3);
            }

            .interactive-button {
                background: linear-gradient(135deg, #3b82f6, #1d4ed8);
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                margin: 0.5rem;
                position: relative;
                overflow: hidden;
            }

            .interactive-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            }

            .interactive-button:before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 255, 255, 0.2),
                    transparent
                );
                transition: left 0.5s;
            }

            .interactive-button:hover:before {
                left: 100%;
            }

            .complexity-analysis {
                margin-top: 1rem;
            }

            .complexity-item {
                margin-bottom: 1rem;
                padding: 1rem;
                background: rgba(15, 23, 42, 0.6);
                border-radius: 8px;
                border-left: 3px solid #10b981;
                transition: all 0.3s ease;
            }

            .complexity-item:hover {
                background: rgba(15, 23, 42, 0.8);
                transform: translateX(5px);
            }

            .complexity-item h5 {
                color: #10b981;
                margin-bottom: 0.5rem;
                font-size: 1.1rem;
            }

            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }

                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .animate-in {
                animation: fadeInUp 0.6s ease-out;
            }

            /* レスポンシブ対応 */
            @media (max-width: 768px) {
                .container {
                    padding: 1rem;
                }

                h1 {
                    font-size: 2rem;
                }

                .section {
                    padding: 1.5rem;
                }

                .visualization {
                    grid-template-columns: 1fr;
                }

                pre[class*='language-'] {
                    font-size: 12px;
                    padding: 1rem;
                }
            }
        </style>
    </head>

    <body>
        <div class="container">
            <div class="header animate-in">
                <h1>りんご購入最適化問題</h1>
                <p class="subtitle">動的プログラミングを用いた詳細解析と可視化</p>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    問題概要
                </div>
                <div class="algorithm-step">
                    <div class="step-title">目的</div>
                    <p>
                        3種類のりんごセット（x個/a円、y個/b円、z個/c円）を使って、n個以上のりんごを最小コストで購入する
                    </p>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">制約条件</div>
                    <ul style="margin-left: 1.5rem; color: #94a3b8">
                        <li>1 ≤ n ≤ 1,000</li>
                        <li>1 ≤ x < y < z ≤ 1,000</li>
                        <li>1 ≤ a < b < c ≤ 10,000</li>
                        <li>購入したりんごがn+1個以上になってもよい</li>
                    </ul>
                </div>
                <div>
                    <span class="complexity-badge">時間計算量: O(n × max(x,y,z))</span>
                    <span class="complexity-badge">空間計算量: O(n + max(x,y,z))</span>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
                    </svg>
                    JavaScript実装コード
                </div>
                <div class="code-container">
                    <div class="code-header">
                        <span class="code-title">minCostForApples.js</span>
                        <button class="copy-button" onclick="copyCode()">Copy</button>
                    </div>
                    <pre class="line-numbers"><code class="language-javascript">/**
 * n個以上のりんごを最小コストで購入するための金額を計算する
 * 動的プログラミングを使用して効率的に解を求める
 */
function minCostForApples(n, x, a, y, b, z, c) {
    // 効率的な上限を設定（計算量とメモリ使用量を最適化）
    const maxApples = n + Math.max(x, y, z) - 1;
    
    // DPテーブルを初期化（Int32Arrayの範囲内でINFを設定）
    const INF = 2147483647; // Int32Arrayの最大値
    const dp = new Int32Array(maxApples + 1);
    dp.fill(INF);
    dp[0] = 0; // 0個の場合はコスト0
    
    // 動的プログラミングで最小コストを計算
    for (let i = 0; i <= maxApples; i++) {
        if (dp[i] === INF) continue;
        
        const currentCost = dp[i];
        
        // セット1（x個でa円）を使う場合
        if (i + x <= maxApples) {
            dp[i + x] = Math.min(dp[i + x], currentCost + a);
        }
        
        // セット2（y個でb円）を使う場合
        if (i + y <= maxApples) {
            dp[i + y] = Math.min(dp[i + y], currentCost + b);
        }
        
        // セット3（z個でc円）を使う場合
        if (i + z <= maxApples) {
            dp[i + z] = Math.min(dp[i + z], currentCost + c);
        }
    }
    
    // n個以上のりんごを手に入れる最小コストを求める
    let minCost = INF;
    for (let i = n; i <= maxApples; i++) {
        if (dp[i] < minCost) {
            minCost = dp[i];
        }
    }
    
    return minCost;
}</code></pre>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path
                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                        />
                    </svg>
                    動的プログラミングの処理流れ
                </div>
                <div class="algorithm-step">
                    <div class="step-title">Step 1: 初期化</div>
                    <p><code>dp[0] = 0</code>（0個のりんごを手に入れるコストは0円）</p>
                    <p>他の全ての要素は<code>INF</code>で初期化</p>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">Step 2: 状態遷移</div>
                    <p>各状態 <code>i</code> から3つのセット購入を試行:</p>
                    <ul style="margin-left: 1.5rem; color: #94a3b8">
                        <li><code>dp[i+x] = min(dp[i+x], dp[i] + a)</code></li>
                        <li><code>dp[i+y] = min(dp[i+y], dp[i] + b)</code></li>
                        <li><code>dp[i+z] = min(dp[i+z], dp[i] + c)</code></li>
                    </ul>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">Step 3: 最適解の探索</div>
                    <p><code>dp[n]</code>から<code>dp[maxApples]</code>までの最小値を求める</p>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path
                            d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"
                        />
                    </svg>
                    実行例解析 (n=9, x=2/a=100, y=3/b=125, z=5/c=200)
                </div>

                <div class="visualization">
                    <div class="chart-container">
                        <div class="chart-title">DPテーブルの変化過程</div>
                        <div class="table-container">
                            <table class="dp-table">
                                <thead>
                                    <tr>
                                        <th>個数</th>
                                        <th>0</th>
                                        <th>2</th>
                                        <th>3</th>
                                        <th>4</th>
                                        <th>5</th>
                                        <th>6</th>
                                        <th>7</th>
                                        <th>8</th>
                                        <th>9</th>
                                        <th>10</th>
                                        <th>11</th>
                                        <th>12</th>
                                        <th>13</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>初期</td>
                                        <td class="highlight">0</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                    </tr>
                                    <tr>
                                        <td>i=0後</td>
                                        <td>0</td>
                                        <td class="highlight">100</td>
                                        <td class="highlight">125</td>
                                        <td class="inf">∞</td>
                                        <td class="highlight">200</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                    </tr>
                                    <tr>
                                        <td>i=2後</td>
                                        <td>0</td>
                                        <td>100</td>
                                        <td>125</td>
                                        <td class="highlight">200</td>
                                        <td>200</td>
                                        <td class="highlight">225</td>
                                        <td class="inf">∞</td>
                                        <td class="highlight">300</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                    </tr>
                                    <tr>
                                        <td>i=3後</td>
                                        <td>0</td>
                                        <td>100</td>
                                        <td>125</td>
                                        <td>200</td>
                                        <td>200</td>
                                        <td>225</td>
                                        <td class="highlight">250</td>
                                        <td class="highlight">300</td>
                                        <td class="highlight">325</td>
                                        <td class="highlight">250</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                        <td class="inf">∞</td>
                                    </tr>
                                    <tr>
                                        <td>最終</td>
                                        <td>0</td>
                                        <td>100</td>
                                        <td>125</td>
                                        <td>200</td>
                                        <td>200</td>
                                        <td>225</td>
                                        <td>250</td>
                                        <td>300</td>
                                        <td>325</td>
                                        <td>250</td>
                                        <td>350</td>
                                        <td>350</td>
                                        <td class="highlight">375</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">最適解の導出過程</div>
                        <div class="algorithm-step">
                            <div class="step-title">セット選択肢の比較</div>
                            <ul style="color: #94a3b8; margin-left: 1rem">
                                <li>セット1のみ: 2個×5回 = 10個, 500円</li>
                                <li>セット2のみ: 3個×3回 = 9個, 375円 ✓</li>
                                <li>セット3のみ: 5個×2回 = 10個, 400円</li>
                                <li>混合パターン: より高コスト</li>
                            </ul>
                        </div>
                        <div class="algorithm-step">
                            <div class="step-title">結果</div>
                            <p style="font-size: 1.2rem; color: #3b82f6; font-weight: 600">
                                最小コスト: 375円 (セット2を3回購入)
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    メモリ効率化のポイント
                </div>
                <div class="algorithm-step">
                    <div class="step-title">Int32Array使用の利点</div>
                    <ul style="margin-left: 1.5rem; color: #94a3b8">
                        <li>通常のArray比で約50%のメモリ削減</li>
                        <li>高速なメモリアクセス</li>
                        <li>固定サイズによる予測可能な性能</li>
                    </ul>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">注意事項</div>
                    <p>INF値は<code>2147483647</code>（2³¹-1）に設定してオーバーフローを防止</p>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                    </svg>
                    詳細アルゴリズム実行ログ
                </div>
                <button class="interactive-button" onclick="visualizeAlgorithm()">
                    詳細実行ログを表示
                </button>
                <div id="algorithmVisualization" style="margin-top: 1rem"></div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path
                            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                        />
                    </svg>
                    アルゴリズム複雑度分析
                </div>
                <div class="complexity-analysis">
                    <div class="complexity-item">
                        <h5>時間計算量: O(n × max(x,y,z))</h5>
                        <p style="color: #94a3b8; margin-top: 0.5rem">
                            外側ループ: O(n + max(x,y,z)) ≈ O(n)<br />
                            内側処理: O(1) × 3回の遷移チェック<br />
                            総計算量: O(n × max(x,y,z))
                        </p>
                    </div>

                    <div class="complexity-item">
                        <h5>空間計算量: O(n + max(x,y,z))</h5>
                        <p style="color: #94a3b8; margin-top: 0.5rem">
                            DPテーブル: O(n + max(x,y,z))のInt32Array<br />
                            補助変数: O(1)<br />
                            総メモリ使用量: O(n + max(x,y,z))
                        </p>
                    </div>

                    <div class="complexity-item">
                        <h5>最適化のポイント</h5>
                        <ul style="color: #94a3b8; margin-top: 0.5rem; margin-left: 1rem">
                            <li>Int32Arrayによる高速メモリアクセス</li>
                            <li>INF値の適切な設定でオーバーフロー回避</li>
                            <li>早期終了条件による不要な計算の削減</li>
                            <li>キャッシュフレンドリーな順次アクセスパターン</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path
                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                        />
                    </svg>
                    パフォーマンス分析
                </div>
                <div class="visualization">
                    <div class="chart-container">
                        <div class="chart-title">実行時間 vs 問題サイズ</div>
                        <canvas
                            id="performanceChart"
                            width="400"
                            height="300"
                            style="background: #0f172a; border-radius: 8px"
                        ></canvas>
                        <button
                            class="interactive-button"
                            onclick="drawPerformanceChart()"
                            style="margin-top: 1rem"
                        >
                            パフォーマンスチャート描画
                        </button>
                    </div>

                    <div class="chart-container">
                        <div class="chart-title">ベンチマーク結果</div>
                        <div id="benchmarkResults">
                            <div class="algorithm-step">
                                <div class="step-title">テストケース実行結果</div>
                                <table class="dp-table" style="font-size: 0.8rem">
                                    <thead>
                                        <tr>
                                            <th>n</th>
                                            <th>結果</th>
                                            <th>時間(ms)</th>
                                            <th>メモリ(KB)</th>
                                        </tr>
                                    </thead>
                                    <tbody id="benchmarkTableBody">
                                        <tr>
                                            <td
                                                colspan="4"
                                                style="text-align: center; color: #94a3b8"
                                            >
                                                テストを実行してください
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button
                                    class="interactive-button"
                                    onclick="runBenchmark()"
                                    style="margin-top: 1rem"
                                >
                                    ベンチマーク実行
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section animate-in">
                <div class="section-title">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path
                            d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                        />
                    </svg>
                    学習リソースと参考資料
                </div>
                <div class="algorithm-step">
                    <div class="step-title">動的プログラミングの理論</div>
                    <ul style="color: #94a3b8; margin-left: 1rem">
                        <li>
                            <strong>最適部分構造</strong>: 部分問題の最適解から全体の最適解を構築
                        </li>
                        <li><strong>重複する部分問題</strong>: 同じ部分問題を何度も解く必要性</li>
                        <li><strong>メモ化</strong>: 計算結果をテーブルに保存して再利用</li>
                    </ul>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">実装のベストプラクティス</div>
                    <ul style="color: #94a3b8; margin-left: 1rem">
                        <li>適切なデータ構造の選択（TypedArray vs 通常のArray）</li>
                        <li>境界値の適切な処理</li>
                        <li>オーバーフロー対策</li>
                        <li>メモリ効率とパフォーマンスのバランス</li>
                    </ul>
                </div>
                <div class="algorithm-step">
                    <div class="step-title">類似問題</div>
                    <ul style="color: #94a3b8; margin-left: 1rem">
                        <li>コイン問題（Coin Change Problem）</li>
                        <li>ナップサック問題の変形</li>
                        <li>最小コスト経路問題</li>
                        <li>組み合わせ最適化問題</li>
                    </ul>
                </div>
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

        <script>
            function minCostForApples(n, x, a, y, b, z, c) {
                const maxApples = n + Math.max(x, y, z) - 1;
                const INF = 2147483647;
                const dp = new Int32Array(maxApples + 1);
                dp.fill(INF);
                dp[0] = 0;

                for (let i = 0; i <= maxApples; i++) {
                    if (dp[i] === INF) continue;

                    const currentCost = dp[i];

                    if (i + x <= maxApples) {
                        dp[i + x] = Math.min(dp[i + x], currentCost + a);
                    }

                    if (i + y <= maxApples) {
                        dp[i + y] = Math.min(dp[i + y], currentCost + b);
                    }

                    if (i + z <= maxApples) {
                        dp[i + z] = Math.min(dp[i + z], currentCost + c);
                    }
                }

                let minCost = INF;
                for (let i = n; i <= maxApples; i++) {
                    if (dp[i] < minCost) {
                        minCost = dp[i];
                    }
                }

                return minCost;
            }

            function copyCode() {
                const codeElement = document.querySelector('code.language-javascript');
                const codeText = codeElement.textContent;

                navigator.clipboard
                    .writeText(codeText)
                    .then(() => {
                        const button = document.querySelector('.copy-button');
                        const originalText = button.textContent;
                        button.textContent = 'Copied!';
                        button.style.background = 'rgba(16, 185, 129, 0.2)';
                        button.style.borderColor = '#10b981';
                        button.style.color = '#10b981';

                        setTimeout(() => {
                            button.textContent = originalText;
                            button.style.background = 'rgba(59, 130, 246, 0.1)';
                            button.style.borderColor = 'rgba(59, 130, 246, 0.3)';
                            button.style.color = '#3b82f6';
                        }, 2000);
                    })
                    .catch(() => {
                        alert('コードのコピーに失敗しました');
                    });
            }

            function detailedDPSimulation() {
                const n = 9,
                    x = 2,
                    a = 100,
                    y = 3,
                    b = 125,
                    z = 5,
                    c = 200;
                const maxApples = n + Math.max(x, y, z) - 1;
                const INF = 2147483647;
                const dp = new Array(maxApples + 1).fill(INF);
                dp[0] = 0;

                const steps = [];

                for (let i = 0; i <= maxApples; i++) {
                    if (dp[i] === INF) continue;

                    const stepInfo = {
                        iteration: i,
                        currentState: [...dp],
                        transitions: [],
                    };

                    if (i + x <= maxApples) {
                        const oldValue = dp[i + x];
                        const newValue = Math.min(dp[i + x], dp[i] + a);
                        if (newValue < oldValue) {
                            stepInfo.transitions.push({
                                type: 'セット1',
                                from: i,
                                to: i + x,
                                cost: a,
                                oldValue: oldValue === INF ? '∞' : oldValue,
                                newValue: newValue,
                            });
                            dp[i + x] = newValue;
                        }
                    }

                    if (i + y <= maxApples) {
                        const oldValue = dp[i + y];
                        const newValue = Math.min(dp[i + y], dp[i] + b);
                        if (newValue < oldValue) {
                            stepInfo.transitions.push({
                                type: 'セット2',
                                from: i,
                                to: i + y,
                                cost: b,
                                oldValue: oldValue === INF ? '∞' : oldValue,
                                newValue: newValue,
                            });
                            dp[i + y] = newValue;
                        }
                    }

                    if (i + z <= maxApples) {
                        const oldValue = dp[i + z];
                        const newValue = Math.min(dp[i + z], dp[i] + c);
                        if (newValue < oldValue) {
                            stepInfo.transitions.push({
                                type: 'セット3',
                                from: i,
                                to: i + z,
                                cost: c,
                                oldValue: oldValue === INF ? '∞' : oldValue,
                                newValue: newValue,
                            });
                            dp[i + z] = newValue;
                        }
                    }

                    if (stepInfo.transitions.length > 0) {
                        steps.push(stepInfo);
                    }
                }

                return steps;
            }

            function visualizeAlgorithm() {
                const resultDiv = document.getElementById('algorithmVisualization');
                if (!resultDiv) return;

                try {
                    const steps = detailedDPSimulation();

                    let html = '<div class="algorithm-visualization">';
                    html +=
                        '<h3 style="color: #3b82f6; margin-bottom: 1rem;">動的プログラミング詳細実行ログ</h3>';

                    steps.forEach((step, index) => {
                        html += `<div class="algorithm-step" style="margin-bottom: 1rem;">`;
                        html += `<div style="font-weight: 600; color: #3b82f6;">ステップ ${index + 1}: i = ${step.iteration}</div>`;

                        step.transitions.forEach((trans) => {
                            html += `<div style="margin: 0.5rem 0; color: #e2e8f0;">`;
                            html += `${trans.type}: dp[${trans.from}] + ${trans.cost} = ${step.currentState[trans.from] + trans.cost} → `;
                            html += `dp[${trans.to}] = min(${trans.oldValue}, ${trans.newValue}) = <span style="color: #10b981; font-weight: 600;">${trans.newValue}</span>`;
                            html += `</div>`;
                        });

                        html += '</div>';
                    });

                    html += '</div>';
                    resultDiv.innerHTML = html;
                } catch (error) {
                    resultDiv.innerHTML = `<div style="color: #ef4444;">可視化エラー: ${error.message}</div>`;
                }
            }

            function performanceAnalysis() {
                const testCases = [
                    { n: 10, x: 2, a: 100, y: 3, b: 150, z: 5, c: 200 },
                    { n: 100, x: 5, a: 300, y: 10, b: 500, z: 20, c: 900 },
                    { n: 500, x: 10, a: 1000, y: 25, b: 2000, z: 50, c: 3500 },
                    { n: 1000, x: 20, a: 2000, y: 50, b: 4000, z: 100, c: 7000 },
                ];

                const results = testCases.map((testCase) => {
                    const startTime = performance.now();
                    const startMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;

                    const result = minCostForApples(
                        testCase.n,
                        testCase.x,
                        testCase.a,
                        testCase.y,
                        testCase.b,
                        testCase.z,
                        testCase.c,
                    );

                    const endTime = performance.now();
                    const endMemory = performance.memory ? performance.memory.usedJSHeapSize : 0;

                    return {
                        ...testCase,
                        result,
                        executionTime: (endTime - startTime).toFixed(3),
                        memoryUsed: Math.max(0, (endMemory - startMemory) / 1024).toFixed(2),
                    };
                });

                return results;
            }

            function drawPerformanceChart() {
                const canvas = document.getElementById('performanceChart');
                if (!canvas) return;

                try {
                    const ctx = canvas.getContext('2d');
                    const results = performanceAnalysis();

                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    const padding = 60;
                    const chartWidth = canvas.width - 2 * padding;
                    const chartHeight = canvas.height - 2 * padding;

                    ctx.strokeStyle = '#94a3b8';
                    ctx.lineWidth = 1;

                    ctx.beginPath();
                    ctx.moveTo(padding, canvas.height - padding);
                    ctx.lineTo(canvas.width - padding, canvas.height - padding);
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(padding, padding);
                    ctx.lineTo(padding, canvas.height - padding);
                    ctx.stroke();

                    const maxTime = Math.max(...results.map((r) => parseFloat(r.executionTime)));
                    const maxN = Math.max(...results.map((r) => r.n));

                    if (maxTime > 0 && maxN > 0) {
                        ctx.fillStyle = '#3b82f6';
                        results.forEach((result, index) => {
                            const x = padding + (result.n / maxN) * chartWidth;
                            const y =
                                canvas.height -
                                padding -
                                (parseFloat(result.executionTime) / maxTime) * chartHeight;

                            ctx.beginPath();
                            ctx.arc(x, y, 4, 0, 2 * Math.PI);
                            ctx.fill();

                            ctx.fillStyle = '#e2e8f0';
                            ctx.font = '12px Fira Code';
                            ctx.fillText(`n=${result.n}`, x - 20, y - 10);
                            ctx.fillText(`${result.executionTime}ms`, x - 25, y + 20);
                            ctx.fillStyle = '#3b82f6';
                        });
                    }

                    ctx.fillStyle = '#f1f5f9';
                    ctx.font = '14px Inter';
                    ctx.fillText('実行時間 vs 問題サイズ', canvas.width / 2 - 80, 30);

                    ctx.font = '12px Inter';
                    ctx.fillText('問題サイズ (n)', canvas.width / 2 - 30, canvas.height - 20);

                    ctx.save();
                    ctx.translate(20, canvas.height / 2);
                    ctx.rotate(-Math.PI / 2);
                    ctx.fillText('実行時間 (ms)', -50, 0);
                    ctx.restore();
                } catch (error) {
                    console.error('Chart drawing error:', error);
                }
            }

            function runBenchmark() {
                const tbody = document.getElementById('benchmarkTableBody');
                if (!tbody) return;

                try {
                    const results = performanceAnalysis();

                    tbody.innerHTML = results
                        .map(
                            (result) => `
                    <tr>
                        <td>${result.n}</td>
                        <td>${result.result}</td>
                        <td>${result.executionTime}</td>
                        <td>${result.memoryUsed}</td>
                    </tr>
                `,
                        )
                        .join('');
                } catch (error) {
                    tbody.innerHTML = `<tr><td colspan="4" style="color: #ef4444; text-align: center;">ベンチマークエラー: ${error.message}</td></tr>`;
                }
            }

            // アニメーション効果
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px',
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-in');
                    }
                });
            }, observerOptions);

            document.addEventListener('DOMContentLoaded', () => {
                const sections = document.querySelectorAll('.section');
                sections.forEach((section) => {
                    observer.observe(section);
                });

                // Prismの初期化
                if (typeof Prism !== 'undefined') {
                    Prism.highlightAll();
                }
            });
        </script>
    </body>
</html>
