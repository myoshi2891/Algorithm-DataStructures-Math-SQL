<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>BIT (Binary Indexed Tree) è©³ç´°è§£æ</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #333;
            }

            .container {
                background: rgba(255, 255, 255, 0.95);
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            }

            h1 {
                text-align: center;
                color: #2c3e50;
                font-size: 2.5em;
                margin-bottom: 30px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }

            h2 {
                color: #34495e;
                border-bottom: 3px solid #3498db;
                padding-bottom: 10px;
                margin-top: 40px;
            }

            h3 {
                color: #2980b9;
                margin-top: 30px;
            }

            .array-visual {
                display: flex;
                gap: 5px;
                margin: 20px 0;
                justify-content: center;
                flex-wrap: wrap;
            }

            .array-cell {
                width: 50px;
                height: 50px;
                border: 2px solid #3498db;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(45deg, #74b9ff, #0984e3);
                color: white;
                font-weight: bold;
                border-radius: 8px;
                position: relative;
                transition: all 0.3s ease;
            }

            .array-cell:hover {
                transform: scale(1.1);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .array-cell .index {
                position: absolute;
                bottom: -25px;
                font-size: 12px;
                color: #666;
            }

            .bit-tree {
                margin: 30px 0;
                text-align: center;
            }

            .tree-level {
                display: flex;
                justify-content: center;
                margin: 20px 0;
                gap: 20px;
            }

            .tree-node {
                width: 60px;
                height: 60px;
                border: 3px solid #e74c3c;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(45deg, #fd79a8, #e84393);
                color: white;
                font-weight: bold;
                position: relative;
                transition: all 0.3s ease;
            }

            .tree-node:hover {
                transform: scale(1.2);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            }

            .tree-node .node-label {
                position: absolute;
                bottom: -30px;
                font-size: 12px;
                color: #333;
                white-space: nowrap;
            }

            .step-by-step {
                background: linear-gradient(135deg, #a8edea, #fed6e3);
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
                border-left: 5px solid #00b894;
            }

            .code-block {
                background: #2d3748;
                color: #e2e8f0;
                padding: 15px;
                border-radius: 8px;
                font-family: 'Consolas', 'Monaco', monospace;
                margin: 15px 0;
                overflow-x: auto;
            }

            .highlight {
                background: #fff3cd;
                padding: 2px 6px;
                border-radius: 4px;
                border-left: 4px solid #ffc107;
            }

            .update-path {
                display: flex;
                align-items: center;
                gap: 10px;
                margin: 10px 0;
                justify-content: center;
                flex-wrap: wrap;
            }

            .path-node {
                width: 40px;
                height: 40px;
                border: 2px solid #28a745;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                background: linear-gradient(45deg, #55efc4, #00b894);
                color: white;
                font-weight: bold;
            }

            .arrow {
                font-size: 20px;
                color: #e74c3c;
                font-weight: bold;
            }

            .binary-representation {
                font-family: 'Consolas', 'Monaco', monospace;
                background: #f8f9fa;
                padding: 10px;
                border-radius: 5px;
                margin: 10px 0;
                border: 1px solid #dee2e6;
            }

            .complexity-box {
                background: linear-gradient(135deg, #ffeaa7, #fab1a0);
                border: 2px solid #e17055;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
            }

            .example-section {
                background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
                border-radius: 10px;
                padding: 25px;
                margin: 25px 0;
                border: 2px solid #8b5cf6;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                background: white;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }

            th,
            td {
                border: 1px solid #ddd;
                padding: 12px;
                text-align: center;
            }

            th {
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                font-weight: bold;
            }

            tr:nth-child(even) {
                background: #f8f9fa;
            }

            tr:hover {
                background: #e3f2fd;
                transform: scale(1.02);
                transition: all 0.2s ease;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>ğŸŒ³ BIT (Binary Indexed Tree) è©³ç´°è§£æ</h1>

            <h2>1. BITã®åŸºæœ¬æ¦‚å¿µ</h2>
            <p>Binary Indexed Tree (BIT) / Fenwick Treeã¯ã€é…åˆ—ã®<strong>åŒºé–“å’Œã‚¯ã‚¨ãƒª</strong>ã¨<strong>ä¸€ç‚¹æ›´æ–°</strong>ã‚’åŠ¹ç‡çš„ã«è¡Œã†ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚</p>

            <div class="step-by-step">
                <h3>ğŸ¯ ä¸»ãªç‰¹å¾´</h3>
                <ul>
                    <li><strong>æ™‚é–“è¨ˆç®—é‡</strong>: æ›´æ–°ãƒ»ã‚¯ã‚¨ãƒªã¨ã‚‚ã«O(log n)</li>
                    <li><strong>ç©ºé–“è¨ˆç®—é‡</strong>: O(n)</li>
                    <li><strong>å®Ÿè£…</strong>: ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã‚ˆã‚Šç°¡æ½”</li>
                </ul>
            </div>

            <h2>2. é…åˆ—ã‹ã‚‰BITã¸ã®å¤‰æ›</h2>
            <h3>ğŸ“Š å…ƒã®é…åˆ— A = [1, 5, 7, 9, 8, 6]</h3>

            <div class="array-visual">
                <div class="array-cell">
                    1
                    <div class="index">A[1]</div>
                </div>
                <div class="array-cell">
                    5
                    <div class="index">A[2]</div>
                </div>
                <div class="array-cell">
                    7
                    <div class="index">A[3]</div>
                </div>
                <div class="array-cell">
                    9
                    <div class="index">A[4]</div>
                </div>
                <div class="array-cell">
                    8
                    <div class="index">A[5]</div>
                </div>
                <div class="array-cell">
                    6
                    <div class="index">A[6]</div>
                </div>
            </div>

            <h3>ğŸ”„ BITæ§‹ç¯‰ãƒ—ãƒ­ã‚»ã‚¹</h3>
            <div class="step-by-step">
                <p>å„BIT[i]ã¯ã€<span class="highlight">ç‰¹å®šã®ç¯„å›²ã®è¦ç´ ã®åˆè¨ˆ</span>ã‚’æ ¼ç´ã—ã¾ã™ã€‚</p>

                <table>
                    <tr>
                        <th>BIT Index</th>
                        <th>ãƒã‚¤ãƒŠãƒª</th>
                        <th>æ‹…å½“ç¯„å›²</th>
                        <th>è¨ˆç®—</th>
                        <th>å€¤</th>
                    </tr>
                    <tr>
                        <td>BIT[1]</td>
                        <td>001</td>
                        <td>A[1]</td>
                        <td>1</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td>BIT[2]</td>
                        <td>010</td>
                        <td>A[1] + A[2]</td>
                        <td>1 + 5</td>
                        <td>6</td>
                    </tr>
                    <tr>
                        <td>BIT[3]</td>
                        <td>011</td>
                        <td>A[3]</td>
                        <td>7</td>
                        <td>7</td>
                    </tr>
                    <tr>
                        <td>BIT[4]</td>
                        <td>100</td>
                        <td>A[1] + A[2] + A[3] + A[4]</td>
                        <td>1 + 5 + 7 + 9</td>
                        <td>22</td>
                    </tr>
                    <tr>
                        <td>BIT[5]</td>
                        <td>101</td>
                        <td>A[5]</td>
                        <td>8</td>
                        <td>8</td>
                    </tr>
                    <tr>
                        <td>BIT[6]</td>
                        <td>110</td>
                        <td>A[5] + A[6]</td>
                        <td>8 + 6</td>
                        <td>14</td>
                    </tr>
                </table>
            </div>

            <h3>ğŸŒ² BITæ§‹é€ ã®å¯è¦–åŒ–</h3>
            <div class="bit-tree">
                <div class="tree-level">
                    <div class="tree-node">
                        22
                        <div class="node-label">BIT[4]</div>
                    </div>
                </div>
                <div class="tree-level">
                    <div class="tree-node">
                        6
                        <div class="node-label">BIT[2]</div>
                    </div>
                    <div class="tree-node">
                        14
                        <div class="node-label">BIT[6]</div>
                    </div>
                </div>
                <div class="tree-level">
                    <div class="tree-node">
                        1
                        <div class="node-label">BIT[1]</div>
                    </div>
                    <div class="tree-node">
                        7
                        <div class="node-label">BIT[3]</div>
                    </div>
                    <div class="tree-node">
                        8
                        <div class="node-label">BIT[5]</div>
                    </div>
                </div>
            </div>

            <h2>3. LSB (æœ€ä¸‹ä½ãƒ“ãƒƒãƒˆ) ã®é‡è¦æ€§</h2>
            <div class="step-by-step">
                <h3>ğŸ”§ LSBè¨ˆç®—å¼: <code>idx & (-idx)</code></h3>

                <div class="binary-representation">
                    <strong>ä¾‹ï¼šidx = 6 ã®å ´åˆ</strong><br>
                    6 (binary): 110<br>
                    -6 (binary): ...11111010 (2ã®è£œæ•°)<br>
                    6 & (-6) = 110 & ...11111010 = 010 = 2
                </div>

                <p><span class="highlight">LSBã¯ã€ãã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒæ‹…å½“ã™ã‚‹ç¯„å›²ã®å¤§ãã•</span>ã‚’ç¤ºã—ã¾ã™ã€‚</p>
            </div>

            <h2>4. ä¸€ç‚¹æ›´æ–°ã®è©³ç´°ãƒ—ãƒ­ã‚»ã‚¹</h2>
            <div class="example-section">
                <h3>ğŸ“ ä¾‹ï¼šA[5]ã«10ã‚’åŠ ç®—ã™ã‚‹å ´åˆ</h3>

                <div class="step-by-step">
                    <h4>ğŸ›¤ï¸ æ›´æ–°ãƒ‘ã‚¹è¨ˆç®—</h4>
                    <p>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹5ã‹ã‚‰é–‹å§‹ã—ã¦ã€LSBã‚’åŠ ç®—ã—ãªãŒã‚‰é€²ã‚€ï¼š</p>

                    <div class="update-path">
                        <div class="path-node">5</div>
                        <div class="arrow">â†’</div>
                        <div class="path-node">6</div>
                        <div class="arrow">â†’</div>
                        <div class="path-node">8</div>
                    </div>

                    <div class="binary-representation">
                        <strong>è¨ˆç®—éç¨‹ï¼š</strong><br>
                        5 (101) â†’ 5 + (5 & -5) = 5 + 1 = 6<br>
                        6 (110) â†’ 6 + (6 & -6) = 6 + 2 = 8<br>
                        8 > 6 ãªã®ã§çµ‚äº†
                    </div>
                </div>

                <h4>ğŸ“Š æ›´æ–°å‰å¾Œã®æ¯”è¼ƒ</h4>
                <table>
                    <tr>
                        <th>BITã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</th>
                        <th>æ›´æ–°å‰</th>
                        <th>æ›´æ–°å¾Œ</th>
                        <th>å¤‰åŒ–</th>
                    </tr>
                    <tr style="background: #ffebee;">
                        <td>BIT[5]</td>
                        <td>8</td>
                        <td>18</td>
                        <td>+10</td>
                    </tr>
                    <tr style="background: #ffebee;">
                        <td>BIT[6]</td>
                        <td>14</td>
                        <td>24</td>
                        <td>+10</td>
                    </tr>
                    <tr>
                        <td>ãã®ä»–</td>
                        <td>å¤‰æ›´ãªã—</td>
                        <td>å¤‰æ›´ãªã—</td>
                        <td>0</td>
                    </tr>
                </table>
            </div>

            <h2>5. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…è§£æ</h2>

            <h3>ğŸ—ï¸ BITæ§‹ç¯‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
            <div class="code-block">
                function buildBIT(A) {
                const n = A.length;
                const BIT = new Array(n + 1).fill(0);

                for (let i = 1; i <= n; i++) { let idx=i; while (idx <=n) { BIT[idx] +=A[i - 1]; idx +=idx & (-idx); // LSBåŠ ç®— } } return BIT; } </div>

                    <h3>ğŸ”„ ä¸€ç‚¹æ›´æ–°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
                    <div class="code-block">
                        function updateBIT(BIT, pos, val) {
                        let idx = pos;
                        while (idx <= BIT.length - 1) { BIT[idx] +=val; idx +=idx & (-idx); // æ¬¡ã®æ›´æ–°ä½ç½® } } </div>

                            <h2>6. è¨ˆç®—é‡åˆ†æ</h2>
                            <div class="complexity-box">
                                <h3>â±ï¸ æ™‚é–“è¨ˆç®—é‡</h3>
                                <ul>
                                    <li><strong>BITæ§‹ç¯‰</strong>: O(n log n)</li>
                                    <li><strong>ä¸€ç‚¹æ›´æ–°</strong>: O(log n)</li>
                                    <li><strong>ç·è¨ˆç®—é‡</strong>: O(n log n + Q log n)</li>
                                </ul>

                                <h3>ğŸ’¾ ç©ºé–“è¨ˆç®—é‡</h3>
                                <ul>
                                    <li><strong>BITé…åˆ—</strong>: O(n)</li>
                                    <li><strong>è£œåŠ©å¤‰æ•°</strong>: O(1)</li>
                                </ul>
                            </div>

                            <h2>7. å…·ä½“ä¾‹ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
                            <div class="example-section">
                                <h3>ğŸ® å…¥åŠ›ä¾‹ï¼šA = [1, 5, 7, 9, 8, 6]</h3>
                                <h4>åˆæœŸBIT: [0, 1, 6, 7, 22, 8, 14]</h4>

                                <div class="step-by-step">
                                    <h4>ã‚¯ã‚¨ãƒª1: A[5] += 4</h4>
                                    <p>æ›´æ–°ãƒ‘ã‚¹: 5 â†’ 6</p>
                                    <p>çµæœ: [0, 1, 6, 7, 22, 12, 18]</p>

                                    <h4>ã‚¯ã‚¨ãƒª2: A[1] += 10</h4>
                                    <p>æ›´æ–°ãƒ‘ã‚¹: 1 â†’ 2 â†’ 4</p>
                                    <p>çµæœ: [0, 11, 16, 7, 32, 12, 18]</p>
                                </div>
                            </div>

                            <h2>8. ã¾ã¨ã‚</h2>
                            <div class="step-by-step">
                                <h3>ğŸ¯ BITã®æ ¸å¿ƒ</h3>
                                <ol>
                                    <li><strong>LSBæ“ä½œ</strong>ã«ã‚ˆã‚ŠåŠ¹ç‡çš„ãªæœ¨æ§‹é€ ã‚’å®Ÿç¾</li>
                                    <li><strong>ãƒã‚¤ãƒŠãƒªè¡¨ç¾</strong>ãŒæ›´æ–°ãƒ‘ã‚¹ã‚’æ±ºå®š</li>
                                    <li><strong>éƒ¨åˆ†å’Œã®é‡è¤‡ç®¡ç†</strong>ã«ã‚ˆã‚Šé«˜é€ŸåŒ–</li>
                                    <li><strong>ãƒ¡ãƒ¢ãƒªåŠ¹ç‡</strong>ãŒè‰¯ãå®Ÿè£…ãŒç°¡æ½”</li>
                                </ol>
                            </div>
                    </div>
    </body>

</html>