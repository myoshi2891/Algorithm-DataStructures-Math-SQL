<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phone Number Letter Combinations - Backtracking Algorithm</title>

    <!-- CDN Imports -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --primary: #6366f1;
        --primary-light: #8b5cf6;
        --secondary: #06b6d4;
        --accent: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --dark: #0f172a;
        --dark-light: #1e293b;
        --gray: #64748b;
        --light: #f8fafc;
        --white: #ffffff;
        --gradient: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--primary-light) 100%
        );
        --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        --shadow-lg: 0 35px 60px -12px rgba(0, 0, 0, 0.3);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        line-height: 1.7;
        color: var(--dark);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      /* Header */
      .header {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        padding: 2rem 0;
        margin-bottom: 3rem;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--white);
        text-align: center;
        margin-bottom: 0.5rem;
      }

      .header p {
        color: rgba(255, 255, 255, 0.8);
        text-align: center;
        font-size: 1.1rem;
      }

      /* Main Content */
      .main-content {
        display: grid;
        gap: 3rem;
        padding-bottom: 4rem;
      }

      /* Cards */
      .card {
        background: var(--white);
        border-radius: 20px;
        padding: 2.5rem;
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient);
      }

      .card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-lg);
      }

      .card h2 {
        font-size: 1.8rem;
        font-weight: 600;
        color: var(--dark);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .card h3 {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--primary);
        margin: 2rem 0 1rem 0;
      }

      /* Code Blocks */
      .code-container {
        position: relative;
        margin: 1.5rem 0;
      }

      .code-header {
        display: flex;
        justify-content: space-between !important;
        align-items: center;
        background: var(--dark);
        color: var(--white);
        padding: 1rem 1.5rem;
        border-radius: 12px 12px 0 0;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.9rem;
      }

      .copy-btn {
        background: var(--primary);
        color: var(--white);
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        cursor: pointer;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.8rem;
        transition: all 0.2s ease;
      }

      .copy-btn:hover {
        background: var(--primary-light);
        transform: scale(1.05);
      }

      pre[class*="language-"] {
        margin: 0 !important;
        border-radius: 0 0 12px 12px !important;
        font-family: "JetBrains Mono", monospace !important;
        font-size: 0.9rem !important;
        line-height: 1.6 !important;
      }

      /* Interactive Demo */
      .demo-section {
        background: linear-gradient(135deg, var(--light) 0%, #e2e8f0 100%);
        border-radius: 16px;
        padding: 2rem;
        margin: 2rem 0;
      }

      .demo-input {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        flex-wrap: wrap;
      }

      .demo-input input {
        flex: 1;
        padding: 1rem 1.5rem;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 1rem;
        font-family: "JetBrains Mono", monospace;
        transition: all 0.3s ease;
        min-width: 200px;
      }

      .demo-input input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .demo-btn {
        background: var(--gradient);
        color: var(--white);
        border: none;
        padding: 1rem 2rem;
        border-radius: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
      }

      .demo-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
      }

      .result-display {
        background: var(--white);
        border-radius: 12px;
        padding: 1.5rem;
        margin-top: 1.5rem;
        border: 2px solid #e2e8f0;
        min-height: 100px;
      }

      /* Visualization */
      .tree-visualization {
        background: var(--white);
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 2rem;
        margin: 2rem 0;
        text-align: center;
        font-family: "JetBrains Mono", monospace;
        overflow-x: auto;
      }

      .tree-node {
        display: inline-block;
        background: var(--primary);
        color: var(--white);
        padding: 0.5rem 1rem;
        border-radius: 8px;
        margin: 0.25rem;
        font-size: 0.9rem;
        animation: fadeInUp 0.5s ease;
      }

      .tree-level {
        margin: 1rem 0;
      }

      /* Complexity Analysis */
      .complexity-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin: 2rem 0;
      }

      .complexity-item {
        background: linear-gradient(135deg, var(--accent) 0%, #059669 100%);
        color: var(--white);
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        transform: perspective(1000px) rotateY(0deg);
        transition: all 0.3s ease;
      }

      .complexity-item:hover {
        transform: perspective(1000px) rotateY(-5deg) translateY(-5px);
      }

      .complexity-item h4 {
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
      }

      .complexity-item .value {
        font-size: 2rem;
        font-weight: 700;
        font-family: "JetBrains Mono", monospace;
      }

      /* Steps Animation */
      .step-container {
        display: none;
        background: #f1f5f9;
        border-radius: 12px;
        padding: 1.5rem;
        margin: 1rem 0;
        border-left: 4px solid var(--primary);
      }

      .step-container.active {
        display: block;
        animation: slideInRight 0.5s ease;
      }

      .step-number {
        display: inline-block;
        background: var(--primary);
        color: var(--white);
        width: 2rem;
        height: 2rem;
        border-radius: 50%;
        text-align: center;
        line-height: 2rem;
        font-weight: 600;
        margin-right: 1rem;
      }

      /* Navigation */
      .step-nav {
        display: flex;
        gap: 1rem;
        margin: 2rem 0;
      }

      .step-btn {
        background: var(--secondary);
        color: var(--white);
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .step-btn:hover {
        background: #0891b2;
        transform: translateY(-2px);
      }

      .step-btn:disabled {
        background: var(--gray);
        cursor: not-allowed;
        transform: none;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .container {
          padding: 0 1rem;
        }

        .header h1 {
          font-size: 2rem;
        }

        .card {
          padding: 1.5rem;
        }

        .demo-input {
          flex-direction: column;
        }

        .complexity-grid {
          grid-template-columns: 1fr;
        }
      }

      /* Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      /* Highlighted code lines */
      .highlight-line {
        background: rgba(99, 102, 241, 0.1) !important;
        border-left: 3px solid var(--primary) !important;
        padding-left: 1rem !important;
      }

      /* Phone keypad visual */
      .keypad {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.5rem;
        max-width: 300px;
        margin: 2rem auto;
      }

      .key {
        background: var(--white);
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        padding: 1rem;
        text-align: center;
        font-family: "JetBrains Mono", monospace;
        transition: all 0.3s ease;
      }

      .key:hover {
        border-color: var(--primary);
        transform: scale(1.05);
      }

      .key-number {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dark);
      }

      .key-letters {
        font-size: 0.9rem;
        color: var(--gray);
        margin-top: 0.5rem;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <h1><i class="fas fa-phone"></i> Phone Number Letter Combinations</h1>
        <p>バックトラッキングアルゴリズムによる組み合わせ生成の完全解説</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container">
      <div class="main-content">
        <!-- Problem Overview -->
        <section class="card">
          <h2><i class="fas fa-bullseye"></i> 問題概要</h2>
          <p>
            数字文字列（2-9）が与えられた時、電話のキーパッドのように各数字に対応する文字の全ての組み合わせを生成する問題です。
          </p>

          <div class="keypad">
            <div class="key">
              <div class="key-number">2</div>
              <div class="key-letters">ABC</div>
            </div>
            <div class="key">
              <div class="key-number">3</div>
              <div class="key-letters">DEF</div>
            </div>
            <div class="key">
              <div class="key-number">4</div>
              <div class="key-letters">GHI</div>
            </div>
            <div class="key">
              <div class="key-number">5</div>
              <div class="key-letters">JKL</div>
            </div>
            <div class="key">
              <div class="key-number">6</div>
              <div class="key-letters">MNO</div>
            </div>
            <div class="key">
              <div class="key-number">7</div>
              <div class="key-letters">PQRS</div>
            </div>
            <div class="key">
              <div class="key-number">8</div>
              <div class="key-letters">TUV</div>
            </div>
            <div class="key">
              <div class="key-number">9</div>
              <div class="key-letters">WXYZ</div>
            </div>
          </div>

          <h3>例</h3>
          <ul style="margin-left: 2rem; color: var(--gray)">
            <li>
              <strong>Input:</strong> <code>"23"</code> →
              <strong>Output:</strong>
              <code>["ad","ae","af","bd","be","bf","cd","ce","cf"]</code>
            </li>
            <li>
              <strong>Input:</strong> <code>""</code> →
              <strong>Output:</strong> <code>[]</code>
            </li>
            <li>
              <strong>Input:</strong> <code>"2"</code> →
              <strong>Output:</strong> <code>["a","b","c"]</code>
            </li>
          </ul>
        </section>

        <!-- Algorithm Explanation -->
        <section class="card">
          <h2>
            <i class="fas fa-cogs"></i> アルゴリズム解説：バックトラッキング
          </h2>
          <p>
            この問題は<strong>バックトラッキング（DFS）</strong>を使用して解決します。各桁に対して可能な文字を順次試し、全ての組み合わせを生成します。
          </p>

          <h3>実装コード</h3>
          <div class="code-container">
            <div class="code-header">
              <span>Python - Solution</span>
              <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
            </div>
            <pre
              id="python-code"
            ><code class="language-python">from typing import List

class Solution:
    def letterCombinations(self, digits: str) -> List[str]:
        """
        バックトラッキングで電話番号の文字組み合わせを生成

        時間計算量: O(3^N × 4^M)
        空間計算量: O(組み合わせ数 + 再帰スタック)
        """
        if not digits:
            return []

        # 数字と文字のマッピング
        phone_map = {
            "2": "abc", "3": "def", "4": "ghi",
            "5": "jkl", "6": "mno", "7": "pqrs",
            "8": "tuv", "9": "wxyz"
        }

        result = []

        def backtrack(index: int, path: str) -> None:
            """
            再帰的に文字列の組み合わせを構築

            Args:
                index: digits内の現在の桁位置
                path: 現在までの組み合わせ文字列
            """
            # ベースケース：全桁処理完了
            if index == len(digits):
                result.append(path)
                return

            # 現在の数字に対応する文字で探索
            current_digit = digits[index]
            for letter in phone_map[current_digit]:
                backtrack(index + 1, path + letter)

        backtrack(0, "")
        return result</code></pre>
          </div>
        </section>

        <!-- Interactive Demo -->
        <section class="card">
          <h2><i class="fas fa-play-circle"></i> インタラクティブデモ</h2>
          <div class="demo-section">
            <div class="demo-input">
              <input
                type="text"
                id="digits-input"
                placeholder="数字を入力 (例: 23)"
                maxlength="4"
                pattern="[2-9]*"
              />
              <button class="demo-btn" onclick="runDemo()">
                <i class="fas fa-rocket"></i> 実行
              </button>
            </div>
            <div class="result-display" id="result-display">
              <p
                style="color: var(--gray); text-align: center; margin-top: 2rem"
              >
                数字を入力して実行ボタンを押してください
              </p>
            </div>
          </div>
        </section>

        <!-- Step by Step -->
        <section class="card">
          <h2><i class="fas fa-list-ol"></i> ステップバイステップ解説</h2>
          <p>digits = "23" の場合の実行過程を詳しく見てみましょう。</p>

          <div class="step-nav">
            <button
              class="step-btn"
              onclick="previousStep()"
              id="prev-btn"
              disabled
            >
              <i class="fas fa-arrow-left"></i> 前へ
            </button>
            <button class="step-btn" onclick="nextStep()" id="next-btn">
              次へ <i class="fas fa-arrow-right"></i>
            </button>
            <button
              class="step-btn"
              onclick="resetSteps()"
              style="background: var(--warning)"
            >
              <i class="fas fa-refresh"></i> リセット
            </button>
          </div>

          <div id="steps-container">
            <div class="step-container active">
              <span class="step-number">1</span>
              <strong>初期状態：</strong> backtrack(0, "") を呼び出し<br />
              <em>index=0, path="", digits[0]='2' → letters="abc"</em>
            </div>
            <div class="step-container">
              <span class="step-number">2</span>
              <strong>1段目探索：</strong> 'a' を選択<br />
              <em
                >backtrack(1, "a") を呼び出し、digits[1]='3' → letters="def"</em
              >
            </div>
            <div class="step-container">
              <span class="step-number">3</span>
              <strong>2段目探索：</strong> 'd' を選択<br />
              <em
                >backtrack(2, "ad") → index==len(digits) →
                result.append("ad")</em
              >
            </div>
            <div class="step-container">
              <span class="step-number">4</span>
              <strong>バックトラック：</strong> 'e' を選択<br />
              <em>backtrack(2, "ae") → result.append("ae")</em>
            </div>
            <div class="step-container">
              <span class="step-number">5</span>
              <strong>バックトラック：</strong> 'f' を選択<br />
              <em>backtrack(2, "af") → result.append("af")</em>
            </div>
            <div class="step-container">
              <span class="step-number">6</span>
              <strong>次の分岐：</strong> 'b' を選択<br />
              <em>backtrack(1, "b") → "bd", "be", "bf" を生成</em>
            </div>
            <div class="step-container">
              <span class="step-number">7</span>
              <strong>最後の分岐：</strong> 'c' を選択<br />
              <em>backtrack(1, "c") → "cd", "ce", "cf" を生成</em>
            </div>
            <div class="step-container">
              <span class="step-number">8</span>
              <strong>完了：</strong> 全組み合わせ生成完了<br />
              <em
                >result = ["ad", "ae", "af", "bd", "be", "bf", "cd", "ce",
                "cf"]</em
              >
            </div>
          </div>
        </section>

        <!-- Visual Tree -->
        <section class="card">
          <h2><i class="fas fa-sitemap"></i> 探索木の可視化</h2>
          <div class="tree-visualization" id="tree-display">
            <div class="tree-level">
              <div class="tree-node" style="background: var(--secondary)">
                root: ""
              </div>
            </div>
            <div class="tree-level">
              <div class="tree-node">a</div>
              <div class="tree-node">b</div>
              <div class="tree-node">c</div>
            </div>
            <div class="tree-level">
              <div class="tree-node">ad</div>
              <div class="tree-node">ae</div>
              <div class="tree-node">af</div>
              <div class="tree-node">bd</div>
              <div class="tree-node">be</div>
              <div class="tree-node">bf</div>
              <div class="tree-node">cd</div>
              <div class="tree-node">ce</div>
              <div class="tree-node">cf</div>
            </div>
          </div>
        </section>

        <!-- Complexity Analysis -->
        <section class="card">
          <h2><i class="fas fa-chart-line"></i> 計算量解析</h2>
          <div class="complexity-grid">
            <div class="complexity-item">
              <h4>時間計算量</h4>
              <div class="value">O(3^N × 4^M)</div>
              <p style="margin-top: 0.5rem; font-size: 0.9rem">
                N: 3文字キーの個数<br />M: 4文字キーの個数
              </p>
            </div>
            <div
              class="complexity-item"
              style="
                background: linear-gradient(
                  135deg,
                  var(--warning) 0%,
                  #d97706 100%
                );
              "
            >
              <h4>空間計算量</h4>
              <div class="value">O(R + D)</div>
              <p style="margin-top: 0.5rem; font-size: 0.9rem">
                R: 結果の組み合わせ数<br />D: 再帰の深さ
              </p>
            </div>
          </div>

          <h3>具体例での計算量</h3>
          <table
            style="width: 100%; border-collapse: collapse; margin-top: 1rem"
          >
            <tr style="background: var(--light)">
              <th style="padding: 1rem; border: 1px solid #e2e8f0">入力</th>
              <th style="padding: 1rem; border: 1px solid #e2e8f0">
                組み合わせ数
              </th>
              <th style="padding: 1rem; border: 1px solid #e2e8f0">計算過程</th>
            </tr>
            <tr>
              <td
                style="
                  padding: 1rem;
                  border: 1px solid #e2e8f0;
                  font-family: 'JetBrains Mono', monospace;
                "
              >
                "2"
              </td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">3</td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">3^1 = 3</td>
            </tr>
            <tr style="background: #f8fafc">
              <td
                style="
                  padding: 1rem;
                  border: 1px solid #e2e8f0;
                  font-family: 'JetBrains Mono', monospace;
                "
              >
                "23"
              </td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">9</td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">
                3 × 3 = 9
              </td>
            </tr>
            <tr>
              <td
                style="
                  padding: 1rem;
                  border: 1px solid #e2e8f0;
                  font-family: 'JetBrains Mono', monospace;
                "
              >
                "279"
              </td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">48</td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">
                3 × 4 × 4 = 48
              </td>
            </tr>
            <tr style="background: #f8fafc">
              <td
                style="
                  padding: 1rem;
                  border: 1px solid #e2e8f0;
                  font-family: 'JetBrains Mono', monospace;
                "
              >
                "2379"
              </td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">144</td>
              <td style="padding: 1rem; border: 1px solid #e2e8f0">
                3 × 3 × 4 × 4 = 144
              </td>
            </tr>
          </table>
        </section>

        <!-- Key Points -->
        <section class="card">
          <h2><i class="fas fa-key"></i> 重要なポイント</h2>
          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
              gap: 1.5rem;
              margin-top: 1.5rem;
            "
          >
            <div
              style="
                background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
                padding: 1.5rem;
                border-radius: 12px;
                border-left: 4px solid var(--secondary);
              "
            >
              <h4 style="color: var(--secondary); margin-bottom: 0.5rem">
                <i class="fas fa-search"></i> DFS探索
              </h4>
              <p>深度優先探索で全ての組み合わせを体系的に生成</p>
            </div>
            <div
              style="
                background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
                padding: 1.5rem;
                border-radius: 12px;
                border-left: 4px solid var(--accent);
              "
            >
              <h4 style="color: var(--accent); margin-bottom: 0.5rem">
                <i class="fas fa-undo"></i> バックトラッキング
              </h4>
              <p>各選択肢を試した後、前の状態に戻って次の選択肢を探索</p>
            </div>
            <div
              style="
                background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
                padding: 1.5rem;
                border-radius: 12px;
                border-left: 4px solid var(--warning);
              "
            >
              <h4 style="color: var(--warning); margin-bottom: 0.5rem">
                <i class="fas fa-layer-group"></i> 再帰構造
              </h4>
              <p>問題を小さな部分問題に分解して解決</p>
            </div>
            <div
              style="
                background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%);
                padding: 1.5rem;
                border-radius: 12px;
                border-left: 4px solid var(--danger);
              "
            >
              <h4 style="color: var(--danger); margin-bottom: 0.5rem">
                <i class="fas fa-stopwatch"></i> 指数時間
              </h4>
              <p>組み合わせの性質上、指数的な時間計算量が発生</p>
            </div>
          </div>
        </section>

        <!-- Best Practices -->
        <section class="card">
          <h2><i class="fas fa-star"></i> 実装のベストプラクティス</h2>

          <h3>最適化のポイント</h3>
          <ul style="margin-left: 2rem; color: var(--gray)">
            <li>
              <strong>早期終了：</strong> 空文字列の場合は即座に空リストを返却
            </li>
            <li><strong>メモリ効率：</strong> 文字列結合を最小限に抑制</li>
            <li><strong>型安全性：</strong> 適切な型ヒントの使用</li>
            <li><strong>可読性：</strong> 明確な変数名とコメント</li>
          </ul>

          <h3>エラーハンドリング</h3>
          <div class="code-container">
            <div class="code-header">
              <span>Python - Enhanced Version</span>
              <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
            </div>
            <pre
              id="enhanced-code"
            ><code class="language-python">class Solution:
    def letterCombinations(self, digits: str) -> List[str]:
        # 入力検証
        if not digits or not digits.isdigit():
            return []

        # 無効な数字をチェック
        if any(d in '01' for d in digits):
            raise ValueError("Invalid digit: only 2-9 are allowed")

        phone_map = {
            "2": "abc", "3": "def", "4": "ghi",
            "5": "jkl", "6": "mno", "7": "pqrs",
            "8": "tuv", "9": "wxyz"
        }

        result = []

        def backtrack(index: int, path: str) -> None:
            if index == len(digits):
                result.append(path)
                return

            current_digit = digits[index]
            if current_digit not in phone_map:
                return  # スキップ

            for letter in phone_map[current_digit]:
                backtrack(index + 1, path + letter)

        backtrack(0, "")
        return result</code></pre>
          </div>
        </section>

        <!-- Alternative Approaches -->
        <section class="card">
          <h2><i class="fas fa-code-branch"></i> 代替実装方法</h2>

          <h3>1. 反復的アプローチ（BFS）</h3>
          <div class="code-container">
            <div class="code-header">
              <span>Python - Iterative BFS</span>
              <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
            </div>
            <pre
              id="iterative-code"
            ><code class="language-python">def letterCombinations_iterative(self, digits: str) -> List[str]:
    if not digits:
        return []

    phone_map = {
        "2": "abc", "3": "def", "4": "ghi",
        "5": "jkl", "6": "mno", "7": "pqrs",
        "8": "tuv", "9": "wxyz"
    }

    result = [""]

    for digit in digits:
        temp = []
        for combination in result:
            for letter in phone_map[digit]:
                temp.append(combination + letter)
        result = temp

    return result</code></pre>
          </div>

          <h3>2. 関数型プログラミングスタイル</h3>
          <div class="code-container">
            <div class="code-header">
              <span>Python - Functional Style</span>
              <button class="copy-btn"><i class="fas fa-copy"></i> Copy</button>
            </div>
            <pre
              id="functional-code"
            ><code class="language-python">from itertools import product

def letterCombinations_functional(self, digits: str) -> List[str]:
    if not digits:
        return []

    phone_map = {
        "2": "abc", "3": "def", "4": "ghi",
        "5": "jkl", "6": "mno", "7": "pqrs",
        "8": "tuv", "9": "wxyz"
    }

    # 各数字に対応する文字列のリストを作成
    letter_groups = [phone_map[digit] for digit in digits]

    # 直積を計算して組み合わせ生成
    return [''.join(combination) for combination in product(*letter_groups)]</code></pre>
          </div>
        </section>
      </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

    <script>
      // Global variables
      let currentStep = 0;
      const totalSteps = 8;

      // Phone mapping
      const phoneMap = {
        2: "abc",
        3: "def",
        4: "ghi",
        5: "jkl",
        6: "mno",
        7: "pqrs",
        8: "tuv",
        9: "wxyz",
      };

      function copyCode(btn) {
        const codeContainer = btn.closest(".code-container");
        if (!codeContainer) return;

        const codeElement = codeContainer.querySelector("code");
        if (!codeElement) return;

        const code = codeElement.innerText;
        navigator.clipboard.writeText(code).then(
          () => {
            const originalContent = btn.innerHTML;
            btn.innerHTML = `<i class="fas fa-check"></i> Copied!`;
            btn.classList.add("copied");

            setTimeout(
              (btnToRestore, content) => {
                btnToRestore.innerHTML = content;
                btnToRestore.classList.remove("copied");
              },
              2000,
              btn,
              originalContent
            );
          },
          (err) => {
            console.error("Failed to copy: ", err);
          }
        );
      }

      function setupLineNumbers() {
        const codeWrappers = document.querySelectorAll(".code-wrapper");
        codeWrappers.forEach((wrapper) => {
          const code = wrapper.querySelector("code");
          if (!code) return;
          const lines = code.innerText.split("\n").length;
          const lineNumbersDiv = wrapper.querySelector(".line-numbers");
          if (!lineNumbersDiv) return;
          lineNumbersDiv.innerHTML = Array.from(
            { length: lines },
            (_, i) => `<span>${i + 1}</span>`
          ).join("");
        });
      }

      // Letter combinations algorithm
      function letterCombinations(digits) {
        if (!digits) return [];

        const result = [];

        function backtrack(index, path) {
          if (index === digits.length) {
            result.push(path);
            return;
          }

          const currentDigit = digits[index];
          const letters = phoneMap[currentDigit];

          if (letters) {
            for (let letter of letters) {
              backtrack(index + 1, path + letter);
            }
          }
        }

        backtrack(0, "");
        return result;
      }

      // Demo functionality
      function runDemo() {
        const input = document.getElementById("digits-input").value.trim();
        const resultDiv = document.getElementById("result-display");

        // Validate input
        if (!/^[2-9]*$/.test(input)) {
          resultDiv.innerHTML = `
                    <div style="color: var(--danger); text-align: center; padding: 1rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                        エラー: 2-9の数字のみ入力してください
                    </div>
                `;
          return;
        }

        if (input.length > 4) {
          resultDiv.innerHTML = `
                    <div style="color: var(--danger); text-align: center; padding: 1rem;">
                        <i class="fas fa-exclamation-triangle"></i>
                        エラー: 最大4文字まで入力可能です
                    </div>
                `;
          return;
        }

        const result = letterCombinations(input);

        if (result.length === 0) {
          resultDiv.innerHTML = `
                    <div style="text-align: center; padding: 1rem; color: var(--gray);">
                        <i class="fas fa-info-circle"></i>
                        結果: 空の配列 []
                    </div>
                `;
        } else {
          const combinations = result
            .map(
              (combo) =>
                `<span style="
                        background: var(--primary);
                        color: var(--white);
                        padding: 0.5rem 0.75rem;
                        border-radius: 6px;
                        font-family: 'JetBrains Mono', monospace;
                        margin: 0.25rem;
                        display: inline-block;
                        animation: fadeInUp 0.5s ease;
                    ">${combo}</span>`
            )
            .join("");

          resultDiv.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <strong>入力:</strong> <code style="background: #f1f5f9; padding: 0.25rem 0.5rem; border-radius: 4px;">"${input}"</code>
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <strong>組み合わせ数:</strong> ${result.length}
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <strong>結果:</strong>
                    </div>
                    <div style="line-height: 2.5;">
                        ${combinations}
                    </div>
                `;
        }

        // Update tree visualization
        updateTreeVisualization(input, result);
      }

      // Update tree visualization
      function updateTreeVisualization(digits, result) {
        const treeDiv = document.getElementById("tree-display");

        if (!digits || result.length === 0) {
          treeDiv.innerHTML = `
                    <div style="color: var(--gray); padding: 2rem;">
                        数字を入力してデモを実行すると、探索木が表示されます
                    </div>
                `;
          return;
        }

        let html =
          '<div class="tree-level"><div class="tree-node" style="background: var(--secondary);">root: ""</div></div>';

        // Generate tree levels
        if (digits.length >= 1) {
          const firstLetters = phoneMap[digits[0]];
          html += '<div class="tree-level">';
          for (let letter of firstLetters) {
            html += `<div class="tree-node">${letter}</div>`;
          }
          html += "</div>";
        }

        if (digits.length >= 2) {
          html += '<div class="tree-level">';
          for (let combo of result) {
            html += `<div class="tree-node" style="background: var(--accent);">${combo}</div>`;
          }
          html += "</div>";
        }

        treeDiv.innerHTML = html;
      }

      // Step navigation functions
      function nextStep() {
        if (currentStep < totalSteps - 1) {
          currentStep++;
          updateStepDisplay();
        }
      }

      function previousStep() {
        if (currentStep > 0) {
          currentStep--;
          updateStepDisplay();
        }
      }

      function resetSteps() {
        currentStep = 0;
        updateStepDisplay();
      }

      function updateStepDisplay() {
        const steps = document.querySelectorAll(".step-container");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");

        // Hide all steps
        steps.forEach((step, index) => {
          step.classList.remove("active");
          if (index === currentStep) {
            step.classList.add("active");
          }
        });

        // Update button states
        prevBtn.disabled = currentStep === 0;
        nextBtn.disabled = currentStep === totalSteps - 1;
      }

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        // Add line numbers to code blocks
        const copyButtons = document.querySelectorAll(".copy-btn");
        copyButtons.forEach((btn) => {
          btn.addEventListener("click", () => copyCode(btn));
        });

        setupLineNumbers();
        runDemo(); // 初期表示のためにデモを実行

        // Auto-focus demo input
        // document.getElementById("digits-input").focus();

        // Add enter key support for demo input
        document
          .getElementById("digits-input")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              runDemo();
            }
          });

        // Initialize step display
        updateStepDisplay();
      });

      // Add smooth scroll behavior
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          document.querySelector(this.getAttribute("href")).scrollIntoView({
            behavior: "smooth",
          });
        });
      });

      // Add intersection observer for animations
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = "1";
            entry.target.style.transform = "translateY(0)";
          }
        });
      });

      document.querySelectorAll(".card").forEach((card) => {
        card.style.opacity = "0";
        card.style.transform = "translateY(30px)";
        card.style.transition = "all 0.6s ease";
        observer.observe(card);
      });
    </script>
  </body>
</html>
