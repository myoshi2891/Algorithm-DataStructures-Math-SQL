## **スタックを用いた括弧検証アルゴリズム**を図解し、各処理について具体的に説明します。

# ① 基本的な動作フロー

### **アルゴリズム概要**

| 入力文字 | 動作           | スタック      |
| -------- | -------------- | ------------- |
| `(`      | Push           | `[`(\`]       |
| `[`      | Push           | `[`(\`\`\[\`] |
| `]`      | Pop & チェック | `[`(\`]       |
| `)`      | Pop & チェック | （空）        |

---

## **図解：入力 s = "(\[])"**

```
初期状態:
stack = []
```

### ステップ1: `(` を読む → **Push**

```
stack: [
    (
]
```

---

### ステップ2: `[` を読む → **Push**

```
stack: [
    (
    [
]
```

---

### ステップ3: `]` を読む → **Pop & チェック**

```
pop -> [

bracketMap[']'] = [

[ が取り出されたので OK

stack: [
    (
]
```

---

### ステップ4: `)` を読む → **Pop & チェック**

```
pop -> (

bracketMap[')'] = (

( が取り出されたので OK

stack: []
```

---

### **最終判定**

- `stack` が空 → **true（有効な括弧列）**

---

# ② 入力が不正な場合（例："(\[)]"）

| 入力文字 | 動作           | スタック                                          |
| -------- | -------------- | ------------------------------------------------- |
| `(`      | Push           | `[`(\`]                                           |
| `[`      | Push           | `[`(\`\`\[\`]                                     |
| `)`      | Pop & チェック | `[`(`] → **失敗**（対応括弧が `\[`, 期待は `(\`） |

---

## **図解：入力 s = "(\[)]"**

```
初期状態:
stack = []
```

### ステップ1: `(` を読む → **Push**

```
stack: [
    (
]
```

---

### ステップ2: `[` を読む → **Push**

```
stack: [
    (
    [
]
```

---

### ステップ3: `)` を読む → **Pop & チェック**

```
pop -> [

bracketMap[')'] = (

[ が取り出されたが、期待は ( → **NG（不正）**

即 return false
```

---

# ③ 流れまとめ（フローチャート）

```
          +----------------+
          | 文字列を1文字ずつ読む |
          +--------+-------+
                   |
        +----------+-----------+
        | 開き括弧か？         |
        | (, [, {             |
        +----------+-----------+
                   |Yes
          +--------v--------+
          | スタックにPush   |
          +-----------------+
                   |
                [次の文字]
                   |
                   |No（閉じ括弧）
        +----------v----------+
        | スタックが空か？    |
        +----------+----------+
                   |Yes
          +--------v--------+
          | 不正（false）   |
          +----------------+
                   |
                   |No
        +----------v-----------+
        | スタックのTopと対応? |
        +----------+-----------+
                   |Yes         |No
          +--------v--------+   +----------------+
          | Popして次へ     |   | 不正（false） |
          +-----------------+   +----------------+
```

---

# ④ 時間・空間解析

| 項目 | 計算量                               |
| ---- | ------------------------------------ |
| 時間 | O(n)（1文字あたりPushまたはPopのみ） |
| 空間 | O(n)（全て開き括弧のとき最大）       |

---

# ⑤ まとめ

- **有効な括弧列**：スタックで管理し、**対応する閉じ括弧でTopが一致するか確認**
- **不正な場合**：
    - スタックが空の状態で閉じ括弧が来る
    - スタックTopと閉じ括弧の対応が間違っている

- **全処理後にスタックが空であれば正しい括弧列**
