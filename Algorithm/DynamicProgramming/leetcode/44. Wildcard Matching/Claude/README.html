<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°è§£æ</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                margin: 0;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #333;
            }
            .container {
                max-width: 1200px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            }
            h1 {
                text-align: center;
                color: #2c3e50;
                margin-bottom: 40px;
                font-size: 2.5em;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }
            h2 {
                color: #34495e;
                border-bottom: 3px solid #3498db;
                padding-bottom: 10px;
                margin-top: 40px;
            }
            .example-section {
                background: #f8f9fa;
                padding: 20px;
                border-radius: 10px;
                margin: 20px 0;
                border-left: 5px solid #3498db;
            }
            .dp-table {
                border-collapse: collapse;
                margin: 20px auto;
                background: white;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }
            .dp-table th,
            .dp-table td {
                border: 1px solid #ddd;
                padding: 10px;
                text-align: center;
                font-weight: bold;
                min-width: 40px;
            }
            .dp-table th {
                background: #3498db;
                color: white;
            }
            .dp-table .header-char {
                background: #2ecc71;
                color: white;
            }
            .true-cell {
                background: #2ecc71;
                color: white;
            }
            .false-cell {
                background: #e74c3c;
                color: white;
            }
            .step-animation {
                padding: 15px;
                margin: 10px 0;
                border-radius: 8px;
                background: #ecf0f1;
                border-left: 4px solid #9b59b6;
            }
            .code-block {
                background: #2c3e50;
                color: #ecf0f1;
                padding: 20px;
                border-radius: 8px;
                font-family: 'Courier New', monospace;
                overflow-x: auto;
                margin: 20px 0;
            }
            .highlight {
                background: #f39c12;
                padding: 2px 5px;
                border-radius: 3px;
                color: white;
            }
            .control-panel {
                text-align: center;
                margin: 30px 0;
                padding: 20px;
                background: #34495e;
                border-radius: 10px;
                color: white;
            }
            input[type='text'] {
                padding: 10px;
                margin: 5px;
                border: none;
                border-radius: 5px;
                font-size: 16px;
                width: 200px;
            }
            button {
                background: #3498db;
                color: white;
                border: none;
                padding: 12px 25px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 16px;
                transition: background 0.3s;
            }
            button:hover {
                background: #2980b9;
            }
            .legend {
                display: flex;
                justify-content: center;
                gap: 30px;
                margin: 20px 0;
                flex-wrap: wrap;
            }
            .legend-item {
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .legend-box {
                width: 20px;
                height: 20px;
                border-radius: 3px;
            }
            .flow-diagram {
                display: flex;
                justify-content: space-around;
                align-items: center;
                margin: 30px 0;
                flex-wrap: wrap;
            }
            .flow-box {
                background: #3498db;
                color: white;
                padding: 15px;
                border-radius: 10px;
                text-align: center;
                min-width: 150px;
                margin: 10px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }
            .arrow {
                font-size: 24px;
                color: #3498db;
                margin: 0 10px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>ğŸ” ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°è§£æ</h1>

            <div class="control-panel">
                <h3>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¢</h3>
                <div>
                    <label>æ–‡å­—åˆ— (s): </label>
                    <input type="text" id="stringInput" value="adceb" placeholder="ä¾‹: adceb" />
                </div>
                <div>
                    <label>ãƒ‘ã‚¿ãƒ¼ãƒ³ (p): </label>
                    <input type="text" id="patternInput" value="*a*b*" placeholder="ä¾‹: *a*b*" />
                </div>
                <button onclick="analyzePattern()">è§£æå®Ÿè¡Œ</button>
            </div>

            <h2>ğŸ“Š ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æµã‚Œ</h2>
            <div class="flow-diagram">
                <div class="flow-box">1. DPãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸåŒ–</div>
                <div class="arrow">â†’</div>
                <div class="flow-box">2. ãƒ™ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹è¨­å®š</div>
                <div class="arrow">â†’</div>
                <div class="flow-box">3. DPè¨ˆç®—</div>
                <div class="arrow">â†’</div>
                <div class="flow-box">4. çµæœå–å¾—</div>
            </div>

            <h2>ğŸ¯ Example 1: s="aa", p="*"</h2>
            <div class="example-section">
                <h3>ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è§£æ</h3>

                <div class="step-animation">
                    <strong>ã‚¹ãƒ†ãƒƒãƒ—1: DPãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸåŒ–</strong><br />
                    ã‚µã‚¤ã‚º (3Ã—2) ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã€å…¨ã¦falseã§åˆæœŸåŒ–
                </div>

                <table class="dp-table">
                    <tr>
                        <th></th>
                        <th class="header-char">Îµ</th>
                        <th class="header-char">*</th>
                    </tr>
                    <tr>
                        <th class="header-char">Îµ</th>
                        <td class="true-cell">T</td>
                        <td class="true-cell">T</td>
                    </tr>
                    <tr>
                        <th class="header-char">a</th>
                        <td class="false-cell">F</td>
                        <td class="true-cell">T</td>
                    </tr>
                    <tr>
                        <th class="header-char">aa</th>
                        <td class="false-cell">F</td>
                        <td class="true-cell">T</td>
                    </tr>
                </table>

                <div class="step-animation">
                    <strong>å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯:</strong><br />
                    â€¢ dp[0][0] = true (ç©ºæ–‡å­—åˆ—ã¨ç©ºãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ãƒãƒƒãƒ)<br />
                    â€¢ dp[0][1] = true ('*'ã¯ç©ºæ–‡å­—åˆ—ã«ã‚‚ãƒãƒƒãƒ)<br />
                    â€¢ dp[1][1] = dp[1][0] || dp[0][1] = false || true = true<br />
                    â€¢ dp[2][1] = dp[2][0] || dp[1][1] = false || true = true
                </div>
            </div>

            <h2>ğŸ¯ Example 2: s="adceb", p="*a*b*"</h2>
            <div class="example-section">
                <table class="dp-table" id="dynamicTable">
                    <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                </table>
                <div id="analysisResult"></div>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-box true-cell"></div>
                    <span>True (ãƒãƒƒãƒ)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box false-cell"></div>
                    <span>False (ãƒãƒƒãƒã—ãªã„)</span>
                </div>
            </div>

            <h2>âš¡ æ™‚é–“ãƒ»ç©ºé–“è¨ˆç®—é‡è§£æ</h2>
            <div class="example-section">
                <h3>æ™‚é–“è¨ˆç®—é‡: O(m Ã— n)</h3>
                <p>â€¢ m = æ–‡å­—åˆ—ã®é•·ã•, n = ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é•·ã•</p>
                <p>â€¢ å„ã‚»ãƒ«ã‚’ä¸€åº¦ã ã‘è¨ˆç®—ã™ã‚‹ãŸã‚ç·šå½¢æ™‚é–“</p>

                <h3>ç©ºé–“è¨ˆç®—é‡: O(m Ã— n)</h3>
                <p>â€¢ DPãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚µã‚¤ã‚ºã«ä¾å­˜</p>
                <p>â€¢ æœ€é©åŒ–: O(n)ã«å‰Šæ¸›å¯èƒ½ï¼ˆå‰ã®è¡Œã®ã¿ä¿æŒï¼‰</p>
            </div>

            <h2>ğŸ”§ æ ¸å¿ƒå‡¦ç†ã®è©³ç´°</h2>
            <div class="code-block">
                if (pChar === '*') { // '*'ã®2ã¤ã®è§£é‡ˆ: // 1. ç©ºæ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã†: dp[i][j-1] // 2.
                1æ–‡å­—ä»¥ä¸Šã¨ã—ã¦æ‰±ã†: dp[i-1][j] dp[i][j] = dp[i][j - 1] || dp[i - 1][j]; } else if
                (pChar === '?' || pChar === sChar) { // '?'ã¯ä»»æ„ã®1æ–‡å­—ã€ã¾ãŸã¯å®Œå…¨ä¸€è‡´ dp[i][j] =
                dp[i - 1][j - 1]; }
            </div>

            <div class="example-section">
                <h3>ğŸŒŸ '*'ã®å‡¦ç†ãŒé‡è¦ãªç†ç”±</h3>
                <p><span class="highlight">dp[i][j-1]</span>: '*'ã‚’ç©ºæ–‡å­—åˆ—ã¨ã—ã¦è§£é‡ˆ</p>
                <p>
                    <span class="highlight">dp[i-1][j]</span>: '*'ã‚’ç¾åœ¨ã®æ–‡å­—ã‚’å«ã‚€æ–‡å­—åˆ—ã¨ã—ã¦è§£é‡ˆ
                </p>
                <p>ã“ã®2ã¤ã®è«–ç†å’Œã«ã‚ˆã‚Šã€'*'ã®æŸ”è»Ÿæ€§ã‚’å®Œå…¨ã«è¡¨ç¾</p>
            </div>
        </div>

        <script>
            function isMatch(s, p) {
                console.log('isMatch called with:', s, p); // ãƒ‡ãƒãƒƒã‚°ç”¨
                const sLen = s.length;
                const pLen = p.length;

                // DPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ­£ã—ãåˆæœŸåŒ–
                const dp = [];
                for (let i = 0; i <= sLen; i++) {
                    dp[i] = [];
                    for (let j = 0; j <= pLen; j++) {
                        dp[i][j] = false;
                    }
                }

                // ãƒ™ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
                dp[0][0] = true;

                // ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å…ˆé ­ã®*ã‚’å‡¦ç†
                for (let j = 1; j <= pLen; j++) {
                    if (p[j - 1] === '*') {
                        dp[0][j] = dp[0][j - 1];
                    }
                }

                // DPãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åŸ‹ã‚ã‚‹
                for (let i = 1; i <= sLen; i++) {
                    for (let j = 1; j <= pLen; j++) {
                        const sChar = s[i - 1];
                        const pChar = p[j - 1];

                        if (pChar === '*') {
                            dp[i][j] = dp[i][j - 1] || dp[i - 1][j];
                        } else if (pChar === '?' || pChar === sChar) {
                            dp[i][j] = dp[i - 1][j - 1];
                        }
                    }
                }

                return { result: dp[sLen][pLen], dpTable: dp };
            }

            function createDPTable(s, p, dpTable) {
                let html = '<tr><th></th><th class="header-char">Îµ</th>';

                // ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ˜ãƒƒãƒ€ãƒ¼
                for (let i = 0; i < p.length; i++) {
                    const char = p[i] === '*' ? 'â˜…' : p[i] === '?' ? 'ï¼Ÿ' : p[i];
                    html += `<th class="header-char">${char}</th>`;
                }
                html += '</tr>';

                // å„è¡Œã‚’ä½œæˆ
                for (let i = 0; i <= s.length; i++) {
                    html += '<tr>';

                    // è¡Œã®ãƒ˜ãƒƒãƒ€ãƒ¼
                    if (i === 0) {
                        html += '<th class="header-char">Îµ</th>';
                    } else {
                        html += `<th class="header-char">${s[i - 1]}</th>`;
                    }

                    // å„ã‚»ãƒ«
                    for (let j = 0; j <= p.length; j++) {
                        const cellClass = dpTable[i][j] ? 'true-cell' : 'false-cell';
                        const cellValue = dpTable[i][j] ? 'T' : 'F';
                        html += `<td class="${cellClass}">${cellValue}</td>`;
                    }
                    html += '</tr>';
                }

                return html;
            }

            function analyzePattern() {
                try {
                    const s = document.getElementById('stringInput').value.trim();
                    const p = document.getElementById('patternInput').value.trim();

                    console.log('Analyzing:', s, p); // ãƒ‡ãƒãƒƒã‚°ç”¨

                    if (!s && !p) {
                        document.getElementById('analysisResult').innerHTML =
                            '<div style="color: #f39c12;">âš ï¸ æ–‡å­—åˆ—ã¾ãŸã¯ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>';
                        return;
                    }

                    const { result, dpTable } = isMatch(s, p);

                    console.log('Result:', result, dpTable); // ãƒ‡ãƒãƒƒã‚°ç”¨

                    const tableElement = document.getElementById('dynamicTable');
                    if (tableElement) {
                        tableElement.innerHTML = createDPTable(s, p, dpTable);
                    }

                    const resultText = result
                        ? `<div style="color: #2ecc71; font-size: 20px; font-weight: bold; margin: 15px 0;">âœ… ãƒãƒƒãƒã—ã¾ã—ãŸ!</div>`
                        : `<div style="color: #e74c3c; font-size: 20px; font-weight: bold; margin: 15px 0;">âŒ ãƒãƒƒãƒã—ã¾ã›ã‚“ã§ã—ãŸ</div>`;

                    const resultElement = document.getElementById('analysisResult');
                    if (resultElement) {
                        resultElement.innerHTML = `
                        ${resultText}
                        <div style="background: #ecf0f1; padding: 15px; border-radius: 8px; margin: 10px 0;">
                            <p><strong>å…¥åŠ›:</strong></p>
                            <p>â€¢ æ–‡å­—åˆ— (s): "${s}" (é•·ã•: ${s.length})</p>
                            <p>â€¢ ãƒ‘ã‚¿ãƒ¼ãƒ³ (p): "${p}" (é•·ã•: ${p.length})</p>
                            <p><strong>æœ€çµ‚çµæœ:</strong> dp[${s.length}][${p.length}] = ${result}</p>
                        </div>
                    `;
                    }
                } catch (error) {
                    console.error('Error in analyzePattern:', error);
                    document.getElementById(
                        'analysisResult',
                    ).innerHTML = `<div style="color: #e74c3c;">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}</div>`;
                }
            }

            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸè¡¨ç¤º
            document.addEventListener('DOMContentLoaded', function () {
                console.log('DOM loaded, initializing...');
                analyzePattern();
            });

            // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§Enterã‚­ãƒ¼ã‚’æŠ¼ã—ãŸæ™‚ã‚‚å®Ÿè¡Œ
            document.addEventListener('DOMContentLoaded', function () {
                document.getElementById('stringInput').addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') analyzePattern();
                });
                document.getElementById('patternInput').addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') analyzePattern();
                });
            });
        </script>
    </body>
</html>
