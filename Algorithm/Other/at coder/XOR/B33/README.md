ä»¥ä¸‹ã«ã€**å„å‡¦ç†ã®å†…å®¹ã‚’å›³ä»˜ãã§è©³ç´°ã«è§£æ**ãƒ»èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚
å•é¡Œã¯ã€Œè¤‡æ•°ã®ã‚³ãƒã®ã‚ã‚‹ç›¤é¢ä¸Šã§ã€ä¸Šæ–¹å‘ã¾ãŸã¯å·¦æ–¹å‘ã«ã—ã‹å‹•ã‹ã›ãªã„çŠ¶æ³ã§ã€ã©ã¡ã‚‰ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå‹ã¤ã‹ã€ã‚’åˆ¤å®šã™ã‚‹ã‚‚ã®ã§ã™ã€‚

---

## ğŸ§  1. ã‚²ãƒ¼ãƒ ã®æœ¬è³ªï¼šNim ã‚²ãƒ¼ãƒ ã¨ Grundy æ•°

ã“ã®ã‚²ãƒ¼ãƒ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨€ã„æ›ãˆã‚‰ã‚Œã¾ã™ï¼š

> å„ã‚³ãƒ `(a, b)` ã‚’ã€å·¦æ–¹å‘ã¾ãŸã¯ä¸Šæ–¹å‘ã«1ãƒã‚¹ä»¥ä¸Šå‹•ã‹ã›ã‚‹ã€ŒçŠ¶æ…‹ã€ã¨ã—ã¦æ‰±ã„ã€ãã‚Œã‚‰ã®çŠ¶æ…‹ã®**Grundy æ•°**ã‚’æ±‚ã‚ã€ãã® XOR ã‚’å–ã£ã¦å‹æ•—ã‚’åˆ¤å®šã™ã‚‹ã€‚

---

## ğŸ§© 2. Grundy æ•°ã¨ã¯ï¼Ÿ

### ğŸ¯ å®šç¾©

Grundy æ•°ï¼ˆã‚°ãƒ©ãƒ³ãƒ‡ã‚£æ•°ï¼‰ã¯ã€ã‚ã‚‹ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãŒã€Œã©ã‚Œã ã‘æœ‰åˆ©ã‹ã€ã‚’è¡¨ã™æ•°ã§ã€Nim ã‚²ãƒ¼ãƒ ã§ã¯å±±ã®å¤§ãã•ãŒãã®ã¾ã¾ Grundy æ•°ã«å¯¾å¿œã—ã¾ã™ã€‚

> è¤‡æ•°ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ãŒã‚ã‚‹ã¨ãã€ã™ã¹ã¦ã® Grundy æ•°ã® XOR ãŒ 0 â†’ å¾Œæ‰‹å‹ã¡ã€â‰  0 â†’ å…ˆæ‰‹å‹ã¡

---

## ğŸ—ºï¸ 3. ãƒã‚¹ã®ç§»å‹•ã¨ Grundy æ•°ã®å¯¾å¿œ

### ğŸ“Œ ç›¤é¢ã®ç§»å‹•

```
(1,1) (1,2) (1,3) ...
(2,1) (2,2) (2,3) ...
(3,1) (3,2) (3,3) ...
 ...
```

ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ `(a, b)` ã«ã‚ã‚‹ã‚³ãƒã‚’ **å·¦ã¾ãŸã¯ä¸Š** ã«1ãƒã‚¹ä»¥ä¸Šå‹•ã‹ã›ã¾ã™ã€‚
ã¤ã¾ã‚Šï¼š

- å·¦ï¼š`(a, b) â†’ (a, b-1), (a, b-2), ...`
- ä¸Šï¼š`(a, b) â†’ (a-1, b), (a-2, b), ...`

> ã‚ˆã£ã¦ `(a, b)` ã® Grundy æ•°ã¯ `(a-1) ^ (b-1)` ã§è¨ˆç®—ã§ãã¾ã™ã€‚

---

## âœï¸ 4. å…¥åŠ›ä¾‹ã§ã®å›³è§£

### ğŸ”¢ å…¥åŠ›ä¾‹ï¼ˆä¾‹2ï¼‰

```
2 8 4
6 4
7 1
```

#### âœ… ã‚¹ãƒ†ãƒƒãƒ—1ï¼š0-indexed åº§æ¨™ã«å¤‰æ›

```
(6,4) â†’ (5,3)   â† Grundyæ•° = 5 ^ 3 = 6
(7,1) â†’ (6,0)   â† Grundyæ•° = 6 ^ 0 = 6
```

#### âœ… ã‚¹ãƒ†ãƒƒãƒ—2ï¼šå…¨ä½“ã® XOR

```
6 ^ 6 = 0
â†’ XOR = 0 â†’ å¾Œæ‰‹å‹ã¡ï¼ˆSecondï¼‰
```

---

### ğŸ¨ å›³ã§å¯è¦–åŒ–

```
ç›¤é¢ï¼ˆå·¦ä¸ŠãŒ (1,1)ï¼‰

  1   2   3   4
+---+---+---+---+
|   |   |   |   |  â† è¡Œ1
+---+---+---+---+
|   |   |   |   |  â† è¡Œ2
+---+---+---+---+
|   |   |   |   |  â† è¡Œ3
+---+---+---+---+
|   |   |   |   |  â† è¡Œ4
+---+---+---+---+
|   |   |   |   |  â† è¡Œ5
+---+---+---+---+
|   |   |   | P1|  â† è¡Œ6 â† ã‚³ãƒ1ï¼šåº§æ¨™(6,4)
+---+---+---+---+
| P2|   |   |   |  â† è¡Œ7 â† ã‚³ãƒ2ï¼šåº§æ¨™(7,1)
+---+---+---+---+
|   |   |   |   |  â† è¡Œ8
+---+---+---+---+
```

---

## ğŸ› ï¸ 5. å®Ÿè£…è©³ç´°ã”ã¨ã®è§£èª¬

### âœ… `determineWinner` é–¢æ•°

```ts
function determineWinner(N: number, positions: [number, number][]): string {
    let xorSum = 0;
    for (let i = 0; i < N; i++) {
        const [a, b] = positions[i];
        xorSum ^= (a - 1) ^ (b - 1); // Grundy æ•°è¨ˆç®—
    }
    return xorSum === 0 ? 'Second' : 'First';
}
```

#### å‡¦ç†å†…å®¹ï¼š

| å‡¦ç†           | èª¬æ˜                              |
| -------------- | --------------------------------- |
| `(a - 1)`      | 0-indexed ã®è¡Œç•ªå·ï¼ˆ1â†’0, 2â†’1, â€¦ï¼‰ |
| `(b - 1)`      | 0-indexed ã®åˆ—ç•ªå·ï¼ˆåŒä¸Šï¼‰        |
| `^`ï¼ˆXORï¼‰     | Grundy æ•°ã®å®šç¾© `(a-1) ^ (b-1)`   |
| `xorSum ^=`    | å„ã‚³ãƒã® Grundy æ•°ã‚’ç´¯ç© XOR      |
| `xorSum === 0` | XOR ã®ç·å’ŒãŒ0â†’å¾Œæ‰‹å‹ã¡            |

---

### âœ… `main` é–¢æ•°ï¼ˆfså‡¦ç†ï¼‰

```ts
function main(): void {
    const input: string[] = fs.readFileSync('/dev/stdin', 'utf8').trim().split('\n');
    const [N] = input[0].split(' ').map(Number);
    const positions: [number, number][] = input.slice(1).map((line) => {
        const [a, b] = line.split(' ').map(Number);
        return [a, b];
    });
    const result: string = determineWinner(N, positions);
    console.log(result);
}
```

#### å‡¦ç†å†…å®¹ï¼š

| ã‚¹ãƒ†ãƒƒãƒ—              | èª¬æ˜                                   |
| --------------------- | -------------------------------------- |
| `fs.readFileSync`     | é«˜é€ŸãªåŒæœŸèª­ã¿è¾¼ã¿ï¼ˆå…¨ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼‰ |
| `.split('\n')`        | è¡Œå˜ä½ã«åˆ†å‰²                           |
| `input[0].split(' ')` | `N` ã®æŠ½å‡º                             |
| `.map(...)`           | å„ `(a, b)` ã‚’æ•°å€¤é…åˆ—ã«å¤‰æ›           |
| `console.log(result)` | å‹è€…ã‚’å‡ºåŠ›                             |

---

## ğŸ”š çµè«–ï¼šã‚²ãƒ¼ãƒ ç†è«–ã®æ ¸

ã“ã®å•é¡Œã¯ã€**è¤‡æ•°ã® Nim å±±ã®åˆæˆ**ã«ã™ããšã€

- å„ã‚³ãƒ = å±±ï¼ˆçŠ¶æ…‹ï¼‰
- ç§»å‹• = å±±ã‚’æ¸›ã‚‰ã™æ“ä½œ
- Grundy æ•° = ãã®å±±ã®æœ‰åˆ©åº¦
- XORåˆè¨ˆ = å…¨ä½“ã®ã‚²ãƒ¼ãƒ ã®æœ‰åˆ©åº¦

---

## ğŸ” å‚è€ƒï¼šä»–ã®å…¥åŠ›ä¾‹ã§æ¤œè¨¼

### å…¥åŠ›

```
3 10 10
1 1
2 2
3 3
```

Grundy æ•°:

- `(0 ^ 0) = 0`
- `(1 ^ 1) = 0`
- `(2 ^ 2) = 0`

â†’ XOR = `0 ^ 0 ^ 0 = 0` â†’ `Second`

---

ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã§ã¯ã€`determineWinner` é–¢æ•°ã®å†…éƒ¨å‡¦ç†ã«ã¤ã„ã¦ã€**Grundy æ•°ã®æ•°å­¦çš„è¨¼æ˜ãƒ»èƒŒæ™¯ã‚’å«ã‚ãŸè§£èª¬**ã¨ã€**å›³ã«ã‚ˆã‚‹å¯è¦–åŒ–ã¨å‹•ä½œä¾‹**ã‚’é€šã˜ã¦ã€ã‚ˆã‚Šå…·ä½“çš„ã«æ·±æ˜ã‚Šã—ã¦ã„ãã¾ã™ã€‚

---

## âœ… `determineWinner` é–¢æ•°ã®ç›®çš„ã¨æ¦‚è¦

```ts
function determineWinner(N: number, positions: [number, number][]): string {
    let xorSum = 0;
    for (let i = 0; i < N; i++) {
        const [a, b] = positions[i];
        xorSum ^= (a - 1) ^ (b - 1);
    }
    return xorSum === 0 ? 'Second' : 'First';
}
```

ã“ã®é–¢æ•°ã®ç›®çš„ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

> **å„ã‚³ãƒã®ä½ç½®ã‹ã‚‰ Grundy æ•°ã‚’æ±‚ã‚ã¦ XOR ã‚’å–ã‚Šã€æœ€çµ‚çš„ãª XOR ãŒ 0 ãªã‚‰å¾Œæ‰‹å¿…å‹ï¼ˆSecondï¼‰ã€ãã‚Œä»¥å¤–ã¯å…ˆæ‰‹å¿…å‹ï¼ˆFirstï¼‰ã¨åˆ¤å®šã™ã‚‹ã€‚**

---

## ğŸ§  Grundy æ•°ã®ç†è«–èƒŒæ™¯

### ğŸ¯ ã‚²ãƒ¼ãƒ ã®ãƒ«ãƒ¼ãƒ«ï¼ˆå¾©ç¿’ï¼‰

- å„ã‚³ãƒã¯ `(a, b)` ã«é…ç½®
- ç§»å‹•å¯èƒ½ãªæ–¹å‘ã¯ã€Œå·¦ã¾ãŸã¯ä¸Šã« 1ãƒã‚¹ä»¥ä¸Šã€
- ã¤ã¾ã‚Šã€åˆæ³•æ‰‹ï¼š
    - `(a, b) â†’ (a', b)` where `a' < a`
    - `(a, b) â†’ (a, b')` where `b' < b`

---

### ğŸ’¡ é‡è¦ãªäº‹å®Ÿï¼šã“ã®ã‚²ãƒ¼ãƒ ã¯ Nim ã‚²ãƒ¼ãƒ ã®æ‹¡å¼µã§ã‚ã‚‹

Nimã‚²ãƒ¼ãƒ ã§ã¯ã€

- å„å±±ã®ã‚µã‚¤ã‚ºãŒ Grundy æ•°
- ãã‚Œã‚‰ã® XOR ãŒ 0 â†’ è² ã‘ï¼ˆå¾Œæ‰‹å¿…å‹ï¼‰

#### æœ¬å•é¡Œã§ã¯ï¼š

- å„ã‚³ãƒã¯2æ¬¡å…ƒã®ä½ç½® `(a, b)` ã‚’æŒã¤
- æ–¹å‘ãŒç‹¬ç«‹ãªãŸã‚ã€**Grundy æ•° = (a-1) ^ (b-1)** ã§è¨ˆç®—ã§ãã‚‹

> ã“ã®å½¢å¼ã¯ã€Œå·¦ä¸Šã«ã—ã‹å‹•ã‘ãªã„ 2æ¬¡å…ƒã‚³ãƒã®ã‚²ãƒ¼ãƒ ã€ã® Grundy æ•°ã®æ¨™æº–çš„ãªçµæœã§ã™ï¼ˆè¨¼æ˜ã¯å¾Œè¿°ï¼‰

---

## ğŸ”¢ Grundy æ•°ã®è¨¼æ˜ã®ç›´æ„Ÿï¼ˆç°¡ç•¥ï¼‰

### ğŸ² å˜ä½“ã®ã‚³ãƒ `(a, b)` ã«ç€ç›®

- ç§»å‹•å…ˆã®å€™è£œï¼š`(a-1, b)`, `(a-2, b)`, ..., `(1, b)`
  `ã¾ãŸã¯`
  `(a, b-1)`, `(a, b-2)`, ..., `(a, 1)`

ã¤ã¾ã‚Šã€çŠ¶æ…‹ `(a, b)` ã®æ¬¡ã«è¡Œã‘ã‚‹çŠ¶æ…‹ã® Grundy æ•°ã¯ï¼š

```ts
{ (a-1)^b, (a-2)^b, ..., 0^b, a^(b-1), a^(b-2), ..., a^0 }
```

ã“ã®ã‚ˆã†ã«ã€Œã„ã‚ã‚“ãª `aâ€™ ^ b` ã‚„ `a ^ bâ€™`ã€ãŒå‡ºç¾ã—ã¾ã™ã€‚

**Grundy æ•°ã®æ€§è³ªï¼ˆmexï¼‰** ã«ã‚ˆã‚Šã€

- ãã®çŠ¶æ…‹ã‹ã‚‰åˆ°é”ã§ãã‚‹ Grundy æ•°ã®é›†åˆã®ã€Œæœ€å°ã®ä½¿ã‚ã‚Œã¦ã„ãªã„éè² æ•´æ•°ã€ãŒ Grundy æ•°ã«ãªã‚Šã¾ã™ã€‚
- ã“ã®ãƒ«ãƒ¼ãƒ«ã«å¾“ã†ã¨ **(a-1) ^ (b-1)** ãŒæ­£ã—ã„ã“ã¨ãŒå¸°ç´æ³•ãªã©ã§å°ã‘ã¾ã™ã€‚

---

## ğŸ“Š å‡¦ç†ã®è¦–è¦šåŒ–ï¼ˆä¾‹ä»˜ãï¼‰

### å…¥åŠ›ä¾‹

```
3 5 5
1 1
2 2
3 3
```

ã‚³ãƒã®ä½ç½®ï¼ˆ1-indexedï¼‰ï¼š

- ã‚³ãƒ1ï¼š(1,1)
- ã‚³ãƒ2ï¼š(2,2)
- ã‚³ãƒ3ï¼š(3,3)

---

### ğŸ§® Grundy æ•°è¨ˆç®—ï¼ˆ0-indexedï¼‰

| ã‚³ãƒ | åº§æ¨™ (a,b) | 0-indexed (a-1,b-1) | Grundyæ•° `(a-1) ^ (b-1)` |
| ---- | ---------- | ------------------- | ------------------------ |
| 1    | (1,1)      | (0,0)               | 0                        |
| 2    | (2,2)      | (1,1)               | 1 ^ 1 = 0                |
| 3    | (3,3)      | (2,2)               | 2 ^ 2 = 0                |

#### âœ… XOR åˆè¨ˆ

```
0 ^ 0 ^ 0 = 0 â†’ Secondï¼ˆå¾Œæ‰‹ï¼‰å‹ã¡
```

---

### ğŸ§® é€†ã®ä¾‹ï¼ˆFirstãŒå‹ã¤ï¼‰

```
2 5 5
2 3
4 1
```

| ã‚³ãƒ | 0-indexed | Grundyæ•° `(a-1) ^ (b-1)` |
| ---- | --------- | ------------------------ |
| 1    | (1,2)     | 1 ^ 2 = 3                |
| 2    | (3,0)     | 3 ^ 0 = 3                |

```
3 ^ 3 = 0 â†’ Secondï¼ˆå¾Œæ‰‹ï¼‰
```

â†’ ã˜ã‚ƒã‚ã€ `(2, 3)` and `(3, 0)` â†’ Grundy = 1^2 = 3, 3^0 = 3 â†’ XOR = 3^3 = 0

â†’ å¾Œæ‰‹

ã˜ã‚ƒã‚ `(3,3)` and `(2,1)` â†’ 2^2=0, 1^0=1 â†’ 0^1=1 â†’ First å‹ã¡ï¼

---

## ğŸ”„ æœ€çµ‚ã¾ã¨ã‚ï¼šdetermineWinner ã®å…·ä½“çš„å‡¦ç†ãƒ•ãƒ­ãƒ¼

```ts
function determineWinner(N: number, positions: [number, number][]): string {
    let xorSum = 0;

    for (let i = 0; i < N; i++) {
        const [a, b] = positions[i];

        // Grundy æ•°ã®ç®—å‡ºï¼ˆ0-indexedï¼‰
        const grundy = (a - 1) ^ (b - 1);

        // XOR ã«ã‚ˆã‚‹ç´¯ç©
        xorSum ^= grundy;
    }

    // æœ€çµ‚çš„ãª XOR å€¤ã«ã‚ˆã‚Šå‹æ•—åˆ¤å®š
    return xorSum === 0 ? 'Second' : 'First';
}
```

---

## ğŸ§® ã•ã‚‰ã«æ¤œè¨¼ã—ãŸã„å ´åˆ

TypeScript ã§ä¸‹è¨˜ã®ã‚ˆã†ã«ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚‚å¯èƒ½ï¼š

```ts
console.log(`(${a}, ${b}) => (${a - 1}, ${b - 1}) => Grundy: ${(a - 1) ^ (b - 1)}`);
```

---

## âœï¸ è£œè¶³ï¼šGrundy æ•°ã®å‚è€ƒæ–‡çŒ®

- Spragueâ€“Grundy Theoremï¼ˆã‚¹ãƒ—ãƒ¬ã‚¤ã‚°ãƒ»ã‚°ãƒ©ãƒ³ãƒ‡ã‚£å®šç†ï¼‰
- æœ¬å•é¡Œã¯ã€Œå˜ç´”ãªæ–¹å‘åˆ¶é™ä»˜ã 2æ¬¡å…ƒç§»å‹• Nimã€ã®ä¸€ç¨®
- [AtCoder Library: Game Theory](https://atcoder.jp/posts/597)

---

ã•ã‚‰ã«æ·±ã„ä¾‹ã€ã‚³ãƒ¼ãƒ‰ã®å†æ§‹æˆã€ã‚ã‚‹ã„ã¯å‹•ä½œã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¬²ã—ã‘ã‚Œã°ãŠç”³ã—ä»˜ã‘ãã ã•ã„ï¼

| [æå‡ºæ—¥æ™‚](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=created) | å•é¡Œ                                                                           | ãƒ¦ãƒ¼ã‚¶                                            | è¨€èª                                                                                                        | [å¾—ç‚¹](https://atcoder.jp/contests/tessoku-book/submissions/me?desc=true&orderBy=score) | [ã‚³ãƒ¼ãƒ‰é•·](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=source_length) | çµæœ | [å®Ÿè¡Œæ™‚é–“](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=time_consumption) | [ãƒ¡ãƒ¢ãƒª](https://atcoder.jp/contests/tessoku-book/submissions/me?orderBy=memory_consumption) |                                                                       |
| --------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | ---- | -------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |
| 2025-07-25 18:49:53                                                                           | [B33 - Game 6](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_df) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Go (go 1.20.6)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5002)                   | 1000                                                                                    | 1265 Byte                                                                                 |      | 16 ms                                                                                        | 7820 KiB                                                                                     | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67889561) |
| 2025-07-25 18:46:11                                                                           | [B33 - Game 6](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_df) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [PHP (php 8.2.8)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5016)                  | 1000                                                                                    | 1051 Byte                                                                                 |      | 56 ms                                                                                        | 44380 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67889517) |
| 2025-07-25 18:44:23                                                                           | [B33 - Game 6](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_df) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [Python (CPython 3.11.4)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5055)          | 1000                                                                                    | 1117 Byte                                                                                 |      | 85 ms                                                                                        | 23948 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67889487) |
| 2025-07-25 18:19:50                                                                           | [B33 - Game 6](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_df) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [TypeScript 5.1 (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5058) | 1000                                                                                    | 1047 Byte                                                                                 |      | 152 ms                                                                                       | 79032 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67889092) |
| 2025-07-25 18:13:54                                                                           | [B33 - Game 6](https://atcoder.jp/contests/tessoku-book/tasks/tessoku_book_df) | [myoshizumi](https://atcoder.jp/users/myoshizumi) | [JavaScript (Node.js 18.16.1)](https://atcoder.jp/contests/tessoku-book/submissions/me?f.Language=5009)     | 1000                                                                                    | 1079 Byte                                                                                 |      | 124 ms                                                                                       | 77480 KiB                                                                                    | [è©³ç´°](https://atcoder.jp/contests/tessoku-book/submissions/67888970) |
