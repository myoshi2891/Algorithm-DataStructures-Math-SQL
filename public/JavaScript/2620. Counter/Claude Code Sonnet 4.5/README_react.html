<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>LeetCode 2620: Counter - クロージャーによる状態管理</title>

        <!-- Tailwind CSS -->
        <script src="/vendor/tailwindcss/script.js"></script>

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&family=Source+Code+Pro:wght@400;600&display=swap"
            rel="stylesheet"
        />

        <!-- Prism.js CSS -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/line-numbers/prism-line-numbers.css"
        />
        <link
            rel="stylesheet"
            href="/vendor/prismjs/plugins/toolbar/prism-toolbar.css"
        />

        <style>
            html {
                scroll-behavior: smooth;
                font-family: 'Inter', sans-serif;
            }

            /* Prism.js ツールバーカスタマイズ */
            .code-toolbar > .toolbar {
                opacity: 1 !important;
            }

            .code-toolbar > .toolbar button {
                background: #10b981 !important;
                color: white !important;
                padding: 0.5rem 1rem !important;
                border-radius: 0.5rem !important;
                font-weight: 600 !important;
                transition: all 0.2s !important;
            }

            .code-toolbar > .toolbar button:hover {
                background: #059669 !important;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            }

            pre[class*='language-'] {
                font-family: 'JetBrains Mono', 'Source Code Pro', monospace !important;
                border-radius: 1rem !important;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
            }
        </style>
    </head>
    <body class="bg-[linear-gradient(135deg,#f0fdf4,#e0f2fe)] min-h-screen">
        <div class="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
            <!-- ヘッダー -->
            <header
                id="header"
                class="mb-8 rounded-2xl p-8 shadow-[0_10px_30px_rgba(16,185,129,0.10)] bg-[linear-gradient(135deg,#d1fae5,#bfdbfe)]"
            >
                <h1 class="text-[2.5rem] font-bold text-teal-800 mb-2">
                    Counter - クロージャーによる状態管理
                </h1>
                <p class="text-xl text-cyan-700 font-semibold mt-2">
                    クロージャーパターン による O(1) 実装
                </p>
                <nav class="flex flex-wrap gap-4 mt-6">
                    <a
                        href="#overview"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="概要セクションへ移動"
                    >
                        概要
                    </a>
                    <a
                        href="#steps"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="ステップ解説セクションへ移動"
                    >
                        ステップ解説
                    </a>
                    <a
                        href="#code"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="コード実装セクションへ移動"
                    >
                        コード実装
                    </a>
                    <a
                        href="#diagram"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="フローチャートセクションへ移動"
                    >
                        フローチャート
                    </a>
                    <a
                        href="#complexity"
                        class="inline-block px-5 py-2 font-semibold text-slate-700 no-underline rounded-lg border-2 border-slate-200 bg-white transition hover:shadow-[0_10px_20px_rgba(15,118,110,0.20)] hover:-translate-y-0.5 hover:bg-[linear-gradient(180deg,#e8fff6,#c8f1e1)] hover:border-teal-700"
                        aria-label="計算量分析セクションへ移動"
                    >
                        計算量分析
                    </a>
                </nav>
            </header>

            <!-- アルゴリズム概要 -->
            <section id="overview" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    アルゴリズム概要
                </h2>

                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">問題の説明</h3>
                        <p class="text-slate-600 leading-7">
                            整数
                            <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                >n</code
                            >
                            を受け取り、カウンター関数を返す高階関数を実装します。
                            返されたカウンター関数は、初回呼び出し時に
                            <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                >n</code
                            >
                            を返し、 2回目以降は前回の値より1大きい値を返します（<code
                                class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                >n+1</code
                            >,
                            <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                >n+2</code
                            >, ...）。
                        </p>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">入出力例</h3>
                        <div class="bg-slate-50 rounded-xl p-6 border-l-4 border-emerald-500">
                            <p class="font-mono text-sm mb-2">
                                <strong>入力:</strong> n = 10, ["call","call","call"]
                            </p>
                            <p class="font-mono text-sm mb-2">
                                <strong>出力:</strong> [10, 11, 12]
                            </p>
                            <p class="text-slate-600 mt-3">
                                <strong>説明:</strong><br />
                                counter() = 10 // 初回呼び出し、n を返す<br />
                                counter() = 11 // 1増加した値を返す<br />
                                counter() = 12 // さらに1増加した値を返す
                            </p>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">制約条件</h3>
                        <ul class="list-disc list-inside space-y-2 text-slate-600">
                            <li>
                                <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                    >-1000 &lt;= n &lt;= 1000</code
                                >
                            </li>
                            <li>
                                <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                    >0 &lt;= calls.length &lt;= 1000</code
                                >
                            </li>
                            <li>
                                <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                    >calls[i] === "call"</code
                                >
                            </li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">アルゴリズム戦略</h3>
                        <ul class="space-y-3">
                            <li class="flex items-start">
                                <span
                                    class="inline-block w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3"
                                ></span>
                                <span class="text-slate-600"
                                    ><strong class="text-teal-800">クロージャーパターン:</strong>
                                    外部関数のスコープ内の変数を内部関数が保持</span
                                >
                            </li>
                            <li class="flex items-start">
                                <span
                                    class="inline-block w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3"
                                ></span>
                                <span class="text-slate-600"
                                    ><strong class="text-teal-800">後置インクリメント:</strong>
                                    <code
                                        class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                        >n++</code
                                    >
                                    で現在値を返してから増加</span
                                >
                            </li>
                            <li class="flex items-start">
                                <span
                                    class="inline-block w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3"
                                ></span>
                                <span class="text-slate-600"
                                    ><strong class="text-teal-800">状態管理:</strong>
                                    各カウンターインスタンスが独立した状態を保持</span
                                >
                            </li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">主要ポイント</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="bg-emerald-50 rounded-xl p-4 border-l-4 border-emerald-500">
                                <p class="font-semibold text-emerald-800 mb-2">時間計算量</p>
                                <p class="text-2xl font-bold text-emerald-600">O(1)</p>
                                <p class="text-sm text-slate-600 mt-2">各呼び出しで定数時間</p>
                            </div>
                            <div class="bg-cyan-50 rounded-xl p-4 border-l-4 border-cyan-500">
                                <p class="font-semibold text-cyan-800 mb-2">空間計算量</p>
                                <p class="text-2xl font-bold text-cyan-600">O(1)</p>
                                <p class="text-sm text-slate-600 mt-2">単一の数値変数のみ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ステップバイステップ解説 -->
            <section id="steps" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    ステップバイステップ解説
                </h2>
                <div id="react-root"></div>
            </section>

            <!-- TypeScriptコード実装 -->
            <section id="code" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    TypeScript実装
                </h2>
                <pre class="line-numbers"><code class="language-typescript">/**
 * カウンター関数を生成する高階関数
 *
 * @param n - カウンターの初期値 (-1000 <= n <= 1000)
 * @returns 呼び出すたびにインクリメントされる値を返す関数
 * @throws {RangeError} n が制約範囲外の場合
 * @throws {TypeError} n が有限数でない場合
 *
 * @complexity
 * - Time: O(1) for creation and each call
 * - Space: O(1) per counter instance
 *
 * @example
 * const counter = createCounter(10);
 * counter(); // 10
 * counter(); // 11
 * counter(); // 12
 */
function createCounter(n: number): () => number {
    // 入力検証: 制約条件チェック
    if (n < -1000 || n > 1000) {
        throw new RangeError(
            `Initial value ${n} is out of bounds [-1000, 1000]`
        );
    }

    // 型ガード: number型の確認
    if (typeof n !== 'number' || !Number.isFinite(n)) {
        throw new TypeError(
            'Initial value must be a finite number'
        );
    }

    /**
     * カウンター関数（クロージャー）
     *
     * クロージャースコープ内の変数 n を保持し、
     * 呼び出すたびに現在値を返してから1増加させる
     *
     * @returns 現在のカウント値
     *
     * @invariant n は常に整数値を保持
     * @invariant k回目の呼び出しは (初期値 + k - 1) を返す
     */
    return function(): number {
        // 後置インクリメント演算子:
        // 1. 現在の n の値を評価（返却用）
        // 2. n に 1 を加算（次回呼び出し用）
        // 3. ステップ1の値を return
        return n++;
    };
}

// LeetCode 最小提出版
function createCounter(n: number): () => number {
    return function(): number {
        return n++;
    };
}</code></pre>
            </section>

            <!-- フローチャート -->
            <section id="diagram" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    フローチャート
                </h2>
                <div class="mt-[20px] overflow-x-auto">
                    <svg
                        viewBox="0 0 840 900"
                        style="max-width: 100%; height: auto; color: #333"
                        role="img"
                        aria-label="Counter Function flowchart"
                    >
                        <defs>
                            <marker
                                id="arrow"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#64748b" />
                            </marker>
                            <marker
                                id="arrowGreen"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#059669" />
                            </marker>
                            <marker
                                id="arrowRed"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#dc2626" />
                            </marker>
                            <marker
                                id="arrowPurple"
                                markerWidth="10"
                                markerHeight="10"
                                refX="9"
                                refY="3"
                                orient="auto"
                                markerUnits="strokeWidth"
                            >
                                <path d="M0,0 L0,6 L9,3 z" fill="#a855f7" />
                            </marker>
                        </defs>

                        <!-- 開始ノード -->
                        <ellipse
                            cx="420"
                            cy="50"
                            rx="120"
                            ry="35"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="3"
                        />
                        <text
                            x="420"
                            y="50"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="18"
                            font-weight="bold"
                            fill="#047857"
                        >
                            開始 createCounter(n)
                        </text>

                        <!-- 入力検証 -->
                        <path
                            d="M 420 85 L 420 170"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />
                        <path
                            d="M 320 170 L 520 170 L 480 230 L 360 230 Z"
                            fill="#fef3c7"
                            stroke="#f59e0b"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="190"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="bold"
                            fill="#92400e"
                        >
                            入力検証
                        </text>
                        <text
                            x="420"
                            y="210"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#78350f"
                        >
                            範囲チェック
                        </text>

                        <!-- Invalid分岐 -->
                        <path
                            d="M 520 200 L 640 200 L 640 280"
                            stroke="#dc2626"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowRed)"
                        />
                        <text
                            x="580"
                            y="190"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#dc2626"
                            font-weight="bold"
                        >
                            いいえ
                        </text>
                        <rect
                            x="580"
                            y="280"
                            width="120"
                            height="60"
                            rx="8"
                            fill="#fee2e2"
                            stroke="#dc2626"
                            stroke-width="2"
                        />
                        <text
                            x="640"
                            y="300"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="bold"
                            fill="#991b1b"
                        >
                            エラー
                        </text>
                        <text
                            x="640"
                            y="320"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#7f1d1d"
                        >
                            RangeError
                        </text>

                        <!-- Valid分岐 -->
                        <path
                            d="M 420 230 L 420 300"
                            stroke="#059669"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowGreen)"
                        />
                        <text
                            x="460"
                            y="260"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#059669"
                            font-weight="bold"
                        >
                            はい
                        </text>

                        <!-- クロージャー作成 -->
                        <rect
                            x="320"
                            y="300"
                            width="200"
                            height="80"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0284c7"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="325"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="bold"
                            fill="#075985"
                        >
                            クロージャー作成
                        </text>
                        <text
                            x="420"
                            y="350"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#0c4a6e"
                        >
                            変数nをスコープに保持
                        </text>
                        <text
                            x="420"
                            y="370"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#0c4a6e"
                        >
                            内部関数を返却
                        </text>

                        <!-- カウンター関数返却 -->
                        <path
                            d="M 420 380 L 420 435"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />
                        <ellipse
                            cx="420"
                            cy="470"
                            rx="120"
                            ry="35"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="3"
                        />
                        <text
                            x="420"
                            y="470"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="18"
                            font-weight="bold"
                            fill="#047857"
                        >
                            カウンター関数返却
                        </text>

                        <!-- 呼び出しフェーズ -->
                        <path
                            d="M 420 505 L 420 560"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />
                        <rect
                            x="320"
                            y="560"
                            width="200"
                            height="60"
                            rx="8"
                            fill="#e0f2fe"
                            stroke="#0284c7"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="580"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="bold"
                            fill="#075985"
                        >
                            counter() 呼び出し
                        </text>
                        <text
                            x="420"
                            y="600"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#0c4a6e"
                        >
                            クロージャー内のnにアクセス
                        </text>

                        <!-- 後置インクリメント -->
                        <path
                            d="M 420 620 L 420 680"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />
                        <rect
                            x="320"
                            y="680"
                            width="200"
                            height="80"
                            rx="8"
                            fill="#f1f5f9"
                            stroke="#64748b"
                            stroke-width="2"
                        />
                        <text
                            x="420"
                            y="700"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="16"
                            font-weight="bold"
                            fill="#1e293b"
                        >
                            n++ 実行
                        </text>
                        <text
                            x="420"
                            y="725"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#475569"
                        >
                            1. 現在のnを評価
                        </text>
                        <text
                            x="420"
                            y="745"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#475569"
                        >
                            2. nに1を加算
                        </text>

                        <!-- 値を返却 -->
                        <path
                            d="M 420 760 L 420 820"
                            stroke="#64748b"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrow)"
                        />
                        <ellipse
                            cx="420"
                            cy="850"
                            rx="120"
                            ry="35"
                            fill="#d1fae5"
                            stroke="#10b981"
                            stroke-width="3"
                        />
                        <text
                            x="420"
                            y="850"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="18"
                            font-weight="bold"
                            fill="#047857"
                        >
                            元の値を返却
                        </text>

                        <!-- ループバック -->
                        <path
                            d="M 520 590 L 680 590 L 680 470 L 540 470"
                            stroke="#a855f7"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowPurple)"
                        />
                        <text
                            x="580"
                            y="560"
                            text-anchor="middle"
                            dominant-baseline="middle"
                            font-size="14"
                            fill="#a855f7"
                            font-weight="bold"
                        >
                            次回呼び出しへ
                        </text>

                        <!-- エラーから終了 -->
                        <path
                            d="M 640 340 L 640 850 L 540 850"
                            stroke="#dc2626"
                            stroke-width="2"
                            fill="none"
                            marker-end="url(#arrowRed)"
                        />
                    </svg>
                </div>

                <p class="mt-8 font-[Source_Code_Pro] text-[20px] font-semibold leading-relaxed">
                    <strong class="text-2xl text-teal-800">フローの説明：</strong><br />
                    <span class="text-slate-700">
                        1. <strong class="text-emerald-600">入力検証</strong>: n
                        が制約範囲内かチェック（-1000 ≤ n ≤ 1000）<br />
                        2. <strong class="text-red-600">エラー処理</strong>: 範囲外の場合は
                        RangeError をスロー<br />
                        3. <strong class="text-cyan-600">クロージャー作成</strong>: 変数 n
                        をレキシカルスコープに保持した内部関数を生成<br />
                        4. <strong class="text-emerald-600">関数返却</strong>:
                        カウンター関数を呼び出し元に返す<br />
                        5. <strong class="text-cyan-600">counter() 呼び出し</strong>:
                        クロージャー内の n にアクセス<br />
                        6. <strong class="text-slate-600">後置インクリメント</strong>: 現在の n
                        を評価してから 1 を加算<br />
                        7. <strong class="text-emerald-600">値を返却</strong>: 元の n の値を返す<br />
                        8. <strong class="text-purple-600">ループバック</strong>:
                        次回呼び出し時は更新された n で再度実行
                    </span>
                </p>
            </section>

            <!-- 計算量分析 -->
            <section id="complexity" class="bg-white rounded-2xl p-8 mb-8 shadow">
                <h2
                    class="text-[2rem] font-bold text-cyan-700 mb-4 pb-2 border-b-[3px] border-emerald-200"
                >
                    計算量分析
                </h2>

                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">時間計算量</h3>
                        <div class="bg-emerald-50 rounded-xl p-6 border-l-4 border-emerald-500">
                            <p class="text-3xl font-bold text-emerald-600 mb-2">O(1)</p>
                            <ul class="space-y-2 text-slate-600">
                                <li class="flex items-start">
                                    <span
                                        class="inline-block w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3"
                                    ></span>
                                    <span
                                        ><strong>createCounter</strong>: O(1) -
                                        入力検証とクロージャー作成</span
                                    >
                                </li>
                                <li class="flex items-start">
                                    <span
                                        class="inline-block w-2 h-2 bg-emerald-500 rounded-full mt-2 mr-3"
                                    ></span>
                                    <span
                                        ><strong>counter()</strong>: O(1) -
                                        後置インクリメント演算（CPU命令1つ）</span
                                    >
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">空間計算量</h3>
                        <div class="bg-cyan-50 rounded-xl p-6 border-l-4 border-cyan-500">
                            <p class="text-3xl font-bold text-cyan-600 mb-2">O(1)</p>
                            <ul class="space-y-2 text-slate-600">
                                <li class="flex items-start">
                                    <span
                                        class="inline-block w-2 h-2 bg-cyan-500 rounded-full mt-2 mr-3"
                                    ></span>
                                    <span><strong>補助空間</strong>: なし</span>
                                </li>
                                <li class="flex items-start">
                                    <span
                                        class="inline-block w-2 h-2 bg-cyan-500 rounded-full mt-2 mr-3"
                                    ></span>
                                    <span
                                        ><strong>クロージャー変数</strong>: 8バイト（number型）×
                                        カウンター数</span
                                    >
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold text-teal-800 mb-3">アプローチ比較</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr class="bg-slate-100">
                                        <th
                                            class="border border-slate-300 px-4 py-3 text-left font-semibold text-slate-700"
                                        >
                                            アプローチ
                                        </th>
                                        <th
                                            class="border border-slate-300 px-4 py-3 text-center font-semibold text-slate-700"
                                        >
                                            時間
                                        </th>
                                        <th
                                            class="border border-slate-300 px-4 py-3 text-center font-semibold text-slate-700"
                                        >
                                            空間
                                        </th>
                                        <th
                                            class="border border-slate-300 px-4 py-3 text-center font-semibold text-slate-700"
                                        >
                                            型安全性
                                        </th>
                                        <th
                                            class="border border-slate-300 px-4 py-3 text-center font-semibold text-slate-700"
                                        >
                                            実装複雑度
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="bg-emerald-50">
                                        <td
                                            class="border border-slate-300 px-4 py-3 font-semibold text-emerald-800"
                                        >
                                            クロージャー + n++
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center text-emerald-600 font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center text-emerald-600 font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center text-emerald-600"
                                        >
                                            高
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center text-emerald-600"
                                        >
                                            最低
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border border-slate-300 px-4 py-3">
                                            クロージャー + カウント変数
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            高
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            低
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border border-slate-300 px-4 py-3">
                                            Class ベース
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            高
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            中
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="border border-slate-300 px-4 py-3">
                                            Generator 関数
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td
                                            class="border border-slate-300 px-4 py-3 text-center font-mono"
                                        >
                                            O(1)
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            中
                                        </td>
                                        <td class="border border-slate-300 px-4 py-3 text-center">
                                            中
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p class="mt-4 text-slate-600">
                            <strong class="text-teal-800">推奨:</strong> クロージャー +
                            <code class="bg-slate-100 px-2 py-1 rounded text-teal-700 font-mono"
                                >n++</code
                            >
                            が最もシンプルで LeetCode の期待解
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <!-- React + ReactDOM -->
        <script crossorigin src="/vendor/react/react.development.js"></script>
        <script
            crossorigin
            src="/vendor/react-dom/react-dom.development.js"
        ></script>

        <!-- Babel Standalone -->
        <script src="/vendor/babel/babel.min.js"></script>

        <!-- Prism.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

        <!-- React Component -->
        <script type="text/babel">
            const { useState, useEffect, useRef } = React;

            // ステップデータ
            const stepsData = [
                {
                    step: 1,
                    title: '初期化',
                    desc: 'createCounter(10) を呼び出し、クロージャーを作成します。変数 n = 10 がレキシカルスコープに保持されます。',
                    visual: {
                        type: 'init',
                        n: 10,
                        callCount: 0,
                    },
                },
                {
                    step: 2,
                    title: '1回目の呼び出し',
                    desc: 'counter() を1回目に呼び出します。後置インクリメント n++ により、現在の値 10 を評価します。',
                    visual: {
                        type: 'call1',
                        n: 10,
                        returnValue: 10,
                        callCount: 1,
                    },
                },
                {
                    step: 3,
                    title: '1回目の更新',
                    desc: 'n++ の後半処理により、n に 1 が加算されます。内部状態が n = 11 に更新されました。',
                    visual: {
                        type: 'update1',
                        n: 11,
                        previousValue: 10,
                        callCount: 1,
                    },
                },
                {
                    step: 4,
                    title: '2回目の呼び出し',
                    desc: 'counter() を2回目に呼び出します。更新された n = 11 を評価します。',
                    visual: {
                        type: 'call2',
                        n: 11,
                        returnValue: 11,
                        callCount: 2,
                    },
                },
                {
                    step: 5,
                    title: '2回目の更新',
                    desc: 'n に 1 が加算され、内部状態が n = 12 に更新されました。',
                    visual: {
                        type: 'update2',
                        n: 12,
                        previousValue: 11,
                        callCount: 2,
                    },
                },
                {
                    step: 6,
                    title: '3回目の呼び出し',
                    desc: 'counter() を3回目に呼び出します。n = 12 を評価します。',
                    visual: {
                        type: 'call3',
                        n: 12,
                        returnValue: 12,
                        callCount: 3,
                    },
                },
                {
                    step: 7,
                    title: '3回目の更新',
                    desc: 'n に 1 が加算され、内部状態が n = 13 に更新されました。',
                    visual: {
                        type: 'update3',
                        n: 13,
                        previousValue: 12,
                        callCount: 3,
                    },
                },
                {
                    step: 8,
                    title: '結果の確認',
                    desc: '3回の呼び出しで [10, 11, 12] が返されました。次回呼び出し時は 13 が返されます。',
                    visual: {
                        type: 'result',
                        results: [10, 11, 12],
                        nextValue: 13,
                    },
                },
            ];

            // 視覚化コンポーネント
            function StepVisualization({ visual }) {
                if (visual.type === 'init') {
                    return (
                        <svg
                            viewBox="0 0 600 300"
                            style={{ marginTop: '20px', maxWidth: '100%', height: 'auto' }}
                        >
                            <defs>
                                <marker
                                    id="arrowGray"
                                    markerWidth="10"
                                    markerHeight="10"
                                    refX="9"
                                    refY="3"
                                    orient="auto"
                                >
                                    <path d="M0,0 L0,6 L9,3 z" fill="#64748b" />
                                </marker>
                            </defs>

                            {/* タイトル */}
                            <text
                                x="300"
                                y="30"
                                textAnchor="middle"
                                fontSize="20"
                                fontWeight="bold"
                                fill="#0f766e"
                            >
                                初期化: createCounter(10)
                            </text>

                            {/* クロージャースコープ */}
                            <rect
                                x="150"
                                y="70"
                                width="300"
                                height="180"
                                rx="12"
                                fill="#ecfdf5"
                                stroke="#10b981"
                                strokeWidth="3"
                                strokeDasharray="8,4"
                            />
                            <text
                                x="300"
                                y="100"
                                textAnchor="middle"
                                fontSize="16"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                クロージャースコープ
                            </text>

                            {/* 変数n */}
                            <rect
                                x="220"
                                y="130"
                                width="160"
                                height="70"
                                rx="8"
                                fill="#d1fae5"
                                stroke="#10b981"
                                strokeWidth="2"
                            />
                            <text
                                x="300"
                                y="155"
                                textAnchor="middle"
                                fontSize="18"
                                fontWeight="bold"
                                fill="#047857"
                            >
                                変数 n
                            </text>
                            <text
                                x="300"
                                y="185"
                                textAnchor="middle"
                                fontSize="32"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                {visual.n}
                            </text>

                            {/* 説明 */}
                            <text x="300" y="270" textAnchor="middle" fontSize="14" fill="#475569">
                                内部関数が変数 n を保持
                            </text>
                        </svg>
                    );
                }

                if (visual.type === 'call1' || visual.type === 'call2' || visual.type === 'call3') {
                    return (
                        <svg
                            viewBox="0 0 600 350"
                            style={{ marginTop: '20px', maxWidth: '100%', height: 'auto' }}
                        >
                            <defs>
                                <marker
                                    id="arrowGreen"
                                    markerWidth="10"
                                    markerHeight="10"
                                    refX="9"
                                    refY="3"
                                    orient="auto"
                                >
                                    <path d="M0,0 L0,6 L9,3 z" fill="#059669" />
                                </marker>
                            </defs>

                            {/* タイトル */}
                            <text
                                x="300"
                                y="30"
                                textAnchor="middle"
                                fontSize="20"
                                fontWeight="bold"
                                fill="#0f766e"
                            >
                                {visual.callCount}回目の呼び出し
                            </text>

                            {/* クロージャースコープ */}
                            <rect
                                x="150"
                                y="70"
                                width="300"
                                height="200"
                                rx="12"
                                fill="#ecfdf5"
                                stroke="#10b981"
                                strokeWidth="3"
                                strokeDasharray="8,4"
                            />
                            <text
                                x="300"
                                y="100"
                                textAnchor="middle"
                                fontSize="16"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                クロージャースコープ
                            </text>

                            {/* 変数n（現在値） */}
                            <rect
                                x="220"
                                y="130"
                                width="160"
                                height="70"
                                rx="8"
                                fill="#fef3c7"
                                stroke="#f59e0b"
                                strokeWidth="3"
                            />
                            <text
                                x="300"
                                y="155"
                                textAnchor="middle"
                                fontSize="18"
                                fontWeight="bold"
                                fill="#92400e"
                            >
                                n++ 実行中
                            </text>
                            <text
                                x="300"
                                y="185"
                                textAnchor="middle"
                                fontSize="32"
                                fontWeight="bold"
                                fill="#d97706"
                            >
                                {visual.n}
                            </text>

                            {/* 矢印 */}
                            <path
                                d="M 300 200 L 300 240"
                                stroke="#059669"
                                strokeWidth="3"
                                fill="none"
                                markerEnd="url(#arrowGreen)"
                            />

                            {/* 返却値 */}
                            <rect
                                x="220"
                                y="240"
                                width="160"
                                height="50"
                                rx="8"
                                fill="#d1fae5"
                                stroke="#10b981"
                                strokeWidth="2"
                            />
                            <text
                                x="300"
                                y="255"
                                textAnchor="middle"
                                fontSize="14"
                                fontWeight="bold"
                                fill="#047857"
                            >
                                返却値
                            </text>
                            <text
                                x="300"
                                y="280"
                                textAnchor="middle"
                                fontSize="28"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                {visual.returnValue}
                            </text>

                            {/* 説明 */}
                            <text x="300" y="330" textAnchor="middle" fontSize="14" fill="#475569">
                                現在の n の値を評価して返す
                            </text>
                        </svg>
                    );
                }

                if (
                    visual.type === 'update1' ||
                    visual.type === 'update2' ||
                    visual.type === 'update3'
                ) {
                    return (
                        <svg
                            viewBox="0 0 600 350"
                            style={{ marginTop: '20px', maxWidth: '100%', height: 'auto' }}
                        >
                            <defs>
                                <marker
                                    id="arrowPurple"
                                    markerWidth="10"
                                    markerHeight="10"
                                    refX="9"
                                    refY="3"
                                    orient="auto"
                                >
                                    <path d="M0,0 L0,6 L9,3 z" fill="#a855f7" />
                                </marker>
                            </defs>

                            {/* タイトル */}
                            <text
                                x="300"
                                y="30"
                                textAnchor="middle"
                                fontSize="20"
                                fontWeight="bold"
                                fill="#0f766e"
                            >
                                {visual.callCount}回目の更新
                            </text>

                            {/* クロージャースコープ */}
                            <rect
                                x="150"
                                y="70"
                                width="300"
                                height="230"
                                rx="12"
                                fill="#ecfdf5"
                                stroke="#10b981"
                                strokeWidth="3"
                                strokeDasharray="8,4"
                            />
                            <text
                                x="300"
                                y="100"
                                textAnchor="middle"
                                fontSize="16"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                クロージャースコープ
                            </text>

                            {/* 前の値 */}
                            <rect
                                x="170"
                                y="130"
                                width="120"
                                height="60"
                                rx="8"
                                fill="#f1f5f9"
                                stroke="#94a3b8"
                                strokeWidth="2"
                            />
                            <text x="230" y="150" textAnchor="middle" fontSize="14" fill="#64748b">
                                前の値
                            </text>
                            <text
                                x="230"
                                y="175"
                                textAnchor="middle"
                                fontSize="24"
                                fontWeight="bold"
                                fill="#94a3b8"
                            >
                                {visual.previousValue}
                            </text>

                            {/* 矢印 */}
                            <path
                                d="M 290 160 L 310 160"
                                stroke="#a855f7"
                                strokeWidth="3"
                                fill="none"
                                markerEnd="url(#arrowPurple)"
                            />
                            <text
                                x="300"
                                y="145"
                                textAnchor="middle"
                                fontSize="14"
                                fontWeight="bold"
                                fill="#a855f7"
                            >
                                + 1
                            </text>

                            {/* 新しい値 */}
                            <rect
                                x="310"
                                y="130"
                                width="120"
                                height="60"
                                rx="8"
                                fill="#ddd6fe"
                                stroke="#a855f7"
                                strokeWidth="3"
                            />
                            <text
                                x="370"
                                y="150"
                                textAnchor="middle"
                                fontSize="14"
                                fontWeight="bold"
                                fill="#7c3aed"
                            >
                                新しい値
                            </text>
                            <text
                                x="370"
                                y="175"
                                textAnchor="middle"
                                fontSize="24"
                                fontWeight="bold"
                                fill="#a855f7"
                            >
                                {visual.n}
                            </text>

                            {/* 更新後の状態 */}
                            <rect
                                x="220"
                                y="220"
                                width="160"
                                height="60"
                                rx="8"
                                fill="#d1fae5"
                                stroke="#10b981"
                                strokeWidth="2"
                            />
                            <text
                                x="300"
                                y="240"
                                textAnchor="middle"
                                fontSize="14"
                                fontWeight="bold"
                                fill="#047857"
                            >
                                更新後の n
                            </text>
                            <text
                                x="300"
                                y="265"
                                textAnchor="middle"
                                fontSize="28"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                {visual.n}
                            </text>

                            {/* 説明 */}
                            <text x="300" y="330" textAnchor="middle" fontSize="14" fill="#475569">
                                n に 1 が加算されました
                            </text>
                        </svg>
                    );
                }

                if (visual.type === 'result') {
                    return (
                        <svg
                            viewBox="0 0 600 300"
                            style={{ marginTop: '20px', maxWidth: '100%', height: 'auto' }}
                        >
                            {/* タイトル */}
                            <text
                                x="300"
                                y="30"
                                textAnchor="middle"
                                fontSize="20"
                                fontWeight="bold"
                                fill="#0f766e"
                            >
                                結果の確認
                            </text>

                            {/* 結果の配列 */}
                            <text
                                x="300"
                                y="70"
                                textAnchor="middle"
                                fontSize="16"
                                fontWeight="bold"
                                fill="#059669"
                            >
                                返された値の配列
                            </text>

                            {visual.results.map((val, idx) => (
                                <g key={idx}>
                                    <rect
                                        x={150 + idx * 100}
                                        y="90"
                                        width="80"
                                        height="70"
                                        rx="8"
                                        fill="#d1fae5"
                                        stroke="#10b981"
                                        strokeWidth="2"
                                    />
                                    <text
                                        x={190 + idx * 100}
                                        y="115"
                                        textAnchor="middle"
                                        fontSize="14"
                                        fill="#047857"
                                    >
                                        {idx + 1}回目
                                    </text>
                                    <text
                                        x={190 + idx * 100}
                                        y="145"
                                        textAnchor="middle"
                                        fontSize="32"
                                        fontWeight="bold"
                                        fill="#059669"
                                    >
                                        {val}
                                    </text>
                                </g>
                            ))}

                            {/* 次の値 */}
                            <text
                                x="300"
                                y="200"
                                textAnchor="middle"
                                fontSize="16"
                                fontWeight="bold"
                                fill="#a855f7"
                            >
                                次回呼び出し時の返却値
                            </text>
                            <rect
                                x="250"
                                y="220"
                                width="100"
                                height="60"
                                rx="8"
                                fill="#ddd6fe"
                                stroke="#a855f7"
                                strokeWidth="3"
                            />
                            <text
                                x="300"
                                y="260"
                                textAnchor="middle"
                                fontSize="32"
                                fontWeight="bold"
                                fill="#a855f7"
                            >
                                {visual.nextValue}
                            </text>
                        </svg>
                    );
                }

                return null;
            }

            // メインコンポーネント
            function StepByStepApp() {
                const [activeStep, setActiveStep] = useState(1);
                const [isPlaying, setIsPlaying] = useState(false);
                const timerRef = useRef(null);

                // 自動再生ロジック（v3.3）
                useEffect(() => {
                    if (isPlaying) {
                        if (activeStep > stepsData.length) {
                            setIsPlaying(false);
                            setActiveStep(1);
                            return;
                        }

                        timerRef.current = setTimeout(() => {
                            if (activeStep === stepsData.length) {
                                setActiveStep(1);
                                setIsPlaying(false);
                            } else {
                                setActiveStep((prev) => prev + 1);
                            }
                        }, 2000);
                    }
                    return () => {
                        if (timerRef.current) clearTimeout(timerRef.current);
                    };
                }, [isPlaying, activeStep]);

                const handlePlay = () => {
                    if (isPlaying) return;
                    setActiveStep(1);
                    setIsPlaying(true);
                };

                const handlePrev = () => {
                    if (activeStep > 1) {
                        setActiveStep((prev) => prev - 1);
                        setIsPlaying(false);
                    }
                };

                const handleNext = () => {
                    if (activeStep < stepsData.length) {
                        setActiveStep((prev) => prev + 1);
                        setIsPlaying(false);
                    }
                };

                const handleReset = () => {
                    setActiveStep(1);
                    setIsPlaying(false);
                };

                const handleStepClick = (step) => {
                    setActiveStep(step);
                    setIsPlaying(false);
                };

                const currentStepData =
                    stepsData.find((s) => s.step === activeStep) || stepsData[0];

                return (
                    <div className="grid grid-cols-1 md:grid-cols-[1fr_2fr] gap-8 mt-2">
                        {/* 左: ステップリスト */}
                        <div>
                            <h3 className="mt-0 mb-4 text-teal-800 text-xl font-semibold">
                                ステップ一覧
                            </h3>
                            <div className="space-y-2">
                                {stepsData.map((step) => {
                                    const isActive = activeStep === step.step;
                                    return (
                                        <button
                                            key={step.step}
                                            type="button"
                                            className={[
                                                'w-full text-left text-[0.95rem] rounded-xl border-2 transition cursor-pointer px-4 py-4',
                                                'bg-white border-slate-200 hover:border-emerald-500 hover:translate-x-1',
                                                isActive
                                                    ? 'bg-[linear-gradient(135deg,#d1fae5,#a7f3d0)] border-emerald-500 shadow-[0_4px_12px_rgba(16,185,129,0.20)]'
                                                    : '',
                                            ].join(' ')}
                                            onClick={() => handleStepClick(step.step)}
                                            aria-label={`ステップ${step.step}: ${step.title}`}
                                            aria-current={isActive ? 'step' : undefined}
                                        >
                                            <div
                                                className={[
                                                    'font-bold mb-1',
                                                    isActive ? 'text-emerald-900' : 'text-teal-800',
                                                ].join(' ')}
                                            >
                                                Step {step.step}: {step.title}
                                            </div>
                                            <div className="text-slate-500 text-sm mt-1">
                                                {step.desc.substring(0, 50)}
                                                {step.desc.length > 50 ? '...' : ''}
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* 右: 可視化 + コントロール */}
                        <div className="my-auto">
                            <div className="rounded-2xl p-8 mt-10 border-2 border-emerald-200 bg-[linear-gradient(135deg,#ecfdf5,#f0f9ff)]">
                                <h3 className="mt-0 text-teal-800 text-xl font-semibold">
                                    Step {currentStepData.step}: {currentStepData.title}
                                </h3>
                                <p className="text-slate-600 leading-7">{currentStepData.desc}</p>
                            </div>

                            <StepVisualization visual={currentStepData.visual} />

                            <div className="flex flex-wrap justify-center gap-2 mt-1">
                                <button
                                    type="button"
                                    className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(16,185,129,0.30)] bg-[linear-gradient(135deg,#10b981,#059669)]"
                                    onClick={handlePlay}
                                    disabled={isPlaying}
                                    aria-label="自動再生"
                                >
                                    ▶ Play
                                </button>
                                <button
                                    type="button"
                                    className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(14,165,233,0.30)] bg-[linear-gradient(135deg,#0ea5e9,#0284c7)]"
                                    onClick={handlePrev}
                                    disabled={activeStep === 1}
                                    aria-label="前のステップ"
                                >
                                    ◀ Prev
                                </button>
                                <button
                                    type="button"
                                    className="px-6 py-3 rounded-xl font-semibold text-white transition disabled:opacity-50 shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(14,165,233,0.30)] bg-[linear-gradient(135deg,#0ea5e9,#0284c7)]"
                                    onClick={handleNext}
                                    disabled={activeStep === stepsData.length}
                                    aria-label="次のステップ"
                                >
                                    Next ▶
                                </button>
                                <button
                                    type="button"
                                    className="px-6 py-3 rounded-xl font-semibold text-white transition shadow hover:-translate-y-0.5 hover:shadow-[0_8px_16px_rgba(100,116,139,0.30)] bg-[linear-gradient(135deg,#64748b,#475569)]"
                                    onClick={handleReset}
                                    aria-label="リセット"
                                >
                                    ↻ Reset
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // レンダリング
            const root = ReactDOM.createRoot(document.getElementById('react-root'));
            root.render(<StepByStepApp />);
        </script>
    </body>
</html>
