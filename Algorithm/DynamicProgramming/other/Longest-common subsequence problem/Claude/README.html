<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DPã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼šæœ€é•·é€†èƒŒã®é †åŒºé–“è§£æ</title>

        <!-- Prism.js CSS -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #333;
                line-height: 1.6;
                min-height: 100vh;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
            }

            h1 {
                text-align: center;
                color: white;
                font-size: 2.5rem;
                margin-bottom: 30px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }

            .section {
                background: white;
                margin: 20px 0;
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .section:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            }

            .section h2 {
                color: #4a5568;
                margin-bottom: 20px;
                font-size: 1.8rem;
                border-left: 4px solid #667eea;
                padding-left: 15px;
            }

            /* Code blocks */
            pre[class*="language-"] {
                margin: 20px 0;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
                font-size: 14px;
                line-height: 1.5;
                overflow-x: auto;
            }

            code[class*="language-"] {
                font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            }

            .line-numbers .line-numbers-rows {
                border-right: 1px solid #3c4043;
            }

            /* Visual simulation */
            .simulation-container {
                background: #f8f9fa;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
                border: 2px solid #e9ecef;
            }

            .array-visualization {
                display: flex;
                justify-content: center;
                align-items: flex-end;
                margin: 20px 0;
                padding: 20px;
                background: white;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }

            .height-bar {
                width: 60px;
                margin: 0 5px;
                background: linear-gradient(135deg, #667eea, #764ba2);
                border-radius: 8px 8px 0 0;
                display: flex;
                flex-direction: column;
                align-items: center;
                color: white;
                font-weight: bold;
                position: relative;
                transition: all 0.3s ease;
                cursor: pointer;
            }

            .height-bar:hover {
                transform: scale(1.1);
                z-index: 10;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .height-value {
                position: absolute;
                top: -25px;
                background: #333;
                color: white;
                padding: 2px 6px;
                border-radius: 4px;
                font-size: 12px;
            }

            .index-label {
                position: absolute;
                bottom: -25px;
                color: #666;
                font-size: 12px;
            }

            .dp-table {
                width: 100%;
                border-collapse: collapse;
                margin: 20px 0;
                background: white;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            }

            .dp-table th,
            .dp-table td {
                padding: 12px;
                text-align: center;
                border: 1px solid #e9ecef;
                transition: background-color 0.3s ease;
            }

            .dp-table th {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                font-weight: bold;
            }

            .dp-table tr:hover td {
                background-color: #f8f9fa;
            }

            .highlight {
                background-color: #fff3cd !important;
                border: 2px solid #ffc107 !important;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.05);
                }

                100% {
                    transform: scale(1);
                }
            }

            .step-explanation {
                background: #e7f3ff;
                border-left: 4px solid #2196f3;
                padding: 15px;
                margin: 15px 0;
                border-radius: 0 8px 8px 0;
            }

            .algorithm-flow {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin: 20px 0;
                flex-wrap: wrap;
            }

            .flow-step {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                padding: 15px 20px;
                border-radius: 25px;
                margin: 10px;
                flex: 1;
                min-width: 200px;
                text-align: center;
                font-weight: bold;
                position: relative;
                transition: all 0.3s ease;
            }

            .flow-step:hover {
                transform: scale(1.05);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .flow-step::after {
                content: 'â†’';
                position: absolute;
                right: -20px;
                top: 50%;
                transform: translateY(-50%);
                font-size: 20px;
                color: #667eea;
            }

            .flow-step:last-child::after {
                display: none;
            }

            .complexity-box {
                background: linear-gradient(135deg, #ff6b6b, #feca57);
                color: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                margin: 20px 0;
                font-size: 1.2rem;
                font-weight: bold;
            }

            .interactive-btn {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 25px;
                cursor: pointer;
                font-size: 16px;
                font-weight: bold;
                margin: 10px;
                transition: all 0.3s ease;
            }

            .interactive-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            @media (max-width: 768px) {
                .algorithm-flow {
                    flex-direction: column;
                }

                .flow-step::after {
                    content: 'â†“';
                    right: auto;
                    bottom: -20px;
                    top: auto;
                }

                .array-visualization {
                    overflow-x: auto;
                }
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>ğŸ”„ DPã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼šæœ€é•·é€†èƒŒã®é †åŒºé–“è§£æ</h1>

            <div class="section">
                <h2>ğŸ“‹ å•é¡Œæ¦‚è¦</h2>
                <p>näººãŒæ¨ªä¸€åˆ—ã«ä¸¦ã‚“ã§ãŠã‚Šã€åŒºé–“[l, r]å†…ã§èº«é•·ãŒéå¢—åŠ ï¼ˆa[i] â‰¥ a[i+1]ï¼‰ã«ãªã£ã¦ã„ã‚‹æœ€é•·åŒºé–“ã®é•·ã•ã‚’æ±‚ã‚ã‚‹å•é¡Œã§ã™ã€‚</p>

                <div class="step-explanation">
                    <strong>å…¥åŠ›ä¾‹ï¼š</strong> heights = [187, 192, 115, 108, 109]<br>
                    <strong>æœŸå¾…å‡ºåŠ›ï¼š</strong> 3ï¼ˆåŒºé–“[1,3]: 192 â†’ 115 â†’ 108ï¼‰
                </div>
            </div>

            <div class="section">
                <h2>ğŸ“Š å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®è¦–è¦šåŒ–</h2>
                <div class="simulation-container">
                    <div class="array-visualization" id="heightsViz">
                        <!-- JavaScript ã§å‹•çš„ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ§® å‹•çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è§£æ³•</h2>

                <div class="algorithm-flow">
                    <div class="flow-step">åˆæœŸåŒ–<br>dp[0] = 1</div>
                    <div class="flow-step">é·ç§»å¼é©ç”¨<br>æ¯”è¼ƒãƒ»æ›´æ–°</div>
                    <div class="flow-step">æœ€å¤§å€¤å–å¾—<br>max(dp)</div>
                </div>

                <pre class="line-numbers"><code class="language-python">def find_longest_decreasing_interval_dp_optimized(n: int, heights: list[int]) -> int:
    """
    ç©ºé–“æœ€é©åŒ–ç‰ˆã®DPè§£æ³•
    
    Args:
        n (int): äººæ•°
        heights (list[int]): å„äººã®èº«é•·ã®ãƒªã‚¹ãƒˆ
    
    Returns:
        int: æœ€é•·ã®é€†èƒŒã®é †åŒºé–“ã®é•·ã•
    
    Time Complexity: O(n)
    Space Complexity: O(1)
    """
    if n == 0:
        return 0
    if n == 1:
        return 1
    
    max_length: int = 1  # å…¨ä½“ã§ã®æœ€å¤§é•·
    current_dp: int = 1  # dp[i]ã«ç›¸å½“ï¼ˆç¾åœ¨ä½ç½®ã§ã®æœ€é•·åŒºé–“é•·ï¼‰
    
    for i in range(1, n):
        if heights[i-1] >= heights[i]:  # éå¢—åŠ æ¡ä»¶ã‚’æº€ãŸã™å ´åˆ
            current_dp += 1  # å‰ã®åŒºé–“ã‚’å»¶é•·
        else:
            current_dp = 1  # æ–°ã—ã„åŒºé–“é–‹å§‹
        
        max_length = max(max_length, current_dp)
    
    return max_length</code></pre>
            </div>

            <div class="section">
                <h2>ğŸ” ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—è§£æ</h2>
                <div class="simulation-container">
                    <button class="interactive-btn" onclick="runSimulation()">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ</button>
                    <button class="interactive-btn" onclick="resetSimulation()">ãƒªã‚»ãƒƒãƒˆ</button>

                    <table class="dp-table" id="dpTable">
                        <thead>
                            <tr>
                                <th>ã‚¹ãƒ†ãƒƒãƒ—</th>
                                <th>i</th>
                                <th>heights[i-1]</th>
                                <th>heights[i]</th>
                                <th>æ¡ä»¶</th>
                                <th>current_dp</th>
                                <th>max_length</th>
                            </tr>
                        </thead>
                        <tbody id="dpTableBody">
                            <!-- JavaScript ã§å‹•çš„ç”Ÿæˆ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>âš¡ è¨ˆç®—é‡è§£æ</h2>
                <div class="complexity-box">
                    <div>â±ï¸ æ™‚é–“è¨ˆç®—é‡: O(n)</div>
                    <div>ğŸ’¾ ç©ºé–“è¨ˆç®—é‡: O(1)</div>
                </div>

                <div class="step-explanation">
                    <strong>æœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆï¼š</strong>
                    <ul>
                        <li>DPãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã‚’ä¿æŒã›ãšã€å¿…è¦ãªçŠ¶æ…‹ã®ã¿è¨˜éŒ²</li>
                        <li>ä¸€å›ã®ã‚¹ã‚­ãƒ£ãƒ³ã§æœ€é©è§£ã‚’å–å¾—</li>
                        <li>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å®šæ•°ã«æŠ‘åˆ¶</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>ğŸ¯ 3ã¤ã®DPæ‰‹æ³•æ¯”è¼ƒ</h2>

                <pre class="line-numbers"><code class="language-python"># æ‰‹æ³•1: åŸºæœ¬DPï¼ˆé…åˆ—ç‰ˆï¼‰
def basic_dp(n: int, heights: list[int]) -> int:
    dp = [1] * n  # O(n)ç©ºé–“
    for i in range(1, n):
        if heights[i-1] >= heights[i]:
            dp[i] = dp[i-1] + 1
        else:
            dp[i] = 1
    return max(dp)

# æ‰‹æ³•2: ç©ºé–“æœ€é©åŒ–ç‰ˆï¼ˆæ¨å¥¨ï¼‰
def optimized_dp(n: int, heights: list[int]) -> int:
    max_length, current_dp = 1, 1  # O(1)ç©ºé–“
    for i in range(1, n):
        if heights[i-1] >= heights[i]:
            current_dp += 1
        else:
            current_dp = 1
        max_length = max(max_length, current_dp)
    return max_length

# æ‰‹æ³•3: å…¨åŒºé–“DPï¼ˆå‚è€ƒç”¨ï¼‰
def all_intervals_dp(n: int, heights: list[int]) -> int:
    dp = [[False] * n for _ in range(n)]  # O(nÂ²)ç©ºé–“
    # å…¨åŒºé–“ã‚’2é‡ãƒ«ãƒ¼ãƒ—ã§ç¢ºèª O(nÂ²)æ™‚é–“
    # ...</code></pre>
            </div>
        </div>

        <!-- Prism.js JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

        <script>
            // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
            const sampleHeights = [187, 192, 115, 108, 109];
            let currentStep = 0;
            let simulationData = [];

            // é«˜ã•ãƒ‡ãƒ¼ã‚¿ã®è¦–è¦šåŒ–
            function visualizeHeights() {
                const container = document.getElementById('heightsViz');
                const maxHeight = Math.max(...sampleHeights);

                container.innerHTML = '';
                sampleHeights.forEach((height, index) => {
                    const bar = document.createElement('div');
                    bar.className = 'height-bar';
                    bar.style.height = `${(height / maxHeight) * 150}px`;

                    const heightValue = document.createElement('div');
                    heightValue.className = 'height-value';
                    heightValue.textContent = height;

                    const indexLabel = document.createElement('div');
                    indexLabel.className = 'index-label';
                    indexLabel.textContent = index;

                    bar.appendChild(heightValue);
                    bar.appendChild(indexLabel);
                    container.appendChild(bar);

                    // ãƒ›ãƒãƒ¼åŠ¹æœ
                    bar.addEventListener('mouseenter', () => {
                        bar.style.transform = 'scale(1.1)';
                        heightValue.style.background = '#667eea';
                    });

                    bar.addEventListener('mouseleave', () => {
                        bar.style.transform = 'scale(1)';
                        heightValue.style.background = '#333';
                    });
                });
            }

            // DPã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
            function generateSimulationData() {
                simulationData = [];
                let maxLength = 1;
                let currentDp = 1;

                simulationData.push({
                    step: 0,
                    i: 0,
                    prevHeight: '-',
                    currHeight: sampleHeights[0],
                    condition: 'åˆæœŸå€¤',
                    currentDp: 1,
                    maxLength: 1
                });

                for (let i = 1; i < sampleHeights.length; i++) {
                    if (sampleHeights[i - 1] >= sampleHeights[i]) {
                        currentDp += 1;
                    } else {
                        currentDp = 1;
                    }
                    maxLength = Math.max(maxLength, currentDp);

                    simulationData.push({
                        step: i,
                        i: i,
                        prevHeight: sampleHeights[i - 1],
                        currHeight: sampleHeights[i],
                        condition: sampleHeights[i - 1] >= sampleHeights[i] ? `${sampleHeights[i - 1]} â‰¥ ${sampleHeights[i]} âœ…` : `${sampleHeights[i - 1]} < ${sampleHeights[i]} âŒ`,
                        currentDp: currentDp,
                        maxLength: maxLength
                    });
                }
            }

            // DPãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸè¡¨ç¤º
            function initializeTable() {
                const tbody = document.getElementById('dpTableBody');
                tbody.innerHTML = '';

                simulationData.forEach((data, index) => {
                    const row = document.createElement('tr');
                    row.id = `row-${index}`;
                    row.innerHTML = `
                    <td>${data.step}</td>
                    <td>${data.i}</td>
                    <td>${data.prevHeight}</td>
                    <td>${data.currHeight}</td>
                    <td>${data.condition}</td>
                    <td>${data.currentDp}</td>
                    <td>${data.maxLength}</td>
                `;
                    tbody.appendChild(row);
                });
            }

            // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
            function runSimulation() {
                currentStep = 0;
                const interval = setInterval(() => {
                    if (currentStep < simulationData.length) {
                        // å‰ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’å‰Šé™¤
                        document.querySelectorAll('.highlight').forEach(el => {
                            el.classList.remove('highlight');
                        });

                        // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                        const currentRow = document.getElementById(`row-${currentStep}`);
                        currentRow.classList.add('highlight');

                        // é«˜ã•ãƒãƒ¼ã‚‚ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                        const bars = document.querySelectorAll('.height-bar');
                        bars.forEach((bar, index) => {
                            bar.style.opacity = index <= currentStep ? '1' : '0.3';
                        });

                        currentStep++;
                    } else {
                        clearInterval(interval);
                        // æœ€çµ‚çµæœã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                        const maxLengthCells = document.querySelectorAll('td:last-child');
                        maxLengthCells[maxLengthCells.length - 1].style.background = '#28a745';
                        maxLengthCells[maxLengthCells.length - 1].style.color = 'white';
                    }
                }, 1500);
            }

            // ãƒªã‚»ãƒƒãƒˆ
            function resetSimulation() {
                currentStep = 0;
                document.querySelectorAll('.highlight').forEach(el => {
                    el.classList.remove('highlight');
                });

                const bars = document.querySelectorAll('.height-bar');
                bars.forEach(bar => {
                    bar.style.opacity = '1';
                });

                const maxLengthCells = document.querySelectorAll('td:last-child');
                maxLengthCells.forEach(cell => {
                    cell.style.background = '';
                    cell.style.color = '';
                });
            }

            // åˆæœŸåŒ–
            document.addEventListener('DOMContentLoaded', () => {
                visualizeHeights();
                generateSimulationData();
                initializeTable();
            });
        </script>
    </body>

</html>