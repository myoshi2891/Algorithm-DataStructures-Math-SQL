ローマ数字を整数に変換する TypeScript の処理について、各ステップを**図とともに視覚的に**解説します。
ローマ数字の仕組みとアルゴリズムの動きがより理解しやすくなります。

---

## 🔢 例：`s = "MCMXCIV"` の変換

ローマ数字 `"MCMXCIV"` は、整数 `1994` に変換されます。
その仕組みを下図で一つずつ見ていきましょう。

---

### 🧩 ステップ1：ローマ数字の値をマッピング

```ts
const romanMap = {
    I: 1,
    V: 5,
    X: 10,
    L: 50,
    C: 100,
    D: 500,
    M: 1000,
};
```

#### ✅ イメージ

```
ローマ文字 → 数値
   I        →   1
   V        →   5
   X        →  10
   L        →  50
   C        → 100
   D        → 500
   M        →1000
```

---

### 🔁 ステップ2：左から右に順に比較しながら加算／減算

```ts
let total = 0;
for (let i = 0; i < s.length; i++) {
    const curr = romanMap[s[i]];
    const next = romanMap[s[i + 1]];
    if (next > curr) {
        total += next - curr;
        i++;
    } else {
        total += curr;
    }
}
```

---

### 🔍 具体例 `"MCMXCIV"` を追跡

| Index | 文字 | 現在値 (curr) | 次の値 (next) | 判定 (next > curr?) | 操作内容        | 合計 |
| ----- | ---- | ------------- | ------------- | ------------------- | --------------- | ---- |
| 0     | M    | 1000          | 100           | ❌                  | +1000           | 1000 |
| 1     | C    | 100           | 1000          | ✅                  | +900 (1000−100) | 1900 |
| 3     | X    | 10            | 100           | ✅                  | +90 (100−10)    | 1990 |
| 5     | I    | 1             | 5             | ✅                  | +4 (5−1)        | 1994 |

✅ **最終結果：`1994`**

---

### 📊 処理フロー図（全体）

```
入力: "MCMXCIV"

   M   C   M   X   C   I   V
 →1000 100 1000 10 100 1   5
 ↓     ↓    ↓     ↓   ↓
加算  差分  差分 差分 差分

合計: 1000 + 900 + 90 + 4 = 1994
```

---

## ⏱️ 処理時間とメモリの計測

### コード：

```ts
const start = process.hrtime.bigint();
const startMem = process.memoryUsage().heapUsed;

// ... 処理 ...

const end = process.hrtime.bigint();
const endMem = process.memoryUsage().heapUsed;
```

### イメージ図：

```
[ 開始前 ]
  ┌────────────────────┐
  │ 開始時間: T1       │ ← process.hrtime.bigint()
  │ 開始メモリ: M1     │ ← process.memoryUsage().heapUsed
  └────────────────────┘

[ 処理中 ]
  romanToInt("MCMXCIV") → 1994

[ 終了後 ]
  ┌────────────────────┐
  │ 終了時間: T2       │ ← process.hrtime.bigint()
  │ 終了メモリ: M2     │ ← process.memoryUsage().heapUsed
  └────────────────────┘

[ 結果 ]
  処理時間 = (T2 - T1) / 1_000_000（ミリ秒）
  使用メモリ = (M2 - M1) / 1024（KB）
```

---

## ✅ まとめ：アルゴリズムの特徴

| 特徴       | 内容                               |
| ---------- | ---------------------------------- |
| 時間計算量 | O(n)（文字列の長さに比例）         |
| 空間計算量 | O(1)（固定マップと定数メモリ）     |
| 処理の早さ | 非常に高速（10〜20μs 程度）        |
| メモリ消費 | 数 KB 以下（ローマ数字15文字以内） |
| 使用技術   | TypeScript + Node.js + fs + hrtime |

---
