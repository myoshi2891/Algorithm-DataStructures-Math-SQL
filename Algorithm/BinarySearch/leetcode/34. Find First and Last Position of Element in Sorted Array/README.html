<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Binary Search Range Visualization</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                margin: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                min-height: 100vh;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 30px;
                box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            }

            h1,
            h2 {
                text-align: center;
                margin-bottom: 30px;
                color: #fff;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }

            .example-section {
                margin: 40px 0;
                background: rgba(255, 255, 255, 0.05);
                border-radius: 15px;
                padding: 25px;
                border: 1px solid rgba(255, 255, 255, 0.1);
            }

            .array-container {
                margin: 20px 0;
                text-align: center;
            }

            .array {
                display: inline-flex;
                gap: 2px;
                margin: 10px 0;
                padding: 10px;
                background: rgba(0, 0, 0, 0.2);
                border-radius: 10px;
                box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .cell {
                width: 50px;
                height: 50px;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 2px solid #ddd;
                background: linear-gradient(145deg, #f0f0f0, #e0e0e0);
                color: #333;
                font-weight: bold;
                font-size: 16px;
                border-radius: 8px;
                position: relative;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .cell.target {
                background: linear-gradient(145deg, #ff6b6b, #ee5a52);
                color: white;
                border-color: #ff5722;
                animation: pulse 2s infinite;
            }

            .cell.left {
                background: linear-gradient(145deg, #4ecdc4, #44b3ab);
                border-color: #26a69a;
                color: white;
            }

            .cell.right {
                background: linear-gradient(145deg, #ffe66d, #ffd93d);
                border-color: #ffc107;
                color: #333;
            }

            .cell.mid {
                background: linear-gradient(145deg, #a8e6cf, #88d8a3);
                border-color: #4caf50;
                color: #333;
                animation: bounce 1s ease-in-out;
            }

            .cell.found {
                background: linear-gradient(145deg, #ff9ff3, #f368e0);
                border-color: #e91e63;
                color: white;
                animation: glow 1.5s infinite alternate;
            }

            .index {
                position: absolute;
                bottom: -25px;
                font-size: 12px;
                color: #fff;
                font-weight: normal;
            }

            .pointer {
                position: absolute;
                top: -30px;
                font-size: 12px;
                font-weight: bold;
                padding: 2px 6px;
                border-radius: 4px;
                color: white;
            }

            .pointer.left {
                background: #26a69a;
            }

            .pointer.right {
                background: #ffc107;
                color: #333;
            }

            .pointer.mid {
                background: #4caf50;
            }

            .step {
                margin: 30px 0;
                padding: 20px;
                background: rgba(255, 255, 255, 0.08);
                border-radius: 12px;
                border-left: 4px solid #4caf50;
            }

            .step-title {
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 15px;
                color: #4caf50;
            }

            .controls {
                text-align: center;
                margin: 30px 0;
            }

            .btn {
                background: linear-gradient(145deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 12px 24px;
                margin: 0 10px;
                border-radius: 25px;
                cursor: pointer;
                font-size: 16px;
                font-weight: bold;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }

            .btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            }

            .btn:active {
                transform: translateY(0);
            }

            .info {
                background: rgba(33, 150, 243, 0.1);
                border: 1px solid rgba(33, 150, 243, 0.3);
                padding: 15px;
                border-radius: 10px;
                margin: 20px 0;
            }

            .complexity {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 20px 0;
            }

            .complexity-item {
                background: rgba(0, 0, 0, 0.2);
                padding: 15px;
                border-radius: 10px;
                text-align: center;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.1);
                }

                100% {
                    transform: scale(1);
                }
            }

            @keyframes bounce {

                0%,
                20%,
                60%,
                100% {
                    transform: translateY(0);
                }

                40% {
                    transform: translateY(-10px);
                }

                80% {
                    transform: translateY(-5px);
                }
            }

            @keyframes glow {
                from {
                    box-shadow: 0 0 20px #e91e63;
                }

                to {
                    box-shadow: 0 0 30px #e91e63, 0 0 40px #e91e63;
                }
            }

            .legend {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin: 20px 0;
                flex-wrap: wrap;
            }

            .legend-item {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 8px 15px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 20px;
            }

            .legend-color {
                width: 20px;
                height: 20px;
                border-radius: 4px;
                border: 2px solid #fff;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>ğŸ” Binary Search Range Finding Algorithm</h1>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(145deg, #4ecdc4, #44b3ab);"></div>
                    <span>Left Pointer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(145deg, #ffe66d, #ffd93d);"></div>
                    <span>Right Pointer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(145deg, #a8e6cf, #88d8a3);"></div>
                    <span>Mid Pointer</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(145deg, #ff6b6b, #ee5a52);"></div>
                    <span>Target Value</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: linear-gradient(145deg, #ff9ff3, #f368e0);"></div>
                    <span>Found Position</span>
                </div>
            </div>

            <div class="example-section">
                <h2>ğŸ“Š Example: nums = [5,7,7,8,8,10], target = 8</h2>

                <div class="complexity">
                    <div class="complexity-item">
                        <h3>â±ï¸ Time Complexity</h3>
                        <p><strong>O(log n)</strong></p>
                        <p>äºŒåˆ†æ¢ç´¢ã‚’2å›å®Ÿè¡Œ</p>
                    </div>
                    <div class="complexity-item">
                        <h3>ğŸ’¾ Space Complexity</h3>
                        <p><strong>O(1)</strong></p>
                        <p>å®šæ•°ã®è¿½åŠ ãƒ¡ãƒ¢ãƒªã®ã¿</p>
                    </div>
                </div>

                <div class="controls">
                    <button class="btn" onclick="startFirstSearch()">ğŸ” Find First Position</button>
                    <button class="btn" onclick="startLastSearch()">ğŸ” Find Last Position</button>
                    <button class="btn" onclick="reset()">ğŸ”„ Reset</button>
                </div>

                <div id="visualization">
                    <div class="array-container">
                        <h3>Initial Array</h3>
                        <div class="array" id="array">
                            <div class="cell"><span>5</span>
                                <div class="index">0</div>
                            </div>
                            <div class="cell"><span>7</span>
                                <div class="index">1</div>
                            </div>
                            <div class="cell"><span>7</span>
                                <div class="index">2</div>
                            </div>
                            <div class="cell target"><span>8</span>
                                <div class="index">3</div>
                            </div>
                            <div class="cell target"><span>8</span>
                                <div class="index">4</div>
                            </div>
                            <div class="cell"><span>10</span>
                                <div class="index">5</div>
                            </div>
                        </div>
                        <p>Target: <strong>8</strong> | Expected Result: <strong>[3, 4]</strong></p>
                    </div>

                    <div id="steps"></div>
                </div>
            </div>

            <div class="example-section">
                <h2>ğŸ§  Algorithm Analysis</h2>

                <div class="step">
                    <div class="step-title">1. Find First Position (å·¦ç«¯ã®æ¢ç´¢)</div>
                    <p><strong>æˆ¦ç•¥:</strong> targetã‚’è¦‹ã¤ã‘ã¦ã‚‚ã€ã‚ˆã‚Šå·¦å´ã«åŒã˜å€¤ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å³å´ã®å¢ƒç•Œã‚’ç‹­ã‚ã‚‹</p>
                    <div class="info">
                        <strong>Key Point:</strong> nums[mid] == target ã®æ™‚ã€result = mid ã¨ã—ã¦è¨˜éŒ²ã—ã€right = mid - 1 ã§å·¦å´ã‚’ç¶™ç¶šæ¢ç´¢
                    </div>
                </div>

                <div class="step">
                    <div class="step-title">2. Find Last Position (å³ç«¯ã®æ¢ç´¢)</div>
                    <p><strong>æˆ¦ç•¥:</strong> targetã‚’è¦‹ã¤ã‘ã¦ã‚‚ã€ã‚ˆã‚Šå³å´ã«åŒã˜å€¤ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€å·¦å´ã®å¢ƒç•Œã‚’ç‹­ã‚ã‚‹</p>
                    <div class="info">
                        <strong>Key Point:</strong> nums[mid] == target ã®æ™‚ã€result = mid ã¨ã—ã¦è¨˜éŒ²ã—ã€left = mid + 1 ã§å³å´ã‚’ç¶™ç¶šæ¢ç´¢
                    </div>
                </div>

                <div class="step">
                    <div class="step-title">3. Edge Cases Handling</div>
                    <ul>
                        <li><strong>ç©ºé…åˆ—:</strong> å³åº§ã« [-1, -1] ã‚’è¿”å´</li>
                        <li><strong>Targetä¸å­˜åœ¨:</strong> æœ€åˆã®æ¢ç´¢ã§ -1 ãŒè¿”ã•ã‚ŒãŸå ´åˆã€[-1, -1] ã‚’è¿”å´</li>
                        <li><strong>å˜ä¸€è¦ç´ :</strong> æœ€åˆã¨æœ€å¾Œã®ä½ç½®ãŒåŒã˜å ´åˆã‚’é©åˆ‡ã«å‡¦ç†</li>
                    </ul>
                </div>
            </div>
        </div>

        <script>
            let isAnimating = false;

            function reset() {
                if (isAnimating) return;

                const cells = document.querySelectorAll('.cell');
                cells.forEach((cell, index) => {
                    cell.className = 'cell';
                    if (index === 3 || index === 4) {
                        cell.classList.add('target');
                    }
                    // Remove pointers
                    const pointer = cell.querySelector('.pointer');
                    if (pointer) pointer.remove();
                });

                document.getElementById('steps').innerHTML = '';
            }

            async function startFirstSearch() {
                if (isAnimating) return;
                isAnimating = true;

                reset();

                const stepsDiv = document.getElementById('steps');
                stepsDiv.innerHTML = '<h3>ğŸ” Finding First Position of Target 8</h3>';

                const nums = [5, 7, 7, 8, 8, 10];
                let left = 0, right = 5, result = -1;
                let step = 1;

                while (left <= right) {
                    const mid = Math.floor(left + (right - left) / 2);

                    // Update visualization
                    updatePointers(left, right, mid);

                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'step';
                    stepDiv.innerHTML = `
                    <div class="step-title">Step ${step}: left=${left}, right=${right}, mid=${mid}</div>
                    <p><strong>nums[${mid}] = ${nums[mid]}</strong> vs target = 8</p>
                `;

                    if (nums[mid] === 8) {
                        result = mid;
                        stepDiv.innerHTML += `<p>âœ… Found target! But continue searching left side...</p>
                                        <p>Set result = ${mid}, right = ${mid - 1} = ${mid - 1}</p>`;
                        right = mid - 1;
                        highlightFound(mid);
                    } else if (nums[mid] < 8) {
                        stepDiv.innerHTML += `<p>ğŸ“ˆ nums[${mid}] < target, search right side</p>
                                        <p>Set left = ${mid + 1}</p>`;
                        left = mid + 1;
                    } else {
                        stepDiv.innerHTML += `<p>ğŸ“‰ nums[${mid}] > target, search left side</p>
                                        <p>Set right = ${mid - 1}</p>`;
                        right = mid - 1;
                    }

                    stepsDiv.appendChild(stepDiv);

                    await sleep(2000);
                    step++;
                }

                const finalDiv = document.createElement('div');
                finalDiv.className = 'step';
                finalDiv.style.background = 'rgba(76, 175, 80, 0.2)';
                finalDiv.innerHTML = `
                <div class="step-title">ğŸ¯ Result: First Position = ${result}</div>
                <p>Target 8 first appears at index ${result}</p>
            `;
                stepsDiv.appendChild(finalDiv);

                isAnimating = false;
            }

            async function startLastSearch() {
                if (isAnimating) return;
                isAnimating = true;

                reset();

                const stepsDiv = document.getElementById('steps');
                stepsDiv.innerHTML = '<h3>ğŸ” Finding Last Position of Target 8</h3>';

                const nums = [5, 7, 7, 8, 8, 10];
                let left = 0, right = 5, result = -1;
                let step = 1;

                while (left <= right) {
                    const mid = Math.floor(left + (right - left) / 2);

                    // Update visualization
                    updatePointers(left, right, mid);

                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'step';
                    stepDiv.innerHTML = `
                    <div class="step-title">Step ${step}: left=${left}, right=${right}, mid=${mid}</div>
                    <p><strong>nums[${mid}] = ${nums[mid]}</strong> vs target = 8</p>
                `;

                    if (nums[mid] === 8) {
                        result = mid;
                        stepDiv.innerHTML += `<p>âœ… Found target! But continue searching right side...</p>
                                        <p>Set result = ${mid}, left = ${mid + 1} = ${mid + 1}</p>`;
                        left = mid + 1;
                        highlightFound(mid);
                    } else if (nums[mid] < 8) {
                        stepDiv.innerHTML += `<p>ğŸ“ˆ nums[${mid}] < target, search right side</p>
                                        <p>Set left = ${mid + 1}</p>`;
                        left = mid + 1;
                    } else {
                        stepDiv.innerHTML += `<p>ğŸ“‰ nums[${mid}] > target, search left side</p>
                                        <p>Set right = ${mid - 1}</p>`;
                        right = mid - 1;
                    }

                    stepsDiv.appendChild(stepDiv);

                    await sleep(2000);
                    step++;
                }

                const finalDiv = document.createElement('div');
                finalDiv.className = 'step';
                finalDiv.style.background = 'rgba(76, 175, 80, 0.2)';
                finalDiv.innerHTML = `
                <div class="step-title">ğŸ¯ Result: Last Position = ${result}</div>
                <p>Target 8 last appears at index ${result}</p>
            `;
                stepsDiv.appendChild(finalDiv);

                isAnimating = false;
            }

            function updatePointers(left, right, mid) {
                const cells = document.querySelectorAll('.cell');

                // Clear previous pointers and styles
                cells.forEach(cell => {
                    cell.classList.remove('left', 'right', 'mid');
                    const pointer = cell.querySelector('.pointer');
                    if (pointer) pointer.remove();
                });

                // Add new pointers and styles
                if (left < cells.length) {
                    cells[left].classList.add('left');
                    const leftPointer = document.createElement('div');
                    leftPointer.className = 'pointer left';
                    leftPointer.textContent = 'L';
                    cells[left].appendChild(leftPointer);
                }

                if (right < cells.length) {
                    cells[right].classList.add('right');
                    const rightPointer = document.createElement('div');
                    rightPointer.className = 'pointer right';
                    rightPointer.textContent = 'R';
                    cells[right].appendChild(rightPointer);
                }

                if (mid < cells.length) {
                    cells[mid].classList.add('mid');
                    const midPointer = document.createElement('div');
                    midPointer.className = 'pointer mid';
                    midPointer.textContent = 'M';
                    cells[mid].appendChild(midPointer);
                }
            }

            function highlightFound(index) {
                const cells = document.querySelectorAll('.cell');
                if (index < cells.length) {
                    setTimeout(() => {
                        cells[index].classList.add('found');
                    }, 500);
                }
            }

            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        </script>
    </body>

</html>