<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>First Missing Positive - ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£æ</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: #333;
                line-height: 1.6;
            }

            .container {
                background: rgba(255, 255, 255, 0.95);
                padding: 30px;
                border-radius: 15px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(10px);
            }

            h1 {
                text-align: center;
                color: #4a5568;
                margin-bottom: 30px;
                font-size: 2.5em;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }

            h2 {
                color: #2d3748;
                border-bottom: 3px solid #667eea;
                padding-bottom: 10px;
                margin-top: 40px;
                font-size: 1.8em;
            }

            .step {
                margin: 30px 0;
                padding: 25px;
                background: linear-gradient(135deg, #f7fafc, #edf2f7);
                border-radius: 12px;
                border-left: 6px solid #667eea;
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
                transition: transform 0.3s ease;
            }

            .step:hover {
                transform: translateY(-5px);
            }

            .array-container {
                display: flex;
                align-items: center;
                margin: 15px 0;
                flex-wrap: wrap;
                gap: 10px;
            }

            .array-label {
                font-weight: bold;
                color: #4a5568;
                min-width: 120px;
                font-size: 1.1em;
            }

            .array-box {
                width: 50px;
                height: 50px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                font-size: 1.1em;
                border-radius: 8px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .original {
                background: linear-gradient(135deg, #4299e1, #2b77cb);
                color: white;
            }
            .normalized {
                background: linear-gradient(135deg, #48bb78, #38a169);
                color: white;
            }
            .marked {
                background: linear-gradient(135deg, #ed8936, #dd6b20);
                color: white;
            }
            .positive {
                background: linear-gradient(135deg, #e53e3e, #c53030);
                color: white;
            }
            .negative {
                background: linear-gradient(135deg, #667eea, #553c9a);
                color: white;
            }

            .index {
                font-size: 0.8em;
                color: #666;
                margin-top: 5px;
            }

            .explanation {
                background: #f0fff4;
                border: 2px solid #68d391;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
                font-size: 1.05em;
            }

            .code-block {
                background: #2d3748;
                color: #e2e8f0;
                padding: 20px;
                border-radius: 10px;
                font-family: 'Courier New', monospace;
                overflow-x: auto;
                margin: 15px 0;
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            }

            .highlight {
                background: rgba(255, 235, 59, 0.3);
                padding: 2px 4px;
                border-radius: 4px;
                font-weight: bold;
            }

            .complexity {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                padding: 20px;
                border-radius: 12px;
                margin: 25px 0;
                text-align: center;
                font-size: 1.1em;
                font-weight: bold;
            }

            .arrow {
                font-size: 2em;
                color: #667eea;
                text-align: center;
                margin: 10px 0;
            }

            button {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 25px;
                cursor: pointer;
                font-size: 1em;
                font-weight: bold;
                transition: all 0.3s ease;
                margin: 10px 5px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            }

            button:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            }

            .demo-controls {
                text-align: center;
                margin: 30px 0;
                padding: 20px;
                background: #f8f9fa;
                border-radius: 10px;
            }

            .step-counter {
                background: #667eea;
                color: white;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                margin-right: 15px;
                font-size: 1.2em;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>ğŸ” First Missing Positive ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£æ</h1>

            <div class="explanation">
                <strong>å•é¡Œï¼š</strong
                >ã‚½ãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„æ•´æ•°é…åˆ—ã‹ã‚‰ã€å­˜åœ¨ã—ãªã„æœ€å°ã®æ­£ã®æ•´æ•°ã‚’è¦‹ã¤ã‘ã‚‹<br />
                <strong>åˆ¶ç´„ï¼š</strong>O(n)æ™‚é–“ã€O(1)ç©ºé–“ã§å®Ÿè£…ã™ã‚‹
            </div>

            <div class="demo-controls">
                <h3>ğŸ“Š ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                <button onclick="runExample([3, 4, -1, 1])">ä¾‹1: [3, 4, -1, 1]</button>
                <button onclick="runExample([1, 2, 0])">ä¾‹2: [1, 2, 0]</button>
                <button onclick="runExample([7, 8, 9, 11, 12])">ä¾‹3: [7, 8, 9, 11, 12]</button>
                <button onclick="runExample([1, 2, 3, 4])">ä¾‹4: [1, 2, 3, 4]</button>
            </div>

            <div id="demo-area"></div>

            <h2>ğŸ”§ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è©³ç´°è§£èª¬</h2>

            <div class="step">
                <div class="step-counter">1</div>
                <h3>Step 1: å€¤ã®æ­£è¦åŒ– (Normalization)</h3>
                <div class="code-block">
                    for (let i = 0; i < n; i++) { if (nums[i] <= 0 || nums[i] > n) { nums[i] = n +
                    1; // ç¯„å›²å¤–ã®å€¤ã‚’çµ±ä¸€ } }
                </div>
                <div class="explanation">
                    <strong>ç›®çš„ï¼š</strong>1ã‹ã‚‰nã®ç¯„å›²å¤–ã®å€¤ï¼ˆ0ä»¥ä¸‹ã€n+1ä»¥ä¸Šï¼‰ã‚’n+1ã«çµ±ä¸€<br />
                    <strong>ç†ç”±ï¼š</strong
                    >æœ€å°ã®æ¬ ã‘ã¦ã„ã‚‹æ­£ã®æ•´æ•°ã¯å¿…ãš1ã€œ(n+1)ã®ç¯„å›²ã«ã‚ã‚‹ãŸã‚ã€ç¯„å›²å¤–ã®å€¤ã¯ç„¡è¦–ã§ãã‚‹
                </div>
            </div>

            <div class="step">
                <div class="step-counter">2</div>
                <h3>Step 2: å­˜åœ¨ãƒãƒ¼ã‚­ãƒ³ã‚° (Marking)</h3>
                <div class="code-block">
                    for (let i = 0; i < n; i++) { const val = Math.abs(nums[i]); if (val <= n) {
                    nums[val - 1] = -Math.abs(nums[val - 1]); } }
                </div>
                <div class="explanation">
                    <strong>ç›®çš„ï¼š</strong>å„æ•°å€¤ã®å­˜åœ¨ã‚’é…åˆ—ã®ç¬¦å·ã§è¨˜éŒ²<br />
                    <strong>ä»•çµ„ã¿ï¼š</strong
                    >å€¤xãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(x-1)ã®å€¤ã‚’è² ã«ãƒãƒ¼ã‚¯<br />
                    <strong>ãƒã‚¤ãƒ³ãƒˆï¼š</strong>çµ¶å¯¾å€¤ã‚’ä½¿ã†ã“ã¨ã§å…ƒã®å€¤ã‚’ä¿æŒã—ãªãŒã‚‰ãƒãƒ¼ã‚­ãƒ³ã‚°
                </div>
            </div>

            <div class="step">
                <div class="step-counter">3</div>
                <h3>Step 3: çµæœã®æ¤œå‡º (Detection)</h3>
                <div class="code-block">
                    for (let i = 0; i < n; i++) { if (nums[i] > 0) { return i + 1; //
                    æœ€åˆã®æ­£ã®å€¤ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹+1 } } return n + 1; // å…¨ã¦å­˜åœ¨ã™ã‚‹å ´åˆ
                </div>
                <div class="explanation">
                    <strong>ç›®çš„ï¼š</strong>æœ€åˆã®æ­£ã®å€¤ã‚’è¦‹ã¤ã‘ã¦ç­”ãˆã‚’è¿”ã™<br />
                    <strong>è«–ç†ï¼š</strong>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹iãŒæ­£ â†’ å€¤(i+1)ãŒå­˜åœ¨ã—ãªã„ â†’ ç­”ãˆã¯(i+1)<br />
                    <strong>ç‰¹æ®Šã‚±ãƒ¼ã‚¹ï¼š</strong>å…¨ã¦è² ã®å ´åˆã¯1ã€œnãŒå…¨ã¦å­˜åœ¨ã™ã‚‹ãŸã‚ç­”ãˆã¯(n+1)
                </div>
            </div>

            <h2>âš¡ è¨ˆç®—é‡è§£æ</h2>

            <div class="complexity">
                <div>â±ï¸ æ™‚é–“è¤‡é›‘åº¦: <span class="highlight">O(n)</span></div>
                <div style="margin-top: 10px">
                    ğŸ’¾ ç©ºé–“è¤‡é›‘åº¦: <span class="highlight">O(1)</span>
                </div>
            </div>

            <div class="explanation">
                <strong>æ™‚é–“è¤‡é›‘åº¦ã®å†…è¨³ï¼š</strong><br />
                â€¢ Step 1: O(n) - å…¨è¦ç´ ã‚’1å›ã‚¹ã‚­ãƒ£ãƒ³<br />
                â€¢ Step 2: O(n) - å…¨è¦ç´ ã‚’1å›ã‚¹ã‚­ãƒ£ãƒ³<br />
                â€¢ Step 3: O(n) - æœ€æ‚ªã®å ´åˆå…¨è¦ç´ ã‚’ã‚¹ã‚­ãƒ£ãƒ³<br />
                åˆè¨ˆ: O(n) + O(n) + O(n) = O(n)<br /><br />

                <strong>ç©ºé–“è¤‡é›‘åº¦ã®èª¬æ˜ï¼š</strong><br />
                å…¥åŠ›é…åˆ—ä»¥å¤–ã«è¿½åŠ ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ä½¿ç”¨ã›ãšã€å®šæ•°å€‹ã®å¤‰æ•°ã®ã¿ä½¿ç”¨ã™ã‚‹ãŸã‚O(1)
            </div>

            <h2>ğŸ¯ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢</h2>

            <div class="step">
                <h3>ğŸ”‘ Key Insight: é…åˆ—è‡ªä½“ã‚’ãƒãƒƒã‚·ãƒ¥ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦æ´»ç”¨</h3>
                <div class="explanation">
                    <strong>å•é¡Œï¼š</strong>O(1)ç©ºé–“åˆ¶ç´„ã§ã©ã†ã‚„ã£ã¦å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã†ï¼Ÿ<br />
                    <strong>è§£æ±ºç­–ï¼š</strong>é…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨å€¤ã®å¯¾å¿œé–¢ä¿‚ã‚’åˆ©ç”¨<br />
                    <strong>ãƒãƒƒãƒ”ãƒ³ã‚°ï¼š</strong>å€¤x â†’ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹(x-1)ã®ç¬¦å·ã§ãƒãƒ¼ã‚¯<br />
                    <strong>åˆ©ç‚¹ï¼š</strong>è¿½åŠ ãƒ¡ãƒ¢ãƒªä¸è¦ã€O(1)ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
                </div>
            </div>
        </div>

        <script>
            function runExample(inputArray) {
                const demoArea = document.getElementById('demo-area');
                const nums = [...inputArray]; // ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ
                const n = nums.length;

                let html = `
                <div class="step">
                    <h3>ğŸš€ å®Ÿè¡Œä¾‹: [${inputArray.join(', ')}]</h3>
                    <div class="array-container">
                        <div class="array-label">åˆæœŸé…åˆ—:</div>
                        ${nums
                            .map(
                                (num, i) => `
                            <div>
                                <div class="array-box original">${num}</div>
                                <div class="index">i=${i}</div>
                            </div>
                        `,
                            )
                            .join('')}
                    </div>
            `;

                // Step 1: æ­£è¦åŒ–
                const normalizedNums = [...nums];
                for (let i = 0; i < n; i++) {
                    if (normalizedNums[i] <= 0 || normalizedNums[i] > n) {
                        normalizedNums[i] = n + 1;
                    }
                }

                html += `
                    <div class="arrow">â¬‡ï¸</div>
                    <div class="array-container">
                        <div class="array-label">Step 1 æ­£è¦åŒ–:</div>
                        ${normalizedNums
                            .map(
                                (num, i) => `
                            <div>
                                <div class="array-box ${num === n + 1 ? 'normalized' : 'original'}">${num}</div>
                                <div class="index">i=${i}</div>
                            </div>
                        `,
                            )
                            .join('')}
                    </div>
            `;

                // Step 2: ãƒãƒ¼ã‚­ãƒ³ã‚°
                const markedNums = [...normalizedNums];
                const markingSteps = [];

                for (let i = 0; i < n; i++) {
                    const val = Math.abs(markedNums[i]);
                    if (val <= n) {
                        const targetIndex = val - 1;
                        const oldValue = markedNums[targetIndex];
                        markedNums[targetIndex] = -Math.abs(markedNums[targetIndex]);
                        markingSteps.push({
                            i,
                            val,
                            targetIndex,
                            oldValue,
                            newValue: markedNums[targetIndex],
                        });
                    }
                }

                html += `
                    <div class="arrow">â¬‡ï¸</div>
                    <div class="array-container">
                        <div class="array-label">Step 2 ãƒãƒ¼ã‚­ãƒ³ã‚°:</div>
                        ${markedNums
                            .map(
                                (num, i) => `
                            <div>
                                <div class="array-box ${num < 0 ? 'negative' : 'positive'}">${num}</div>
                                <div class="index">i=${i}</div>
                            </div>
                        `,
                            )
                            .join('')}
                    </div>
            `;

                // ãƒãƒ¼ã‚­ãƒ³ã‚°ã®è©³ç´°
                html += `<div class="explanation"><strong>ãƒãƒ¼ã‚­ãƒ³ã‚°ã®è©³ç´°:</strong><br>`;
                markingSteps.forEach((step) => {
                    html += `å€¤${step.val}ãŒå­˜åœ¨ â†’ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹${step.targetIndex}ã‚’è² ã«ãƒãƒ¼ã‚¯ (${step.oldValue} â†’ ${step.newValue})<br>`;
                });
                html += `</div>`;

                // Step 3: çµæœ
                let result = n + 1;
                let resultIndex = -1;
                for (let i = 0; i < n; i++) {
                    if (markedNums[i] > 0) {
                        result = i + 1;
                        resultIndex = i;
                        break;
                    }
                }

                html += `
                    <div class="arrow">â¬‡ï¸</div>
                    <div class="array-container">
                        <div class="array-label">Step 3 çµæœæ¤œå‡º:</div>
                        ${markedNums
                            .map(
                                (num, i) => `
                            <div>
                                <div class="array-box ${i === resultIndex ? 'marked' : num < 0 ? 'negative' : 'positive'}">${num}</div>
                                <div class="index">i=${i}</div>
                            </div>
                        `,
                            )
                            .join('')}
                    </div>
                    
                    <div class="explanation">
                        <strong>ğŸ¯ ç­”ãˆ: ${result}</strong><br>
                        ${
                            resultIndex !== -1
                                ? `ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹${resultIndex}ãŒæœ€åˆã®æ­£ã®å€¤ â†’ å€¤${result}ãŒæ¬ ã‘ã¦ã„ã‚‹`
                                : 'å…¨ã¦ã®å€¤ãŒè²  â†’ 1ã‹ã‚‰nã¾ã§å…¨ã¦å­˜åœ¨ â†’ ç­”ãˆã¯n+1'
                        }
                    </div>
                </div>
            `;

                demoArea.innerHTML = html;
            }

            // åˆæœŸè¡¨ç¤º
            runExample([3, 4, -1, 1]);
        </script>
    </body>
</html>
