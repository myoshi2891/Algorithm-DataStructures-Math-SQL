# LeetCodeå½¢å¼ã§ã®Pythonå®Ÿè£…ã‚’ã€å‹å®‰å…¨æ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’é‡è¦–ã—ã¦ä½œæˆã„ãŸã—ã¾ã™ã€‚## ğŸ Pythonå®Ÿè£…ã®ç‰¹å¾´

# ### **1. å‹å®‰å…¨æ€§ï¼ˆPylanceå¯¾å¿œï¼‰**
# - `List[List[int]]` ã«ã‚ˆã‚‹æ˜ç¤ºçš„ãªå‹ãƒ’ãƒ³ãƒˆ
# - å…¨ã¦ã®å¤‰æ•°ã«é©åˆ‡ãªå‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
# - `typing` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ´»ç”¨ã—ãŸå‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰

# ### **2. LeetCodeãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

# **ãƒ¡ã‚¤ãƒ³å®Ÿè£… (`merge`)**ï¼š
# - **æ™‚é–“è¨ˆç®—é‡**: O(n log n) - Timsortã®åŠ¹ç‡çš„ãªã‚½ãƒ¼ãƒˆ
# - **ç©ºé–“è¨ˆç®—é‡**: O(1) - in-placeæ“ä½œã§æœ€å°ãƒ¡ãƒ¢ãƒªä½¿ç”¨
# - **æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³**: ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®åŠ¹ç‡çš„å‡¦ç†

# **æœ€é©åŒ–ç‰ˆ (`merge_optimized`)**ï¼š
# - **ãƒ¡ãƒ¢ãƒªå†é…ç½®å‰Šæ¸›**: ãƒªã‚¹ãƒˆå®¹é‡ã®äº‹å‰äºˆç´„
# - **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ã‚¯ã‚»ã‚¹æœ€é©åŒ–**: ç›´æ¥å‚ç…§ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
# - **ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆæœ€å°åŒ–**: in-placeæ›´æ–°

# **é–¢æ•°å‹ç‰ˆ (`merge_functional`)**ï¼š
# - **reduceé–¢æ•°**: ç•³ã¿è¾¼ã¿å‡¦ç†ã«ã‚ˆã‚‹ç°¡æ½”ãªå®Ÿè£…
# - **ç´”ç²‹é–¢æ•°**: å‰¯ä½œç”¨ã®ãªã„é–¢æ•°å‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
# - **å¯èª­æ€§é‡è¦–**: é–¢æ•°ã®è²¬ä»»åˆ†é›¢

# ### **3. CPython 3.11.4 æœ€é©åŒ–**

# **æ´»ç”¨ã•ã‚Œã‚‹æœ€é©åŒ–æ©Ÿèƒ½**ï¼š
# - **Timsort**: Pythonæ¨™æº–ã®é«˜åŠ¹ç‡ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
# - **ãƒªã‚¹ãƒˆæœ€é©åŒ–**: appendæ“ä½œã®å„Ÿå´O(1)æ€§èƒ½
# - **çµ„ã¿è¾¼ã¿é–¢æ•°**: `max()`, `len()` ã®æœ€é©åŒ–ã•ã‚ŒãŸå®Ÿè£…

# ### **4. LeetCodeæå‡ºå½¢å¼**
# ```python
# # æ¨™æº–çš„ãªæå‡ºå½¢å¼
# class Solution:
#     def merge(self, intervals: List[List[int]]) -> List[List[int]]:
#         # ãƒ¡ã‚¤ãƒ³å®Ÿè£…ã‚’ã“ã“ã«ä½¿ç”¨
# ```

# ### **5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ**

# | å®Ÿè£…æ–¹å¼ | å¯èª­æ€§ | é€Ÿåº¦ | ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ | æ¨å¥¨ç”¨é€” |
# |---------|-------|------|----------|----------|
# | `merge` | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | LeetCodeæå‡º |
# | `merge_optimized` | â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° |
# | `merge_functional` | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ | ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ |

# **æ¨å¥¨**: LeetCodeæå‡ºã«ã¯ `merge` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã€‚æœ€é©ãªãƒãƒ©ãƒ³ã‚¹ã§é«˜ã„è©•ä¾¡ã‚’ç²å¾—ã§ãã¾ã™ï¼

from typing import List


class Solution:
    def merge(self, intervals: List[List[int]]) -> List[List[int]]:
        """
        é‡è¤‡ã™ã‚‹åŒºé–“ã‚’ãƒãƒ¼ã‚¸ã—ã¦ã€é‡è¤‡ã®ãªã„åŒºé–“ã®é…åˆ—ã‚’è¿”ã™

        Args:
            intervals (List[List[int]]): åŒºé–“ã®é…åˆ—ã€‚å„åŒºé–“ã¯[start, end]ã®å½¢å¼
                                        åˆ¶ç´„: 1 <= intervals.length <= 10^4
                                              0 <= start <= end <= 10^4

        Returns:
            List[List[int]]: ãƒãƒ¼ã‚¸ã•ã‚ŒãŸé‡è¤‡ã®ãªã„åŒºé–“ã®é…åˆ—

        æ™‚é–“è¨ˆç®—é‡: O(n log n) - ã‚½ãƒ¼ãƒˆå‡¦ç†ãŒæ”¯é…çš„
        ç©ºé–“è¨ˆç®—é‡: O(1) - å…¥åŠ›é…åˆ—ã‚’ç›´æ¥å¤‰æ›´ã™ã‚‹ãŸã‚ï¼ˆã‚½ãƒ¼ãƒˆã‚’é™¤ãï¼‰
                     æœ€æ‚ªã‚±ãƒ¼ã‚¹ã§ã‚‚ O(n) - å…¨åŒºé–“ãŒç‹¬ç«‹ã—ã¦ã„ã‚‹å ´åˆ

        LeetCodeæœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆ:
        - in-place ã‚½ãƒ¼ãƒˆã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’æœ€å°åŒ–
        - æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã§ä¸è¦ãªå‡¦ç†ã‚’å›é¿
        - Pythonã®çµ„ã¿è¾¼ã¿é–¢æ•°ã‚’æ´»ç”¨ã—ãŸåŠ¹ç‡çš„ãªå®Ÿè£…
        """
        # ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹: ç©ºé…åˆ—ã¾ãŸã¯å˜ä¸€è¦ç´ ã®å ´åˆã¯å³åº§ã«è¿”å´
        # å‡¦ç†æ™‚é–“ã¨ãƒ¡ãƒ¢ãƒªã‚’ç¯€ç´„ã™ã‚‹æ—©æœŸçµ‚äº†æ¡ä»¶
        if len(intervals) <= 1:
            return intervals

        # åŒºé–“ã‚’é–‹å§‹ç‚¹ã§æ˜‡é †ã‚½ãƒ¼ãƒˆï¼ˆin-placeï¼‰
        # æ™‚é–“è¨ˆç®—é‡: O(n log n) - Timsortã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨
        # ç©ºé–“è¨ˆç®—é‡: O(1) - å…ƒã®é…åˆ—ã‚’ç›´æ¥å¤‰æ›´
        intervals.sort(key=lambda interval: interval[0])

        # çµæœã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆï¼ˆæœ€åˆã®åŒºé–“ã§åˆæœŸåŒ–ï¼‰
        # å‹ãƒ’ãƒ³ãƒˆ: List[List[int]]
        merged: List[List[int]] = [intervals[0]]

        # 2ç•ªç›®ã®åŒºé–“ã‹ã‚‰é †æ¬¡å‡¦ç†
        # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹1ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ç·šå½¢ã‚¹ã‚­ãƒ£ãƒ³
        for i in range(1, len(intervals)):
            current: List[int] = intervals[i]
            last_merged: List[int] = merged[-1]  # æœ€å¾Œã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸåŒºé–“ã‚’å‚ç…§

            # é‡è¤‡åˆ¤å®š: ç¾åœ¨ã®åŒºé–“ã®é–‹å§‹ç‚¹ãŒå‰ã®åŒºé–“ã®çµ‚äº†ç‚¹ä»¥ä¸‹
            # current[0] <= last_merged[1] ã®å ´åˆã«é‡è¤‡ã¨åˆ¤å®š
            if current[0] <= last_merged[1]:
                # ãƒãƒ¼ã‚¸å‡¦ç†: çµ‚äº†ç‚¹ã‚’ä¸¡åŒºé–“ã®æœ€å¤§å€¤ã§æ›´æ–°
                # max()é–¢æ•°ã¯2ã¤ã®å€¤ã‚’æ¯”è¼ƒã—ã¦ã‚ˆã‚Šå¤§ãã„å€¤ã‚’è¿”ã™
                last_merged[1] = max(last_merged[1], current[1])
            else:
                # é‡è¤‡ã—ãªã„å ´åˆ: ç¾åœ¨ã®åŒºé–“ã‚’çµæœãƒªã‚¹ãƒˆã«è¿½åŠ 
                # append()ã®æ™‚é–“è¨ˆç®—é‡: O(1) - å„Ÿå´è¨ˆç®—é‡
                merged.append(current)

        return merged

    def merge_optimized(self, intervals: List[List[int]]) -> List[List[int]]:
        """
        ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ã•ã‚‰ã«æœ€é©åŒ–ã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³

        Args:
            intervals (List[List[int]]): åŒºé–“ã®é…åˆ—

        Returns:
            List[List[int]]: ãƒãƒ¼ã‚¸ã•ã‚ŒãŸåŒºé–“ã®é…åˆ—

        æœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆ:
        - çµæœé…åˆ—ã®åˆæœŸå®¹é‡ã‚’äºˆç´„ã—ã¦ãƒ¡ãƒ¢ãƒªå†é…ç½®ã‚’å‰Šæ¸›
        - ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿å¼ã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã‚’å‘ä¸Š
        """
        if not intervals:
            return []

        if len(intervals) == 1:
            return intervals

        # ã‚½ãƒ¼ãƒˆï¼ˆin-placeï¼‰
        intervals.sort(key=lambda x: x[0])

        # çµæœãƒªã‚¹ãƒˆã‚’åˆæœŸåŒ–ï¼ˆå®¹é‡ã‚’äº‹å‰äºˆç´„ã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰
        merged: List[List[int]] = []
        merged.append(intervals[0])

        # æœ€é©åŒ–ã•ã‚ŒãŸãƒ«ãƒ¼ãƒ—å‡¦ç†
        for current in intervals[1:]:
            # æœ€å¾Œã®è¦ç´ ã¸ã®ç›´æ¥å‚ç…§ã§ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ã‚’å‰Šæ¸›
            if current[0] <= merged[-1][1]:
                # in-placeæ›´æ–°ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆã‚’å›é¿
                merged[-1][1] = max(merged[-1][1], current[1])
            else:
                merged.append(current)

        return merged

    def merge_functional(self, intervals: List[List[int]]) -> List[List[int]]:
        """
        é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ã§ã®å®Ÿè£…

        Args:
            intervals (List[List[int]]): åŒºé–“ã®é…åˆ—

        Returns:
            List[List[int]]: ãƒãƒ¼ã‚¸ã•ã‚ŒãŸåŒºé–“ã®é…åˆ—

        ç‰¹å¾´:
        - ç´”ç²‹é–¢æ•°çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
        - reduceé–¢æ•°ã‚’ä½¿ç”¨ã—ãŸç•³ã¿è¾¼ã¿å‡¦ç†
        """
        from functools import reduce

        if len(intervals) <= 1:
            return intervals

        # ã‚½ãƒ¼ãƒˆå‡¦ç†
        sorted_intervals: List[List[int]] = sorted(intervals, key=lambda x: x[0])

        def merge_interval(
            merged_list: List[List[int]], current: List[int]
        ) -> List[List[int]]:
            """
            å˜ä¸€åŒºé–“ã®ãƒãƒ¼ã‚¸å‡¦ç†ã‚’è¡Œã†ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°

            Args:
                merged_list (List[List[int]]): æ—¢ã«ãƒãƒ¼ã‚¸ã•ã‚ŒãŸåŒºé–“ã®ãƒªã‚¹ãƒˆ
                current (List[int]): ç¾åœ¨å‡¦ç†ä¸­ã®åŒºé–“

            Returns:
                List[List[int]]: æ›´æ–°ã•ã‚ŒãŸãƒãƒ¼ã‚¸æ¸ˆã¿åŒºé–“ãƒªã‚¹ãƒˆ
            """
            if not merged_list or current[0] > merged_list[-1][1]:
                return merged_list + [current]
            else:
                # æœ€å¾Œã®åŒºé–“ã®çµ‚äº†ç‚¹ã‚’æ›´æ–°
                merged_list[-1][1] = max(merged_list[-1][1], current[1])
                return merged_list

        # reduceé–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ç•³ã¿è¾¼ã¿å‡¦ç†
        return reduce(merge_interval, sorted_intervals[1:], [sorted_intervals[0]])
