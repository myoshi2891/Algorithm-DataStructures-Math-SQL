## **æ–¹é‡**

- å•é¡Œæ–‡ã«ã‚ã‚‹é€šã‚Šã€A ã® mod é€†å…ƒã‚’æ±‚ã‚ã‚‹ã«ã¯æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã‚’ç”¨ã„ã¦ x , y ã«ã¤ã„ã¦ã® 1 æ¬¡æ–¹ç¨‹å¼ Ax + My = 1 ã® è§£ x ã‚’æ±‚ã‚ã‚Œã°è‰¯ã„ã§ã™ã€‚
- æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã§ã¯ã€è§£ãŒè² ã®å€¤ã¨ãªã‚‹å ´åˆãŒã‚ã‚‹ã®ã§ã€å•é¡Œæ–‡ã«ã—ãŸãŒã£ã¦ x ã®å€¤ã‚’ 1 ä»¥ä¸Š M æœªæº€ã«ã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ã€‚
- æ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ãŒã‚ã‹ã‚‰ãªã„æ–¹ã¯ã€ã“ã®å•é¡Œé›†ã®ã€Œæ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã€ã«å–ã‚Šçµ„ã‚“ã§ã¿ã¦ãã ã•ã„ã€‚
---

## ðŸ§® å•é¡Œè¨­å®šã®å¾©ç¿’

A ã¨ M ãŒäº’ã„ã«ç´ ï¼ˆgcd(A, M) = 1ï¼‰ã§ã‚ã‚‹ã¨ãã€

> $A \times x \equiv 1 \pmod{M}$

ã¨ãªã‚‹ `x`ï¼ˆ**A ã® mod M ã«ãŠã‘ã‚‹é€†å…ƒ**ï¼‰ã‚’æ±‚ã‚ã‚‹ã€‚

---

## ðŸ“˜ ä¾‹é¡Œ

```
å…¥åŠ›: M = 7, A = 11
æ±‚ã‚ãŸã„: 11^(-1) mod 7
```

---

## ðŸ”§ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼šæ‹¡å¼µãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•

æ–¹ç¨‹å¼ï¼š

$$
11x + 7y = 1
$$

ã“ã® x ãŒ `11 ã® 7 ã«ãŠã‘ã‚‹é€†å…ƒ` ã«ãªã‚‹ï¼

---

## ðŸ”¢ ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã®è¨ˆç®—ã®æ§˜å­

### ã‚¹ãƒ†ãƒƒãƒ— 0: åˆæœŸåŒ–

| å¤‰æ•°   | æ„å‘³     | åˆæœŸå€¤ |
| ---- | ------ | --- |
| `a`  | Aï¼ˆå¤‰å‹•ï¼‰  | 11  |
| `m`  | Mï¼ˆå¤‰å‹•ï¼‰  | 7   |
| `x1` | 1ã¤å‰ã® x | 1   |
| `x0` | 2ã¤å‰ã® x | 0   |

---

### ã‚¹ãƒ†ãƒƒãƒ— 1: ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³• + ä¿‚æ•°è¿½è·¡

```
a = 11, m = 7
q = âŒŠ11 / 7âŒ‹ = 1
â†’ a = 7, m = 11 % 7 = 4
â†’ x0 = x1 - q * x0 = 1 - 1*0 = 1, x1 = 0
```

ðŸ“˜ çŠ¶æ…‹: a=7, m=4, x0=1, x1=0

---

```
a = 7, m = 4
q = âŒŠ7 / 4âŒ‹ = 1
â†’ a = 4, m = 7 % 4 = 3
â†’ x0 = x1 - q * x0 = 0 - 1*1 = -1, x1 = 1
```

ðŸ“˜ çŠ¶æ…‹: a=4, m=3, x0=-1, x1=1

---

```
a = 4, m = 3
q = âŒŠ4 / 3âŒ‹ = 1
â†’ a = 3, m = 4 % 3 = 1
â†’ x0 = x1 - q * x0 = 1 - 1*(-1) = 2, x1 = -1
```

ðŸ“˜ çŠ¶æ…‹: a=3, m=1, x0=2, x1=-1

---

```
a = 3, m = 1
q = âŒŠ3 / 1âŒ‹ = 3
â†’ a = 1, m = 0ï¼ˆçµ‚äº†ï¼‰
â†’ x0 = x1 - q * x0 = -1 - 3*2 = -7, x1 = 2
```

ðŸ“˜ çµ‚äº†: é€†å…ƒ = x1 = 2

---

## ðŸŽ¯ æœ€çµ‚çš„ã«å¾—ã‚‰ã‚Œã‚‹ç­”ãˆ

```
11 Ã— 2 â‰¡ 22 â‰¡ 1 mod 7 â†’ âœ…
```

ã‚ˆã£ã¦ã€ç­”ãˆã¯ `2`

---

## ðŸ“ˆ å›³ã§ã®æµã‚Œã‚¤ãƒ¡ãƒ¼ã‚¸

```
  A = 11, M = 7

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   11 * x + 7 * y = 1   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
  ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ã®äº’é™¤æ³•ã§ gcd(11, 7)
         â†“
  11 = 1Ã—7 + 4
   7 = 1Ã—4 + 3
   4 = 1Ã—3 + 1
   3 = 3Ã—1 + 0 â†çµ‚äº†
         â†“
  é€†ã«æˆ»ã£ã¦ã€
  1 = 4 - 1Ã—3
    = 4 - 1Ã—(7 - 1Ã—4)
    = 2Ã—4 - 1Ã—7
    = 2Ã—(11 - 1Ã—7) - 1Ã—7
    = 2Ã—11 - 3Ã—7

â‡’ x = 2ï¼ˆmod é€†å…ƒï¼ï¼‰
```

---

## âœ… JavaScript ã‚³ãƒ¼ãƒ‰ã®ãŠã•ã‚‰ã„

```js
function modInverse(a, m) {
  let m0 = m;
  let x0 = 0, x1 = 1;

  while (a > 1) {
    const q = Math.floor(a / m);
    [a, m] = [m, a % m];
    [x0, x1] = [x1 - q * x0, x0];
  }

  return x1 < 0 ? x1 + m0 : x1;
}
```

---

## âœ è£œè¶³ï¼ˆè² ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ï¼‰

mod é€†å…ƒ x ãŒè² ã«ãªã£ãŸå ´åˆã§ã‚‚ã€`x + M` ã§æ­£ã®ç¯„å›²ã«æˆ»ã›ã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

---
