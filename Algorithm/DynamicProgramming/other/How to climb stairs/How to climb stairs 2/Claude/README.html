<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>階段上りDP問題の詳細解析</title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: #333;
                max-width: 1200px;
                margin: 0 auto;
                padding: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }

            .container {
                background: white;
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            }

            h1 {
                color: #2c3e50;
                text-align: center;
                border-bottom: 3px solid #3498db;
                padding-bottom: 10px;
                margin-bottom: 30px;
            }

            h2 {
                color: #34495e;
                border-left: 5px solid #3498db;
                padding-left: 15px;
                margin-top: 30px;
            }

            .dp-table {
                display: flex;
                flex-wrap: wrap;
                gap: 5px;
                margin: 20px 0;
                justify-content: center;
            }

            .dp-cell {
                width: 60px;
                height: 60px;
                border: 2px solid #3498db;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                border-radius: 8px;
                background: linear-gradient(135deg, #74b9ff, #0984e3);
                color: white;
                font-weight: bold;
                transition: all 0.3s ease;
            }

            .dp-cell:hover {
                transform: scale(1.1);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .cell-index {
                font-size: 10px;
                opacity: 0.8;
            }

            .cell-value {
                font-size: 16px;
            }

            .calculation-step {
                background: #f8f9fa;
                border-left: 4px solid #28a745;
                padding: 15px;
                margin: 10px 0;
                border-radius: 5px;
            }

            .arrow {
                color: #e74c3c;
                font-size: 20px;
                font-weight: bold;
                margin: 0 10px;
            }

            .step-by-step {
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
            }

            .code-block {
                background: #2d3748;
                color: #e2e8f0;
                padding: 20px;
                border-radius: 10px;
                font-family: 'Courier New', monospace;
                margin: 20px 0;
                overflow-x: auto;
            }

            .highlight {
                background: #fdcb6e;
                padding: 2px 5px;
                border-radius: 3px;
                font-weight: bold;
            }

            .visual-stair {
                display: flex;
                align-items: flex-end;
                justify-content: center;
                gap: 2px;
                margin: 20px 0;
                height: 200px;
            }

            .stair-step {
                background: linear-gradient(135deg, #a29bfe, #6c5ce7);
                color: white;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                border-radius: 5px;
                position: relative;
                transition: all 0.3s ease;
            }

            .stair-step:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            }

            .complexity-analysis {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                margin: 20px 0;
            }

            .complexity-box {
                background: linear-gradient(135deg, #fd79a8, #e84393);
                color: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
            }

            .interactive-demo {
                background: #e8f4ff;
                border: 2px dashed #3498db;
                border-radius: 10px;
                padding: 20px;
                margin: 20px 0;
                text-align: center;
            }

            button {
                background: linear-gradient(135deg, #00b894, #00cec9);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 25px;
                cursor: pointer;
                font-size: 16px;
                font-weight: bold;
                transition: all 0.3s ease;
                margin: 10px;
            }

            button:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .formula {
                background: #f1c40f;
                color: #2c3e50;
                padding: 15px;
                border-radius: 10px;
                font-size: 18px;
                font-weight: bold;
                text-align: center;
                margin: 20px 0;
                box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            }
        </style>
    </head>

    <body>
        <div class="container">
            <h1>🏃‍♂️ 階段上りDP問題の詳細解析</h1>

            <h2>📋 問題概要</h2>
            <p><strong>問題:</strong> n段の階段を、1歩でa段またはb段ずつ上る方法は何通りあるか？</p>
            <p><strong>例:</strong> n=11, a=3, b=4の場合</p>

            <h2>🎯 動的プログラミング（DP）の基本概念</h2>
            <div class="formula">dp[i] = dp[i-a] + dp[i-b] (i ≥ max(a,b)の場合)</div>

            <div class="step-by-step">
                <h3>💡 DPテーブルの意味</h3>
                <p><code>dp[i]</code> = <span class="highlight">i段目に到達する方法の数</span></p>
                <ul>
                    <li><code>dp[0] = 1</code>：0段目（スタート地点）にいる方法は1通り</li>
                    <li>
                        <code>dp[i]</code>：i段目には、(i-a)段目または(i-b)段目から来ることができる
                    </li>
                </ul>
            </div>

            <h2>🔄 実例での処理過程（n=11, a=3, b=4）</h2>

            <h3>ステップ1: DPテーブルの初期化</h3>
            <div id="dp-table-init" class="dp-table"></div>

            <h3>ステップ2: 段階的計算</h3>
            <div id="calculation-steps"></div>

            <h2>📊 視覚的な階段表現</h2>
            <div id="visual-stairs" class="visual-stair"></div>

            <h2>💻 コード解析</h2>
            <div class="code-block">
                <pre><code>// 初期化フェーズ
const dp = new Array(n + 1).fill(0);  // O(n) 空間
dp[0] = 1;  // ベースケース

// 計算フェーズ
for (let i = 1; i <= n; i++) {        // O(n) 時間
    if (i >= a) dp[i] += dp[i - a];   // 状態遷移1
    if (i >= b) dp[i] += dp[i - b];   // 状態遷移2
}</code></pre>
            </div>

            <h2>⚡ 計算量解析</h2>
            <div class="complexity-analysis">
                <div class="complexity-box">
                    <h3>⏱️ 時間計算量</h3>
                    <p><strong>O(n)</strong></p>
                    <p>各段を1回ずつ計算</p>
                </div>
                <div class="complexity-box">
                    <h3>💾 空間計算量</h3>
                    <p><strong>O(n)</strong></p>
                    <p>DPテーブルのサイズ</p>
                </div>
            </div>

            <h2>🎮 インタラクティブデモ</h2>
            <div class="interactive-demo">
                <p>異なるパラメーターでDPの動作を確認しよう！</p>
                <button onclick="runDemo(7, 2, 3)">n=7, a=2, b=3</button>
                <button onclick="runDemo(10, 1, 4)">n=10, a=1, b=4</button>
                <button onclick="runDemo(8, 3, 5)">n=8, a=3, b=5</button>
                <div id="demo-result"></div>
            </div>

            <h2>🔍 重要なポイント</h2>
            <div class="calculation-step">
                <h4>✅ なぜDPが効率的なのか？</h4>
                <ul>
                    <li>
                        <strong>重複する部分問題</strong
                        >：同じ段への到達方法を何度も計算する必要がある
                    </li>
                    <li>
                        <strong>最適部分構造</strong
                        >：i段への最適解は、(i-a)段と(i-b)段の最適解から構成される
                    </li>
                    <li><strong>メモ化</strong>：一度計算した結果を保存して再利用</li>
                </ul>
            </div>

            <div class="calculation-step">
                <h4>⚠️ 注意すべきケース</h4>
                <ul>
                    <li>
                        <strong>答えが0になる場合</strong>：n=4, a=3, b=5 →
                        どう組み合わせても4段にならない
                    </li>
                    <li><strong>境界条件</strong>：i < a または i < b の場合は加算しない</li>
                </ul>
            </div>
        </div>

        <script>
            // DPテーブルの初期化表示
            function initializeDPTable() {
                const container = document.getElementById('dp-table-init');
                container.innerHTML = '';

                for (let i = 0; i <= 11; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'dp-cell';
                    cell.innerHTML = `<div class="cell-index">dp[${i}]</div><div class="cell-value">${i === 0 ? '1' : '0'}</div>`;
                    if (i === 0)
                        cell.style.background = 'linear-gradient(135deg, #00b894, #00cec9)';
                    container.appendChild(cell);
                }
            }

            // 計算ステップの表示
            function showCalculationSteps() {
                const container = document.getElementById('calculation-steps');
                const n = 11,
                    a = 3,
                    b = 4;
                const dp = new Array(n + 1).fill(0);
                dp[0] = 1;

                let stepsHTML = '';

                for (let i = 1; i <= n; i++) {
                    let stepHTML = `<div class="calculation-step">`;
                    stepHTML += `<h4>段数 ${i} の計算</h4>`;
                    stepHTML += `<p><strong>dp[${i}] = `;

                    let parts = [];
                    if (i >= a) {
                        dp[i] += dp[i - a];
                        parts.push(`dp[${i - a}] (=${dp[i - a]})`);
                    }
                    if (i >= b) {
                        dp[i] += dp[i - b];
                        parts.push(`dp[${i - b}] (=${dp[i - b]})`);
                    }

                    if (parts.length === 0) {
                        stepHTML += `0</strong> （どの段からも到達不可）</p>`;
                    } else {
                        stepHTML += parts.join(' + ') + ` = ${dp[i]}</strong></p>`;
                    }

                    stepHTML += `<div class="dp-table">`;
                    for (let j = 0; j <= n; j++) {
                        const cellValue = j <= i ? (j === 0 ? 1 : dp[j] || 0) : '?';
                        const isCurrently =
                            j === i
                                ? 'background: linear-gradient(135deg, #e17055, #d63031);'
                                : j < i
                                  ? 'background: linear-gradient(135deg, #00b894, #00cec9);'
                                  : '';
                        stepHTML += `<div class="dp-cell" style="${isCurrently}">
                        <div class="cell-index">dp[${j}]</div>
                        <div class="cell-value">${cellValue}</div>
                    </div>`;
                    }
                    stepHTML += `</div></div>`;

                    stepsHTML += stepHTML;
                }

                container.innerHTML = stepsHTML;
            }

            // 視覚的階段の表示
            function showVisualStairs() {
                const container = document.getElementById('visual-stairs');
                container.innerHTML = '';

                for (let i = 0; i <= 11; i++) {
                    const step = document.createElement('div');
                    step.className = 'stair-step';
                    step.style.width = '30px';
                    step.style.height = `${15 + i * 12}px`;
                    step.textContent = i;
                    step.title = `段数: ${i}`;
                    container.appendChild(step);
                }
            }

            // デモ実行関数
            function runDemo(n, a, b) {
                const dp = new Array(n + 1).fill(0);
                dp[0] = 1;

                for (let i = 1; i <= n; i++) {
                    if (i >= a) dp[i] += dp[i - a];
                    if (i >= b) dp[i] += dp[i - b];
                }

                let resultHTML = `<div style="margin-top: 20px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">`;
                resultHTML += `<h4>🎯 結果: n=${n}, a=${a}, b=${b}</h4>`;
                resultHTML += `<p><strong>答え: ${dp[n]}通り</strong></p>`;
                resultHTML += `<div class="dp-table">`;

                for (let i = 0; i <= n; i++) {
                    resultHTML += `<div class="dp-cell" style="background: linear-gradient(135deg, #a29bfe, #6c5ce7);">
                    <div class="cell-index">dp[${i}]</div>
                    <div class="cell-value">${dp[i]}</div>
                </div>`;
                }

                resultHTML += `</div></div>`;
                document.getElementById('demo-result').innerHTML = resultHTML;
            }

            // 初期化
            window.onload = function () {
                initializeDPTable();
                showCalculationSteps();
                showVisualStairs();
            };
        </script>
    </body>
</html>
